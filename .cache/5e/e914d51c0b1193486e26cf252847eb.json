{"id":"W6UV","dependencies":[{"name":"/Users/polluterofminds/Development/simpleid/ssa-sdk/package.json","includedInParent":true,"mtime":1584306008866},{"name":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-kad-dht/package.json","includedInParent":true,"mtime":1582579780032},{"name":"pull-stream","loc":{"line":3,"column":21},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/pull-stream/index.js"},{"name":"pull-length-prefixed","loc":{"line":4,"column":19},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/pull-length-prefixed/src/index.js"},{"name":"../message","loc":{"line":6,"column":24},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-kad-dht/src/message/index.js"},{"name":"./handlers","loc":{"line":7,"column":25},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/index.js"},{"name":"../utils","loc":{"line":8,"column":22},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-kad-dht/src/utils.js"},{"name":"../constants","loc":{"line":9,"column":18},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-kad-dht/src/constants.js"}],"generated":{"js":"\"use strict\";const e=require(\"pull-stream\"),r=require(\"pull-length-prefixed\"),t=require(\"../message\"),o=require(\"./handlers\"),i=require(\"../utils\"),n=require(\"../constants\");module.exports=(a=>{const s=i.logger(a.peerInfo.id,\"rpc\"),l=o(a);return function(o,i){i.getPeerInfo((o,d)=>{if(o)return s.error(\"Failed to get peer info\"),void s.error(o);s(\"from: %s\",d.id.toB58String()),e(i,r.decode(),e.filter(e=>e.length<n.maxMessageSize),e.map(e=>{let r;try{r=t.deserialize(e)}catch(o){return void s.error(\"failed to read incoming message\",o)}return r}),e.filter(Boolean),e.asyncMap((e,r)=>(function(e,r,t){a._add(e,o=>{o&&(s.error(\"Failed to update the kbucket store\"),s.error(o));const i=l(r.type);if(!i)return s.error(`no handler found for message type: ${r.type}`),t();i(e,r,t)})})(d,e,r)),e.filter(Boolean),e.map(e=>{let r;try{r=e.serialize()}catch(o){return void s.error(\"failed to send message\",o)}return r}),e.filter(Boolean),r.encode(),i)})}});"},"sourceMaps":{"js":{"mappings":[{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","original":{"line":1,"column":0},"generated":{"line":1,"column":0}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":13}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"pull","original":{"line":3,"column":6},"generated":{"line":1,"column":19}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"require","original":{"line":3,"column":13},"generated":{"line":1,"column":21}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","original":{"line":3,"column":21},"generated":{"line":1,"column":29}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"lp","original":{"line":4,"column":6},"generated":{"line":1,"column":44}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"require","original":{"line":4,"column":11},"generated":{"line":1,"column":46}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","original":{"line":4,"column":19},"generated":{"line":1,"column":54}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"Message","original":{"line":6,"column":6},"generated":{"line":1,"column":78}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"require","original":{"line":6,"column":16},"generated":{"line":1,"column":80}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","original":{"line":6,"column":24},"generated":{"line":1,"column":88}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"handlers","original":{"line":7,"column":6},"generated":{"line":1,"column":102}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"require","original":{"line":7,"column":17},"generated":{"line":1,"column":104}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","original":{"line":7,"column":25},"generated":{"line":1,"column":112}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"utils","original":{"line":8,"column":6},"generated":{"line":1,"column":126}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"require","original":{"line":8,"column":14},"generated":{"line":1,"column":128}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","original":{"line":8,"column":22},"generated":{"line":1,"column":136}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"c","original":{"line":9,"column":6},"generated":{"line":1,"column":148}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"require","original":{"line":9,"column":10},"generated":{"line":1,"column":150}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","original":{"line":9,"column":18},"generated":{"line":1,"column":158}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"module","original":{"line":11,"column":0},"generated":{"line":1,"column":174}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"exports","original":{"line":11,"column":7},"generated":{"line":1,"column":181}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"dht","original":{"line":11,"column":18},"generated":{"line":1,"column":189}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"dht","original":{"line":11,"column":18},"generated":{"line":1,"column":190}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"log","original":{"line":12,"column":8},"generated":{"line":1,"column":194}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"log","original":{"line":12,"column":8},"generated":{"line":1,"column":200}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"utils","original":{"line":12,"column":14},"generated":{"line":1,"column":202}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"logger","original":{"line":12,"column":20},"generated":{"line":1,"column":204}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"dht","original":{"line":12,"column":27},"generated":{"line":1,"column":211}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"peerInfo","original":{"line":12,"column":31},"generated":{"line":1,"column":213}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"id","original":{"line":12,"column":40},"generated":{"line":1,"column":222}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","original":{"line":12,"column":44},"generated":{"line":1,"column":225}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"getMessageHandler","original":{"line":14,"column":8},"generated":{"line":1,"column":232}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"handlers","original":{"line":14,"column":28},"generated":{"line":1,"column":234}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"dht","original":{"line":14,"column":37},"generated":{"line":1,"column":236}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","original":{"line":52,"column":9},"generated":{"line":1,"column":239}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","original":{"line":52,"column":9},"generated":{"line":1,"column":246}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"protocol","original":{"line":52,"column":35},"generated":{"line":1,"column":255}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"conn","original":{"line":52,"column":45},"generated":{"line":1,"column":257}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"conn","original":{"line":53,"column":4},"generated":{"line":1,"column":260}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"getPeerInfo","original":{"line":53,"column":9},"generated":{"line":1,"column":262}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","original":{"line":53,"column":21},"generated":{"line":1,"column":274}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"err","original":{"line":53,"column":22},"generated":{"line":1,"column":275}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"peer","original":{"line":53,"column":27},"generated":{"line":1,"column":277}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"err","original":{"line":54,"column":10},"generated":{"line":1,"column":282}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"err","original":{"line":54,"column":10},"generated":{"line":1,"column":285}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","original":{"line":57,"column":8},"generated":{"line":1,"column":287}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"log","original":{"line":55,"column":8},"generated":{"line":1,"column":294}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"error","original":{"line":55,"column":12},"generated":{"line":1,"column":296}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","original":{"line":55,"column":18},"generated":{"line":1,"column":302}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"log","original":{"line":56,"column":8},"generated":{"line":1,"column":334}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"error","original":{"line":56,"column":12},"generated":{"line":1,"column":336}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"err","original":{"line":56,"column":18},"generated":{"line":1,"column":342}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"log","original":{"line":60,"column":6},"generated":{"line":1,"column":345}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","original":{"line":60,"column":10},"generated":{"line":1,"column":347}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"peer","original":{"line":60,"column":22},"generated":{"line":1,"column":358}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"id","original":{"line":60,"column":27},"generated":{"line":1,"column":360}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"toB58String","original":{"line":60,"column":30},"generated":{"line":1,"column":363}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"pull","original":{"line":62,"column":6},"generated":{"line":1,"column":378}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"conn","original":{"line":63,"column":8},"generated":{"line":1,"column":380}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"lp","original":{"line":64,"column":8},"generated":{"line":1,"column":382}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"decode","original":{"line":64,"column":11},"generated":{"line":1,"column":384}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"pull","original":{"line":65,"column":8},"generated":{"line":1,"column":393}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"filter","original":{"line":65,"column":13},"generated":{"line":1,"column":395}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"msg","original":{"line":65,"column":21},"generated":{"line":1,"column":402}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"msg","original":{"line":65,"column":29},"generated":{"line":1,"column":405}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"length","original":{"line":65,"column":33},"generated":{"line":1,"column":407}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"c","original":{"line":65,"column":42},"generated":{"line":1,"column":414}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"maxMessageSize","original":{"line":65,"column":44},"generated":{"line":1,"column":416}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"pull","original":{"line":66,"column":8},"generated":{"line":1,"column":432}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"map","original":{"line":66,"column":13},"generated":{"line":1,"column":434}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"rawMsg","original":{"line":66,"column":18},"generated":{"line":1,"column":438}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"msg","original":{"line":67,"column":14},"generated":{"line":1,"column":442}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"msg","original":{"line":67,"column":14},"generated":{"line":1,"column":446}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","original":{"line":68,"column":14},"generated":{"line":1,"column":448}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"msg","original":{"line":69,"column":12},"generated":{"line":1,"column":452}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"Message","original":{"line":69,"column":18},"generated":{"line":1,"column":454}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"deserialize","original":{"line":69,"column":26},"generated":{"line":1,"column":456}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"rawMsg","original":{"line":69,"column":38},"generated":{"line":1,"column":468}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","original":{"line":70,"column":12},"generated":{"line":1,"column":471}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"err","original":{"line":70,"column":19},"generated":{"line":1,"column":477}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","original":{"line":72,"column":12},"generated":{"line":1,"column":480}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"log","original":{"line":71,"column":12},"generated":{"line":1,"column":492}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"error","original":{"line":71,"column":16},"generated":{"line":1,"column":494}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","original":{"line":71,"column":22},"generated":{"line":1,"column":500}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"err","original":{"line":71,"column":57},"generated":{"line":1,"column":534}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"msg","original":{"line":75,"column":17},"generated":{"line":1,"column":537}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"msg","original":{"line":75,"column":17},"generated":{"line":1,"column":544}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"pull","original":{"line":77,"column":8},"generated":{"line":1,"column":548}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"filter","original":{"line":77,"column":13},"generated":{"line":1,"column":550}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"Boolean","original":{"line":77,"column":20},"generated":{"line":1,"column":557}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"pull","original":{"line":78,"column":8},"generated":{"line":1,"column":566}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"asyncMap","original":{"line":78,"column":13},"generated":{"line":1,"column":568}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","original":{"line":78,"column":22},"generated":{"line":1,"column":577}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"msg","original":{"line":78,"column":23},"generated":{"line":1,"column":578}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"cb","original":{"line":78,"column":28},"generated":{"line":1,"column":580}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"handleMessage","original":{"line":25,"column":11},"generated":{"line":1,"column":585}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"peer","original":{"line":25,"column":26},"generated":{"line":1,"column":594}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"msg","original":{"line":25,"column":32},"generated":{"line":1,"column":596}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"callback","original":{"line":25,"column":37},"generated":{"line":1,"column":598}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"dht","original":{"line":27,"column":4},"generated":{"line":1,"column":601}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"_add","original":{"line":27,"column":8},"generated":{"line":1,"column":603}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"peer","original":{"line":27,"column":13},"generated":{"line":1,"column":608}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"err","original":{"line":27,"column":20},"generated":{"line":1,"column":610}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"err","original":{"line":28,"column":10},"generated":{"line":1,"column":614}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"log","original":{"line":29,"column":8},"generated":{"line":1,"column":618}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"error","original":{"line":29,"column":12},"generated":{"line":1,"column":620}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","original":{"line":29,"column":18},"generated":{"line":1,"column":626}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"log","original":{"line":30,"column":8},"generated":{"line":1,"column":664}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"error","original":{"line":30,"column":12},"generated":{"line":1,"column":666}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"err","original":{"line":30,"column":18},"generated":{"line":1,"column":672}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"handler","original":{"line":34,"column":12},"generated":{"line":1,"column":676}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"handler","original":{"line":34,"column":12},"generated":{"line":1,"column":682}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"getMessageHandler","original":{"line":34,"column":22},"generated":{"line":1,"column":684}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"msg","original":{"line":34,"column":40},"generated":{"line":1,"column":686}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"type","original":{"line":34,"column":44},"generated":{"line":1,"column":688}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","original":{"line":36,"column":10},"generated":{"line":1,"column":694}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"handler","original":{"line":36,"column":11},"generated":{"line":1,"column":698}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"callback","original":{"line":38,"column":15},"generated":{"line":1,"column":700}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"log","original":{"line":37,"column":8},"generated":{"line":1,"column":707}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"error","original":{"line":37,"column":12},"generated":{"line":1,"column":709}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"msg","original":{"line":37,"column":56},"generated":{"line":1,"column":753}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"type","original":{"line":37,"column":60},"generated":{"line":1,"column":755}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"callback","original":{"line":38,"column":15},"generated":{"line":1,"column":763}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"handler","original":{"line":41,"column":6},"generated":{"line":1,"column":767}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"peer","original":{"line":41,"column":14},"generated":{"line":1,"column":769}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"msg","original":{"line":41,"column":20},"generated":{"line":1,"column":771}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"callback","original":{"line":41,"column":25},"generated":{"line":1,"column":773}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"handleMessage","original":{"line":78,"column":35},"generated":{"line":1,"column":779}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"peer","original":{"line":78,"column":49},"generated":{"line":1,"column":780}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"msg","original":{"line":78,"column":55},"generated":{"line":1,"column":782}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"cb","original":{"line":78,"column":60},"generated":{"line":1,"column":784}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"pull","original":{"line":80,"column":8},"generated":{"line":1,"column":788}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"filter","original":{"line":80,"column":13},"generated":{"line":1,"column":790}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"Boolean","original":{"line":80,"column":20},"generated":{"line":1,"column":797}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"pull","original":{"line":81,"column":8},"generated":{"line":1,"column":806}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"map","original":{"line":81,"column":13},"generated":{"line":1,"column":808}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"response","original":{"line":81,"column":18},"generated":{"line":1,"column":812}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"msg","original":{"line":82,"column":14},"generated":{"line":1,"column":816}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"msg","original":{"line":82,"column":14},"generated":{"line":1,"column":820}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","original":{"line":83,"column":14},"generated":{"line":1,"column":822}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"msg","original":{"line":84,"column":12},"generated":{"line":1,"column":826}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"response","original":{"line":84,"column":18},"generated":{"line":1,"column":828}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"serialize","original":{"line":84,"column":27},"generated":{"line":1,"column":830}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","original":{"line":85,"column":12},"generated":{"line":1,"column":842}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"err","original":{"line":85,"column":19},"generated":{"line":1,"column":848}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","original":{"line":87,"column":12},"generated":{"line":1,"column":851}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"log","original":{"line":86,"column":12},"generated":{"line":1,"column":863}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"error","original":{"line":86,"column":16},"generated":{"line":1,"column":865}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","original":{"line":86,"column":22},"generated":{"line":1,"column":871}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"err","original":{"line":86,"column":48},"generated":{"line":1,"column":896}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"msg","original":{"line":89,"column":17},"generated":{"line":1,"column":899}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"msg","original":{"line":89,"column":17},"generated":{"line":1,"column":906}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"pull","original":{"line":91,"column":8},"generated":{"line":1,"column":910}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"filter","original":{"line":91,"column":13},"generated":{"line":1,"column":912}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"Boolean","original":{"line":91,"column":20},"generated":{"line":1,"column":919}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"lp","original":{"line":92,"column":8},"generated":{"line":1,"column":928}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"encode","original":{"line":92,"column":11},"generated":{"line":1,"column":930}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js","name":"conn","original":{"line":93,"column":8},"generated":{"line":1,"column":939}}],"sources":{"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/index.js":"'use strict'\n\nconst pull = require('pull-stream')\nconst lp = require('pull-length-prefixed')\n\nconst Message = require('../message')\nconst handlers = require('./handlers')\nconst utils = require('../utils')\nconst c = require('../constants')\n\nmodule.exports = (dht) => {\n  const log = utils.logger(dht.peerInfo.id, 'rpc')\n\n  const getMessageHandler = handlers(dht)\n  /**\n   * Process incoming DHT messages.\n   *\n   * @param {PeerInfo} peer\n   * @param {Message} msg\n   * @param {function(Error, Message)} callback\n   * @returns {void}\n   *\n   * @private\n   */\n  function handleMessage (peer, msg, callback) {\n    // update the peer\n    dht._add(peer, (err) => {\n      if (err) {\n        log.error('Failed to update the kbucket store')\n        log.error(err)\n      }\n\n      // get handler & exectue it\n      const handler = getMessageHandler(msg.type)\n\n      if (!handler) {\n        log.error(`no handler found for message type: ${msg.type}`)\n        return callback()\n      }\n\n      handler(peer, msg, callback)\n    })\n  }\n\n  /**\n   * Handle incoming streams from the Switch, on the dht protocol.\n   *\n   * @param {string} protocol\n   * @param {Connection} conn\n   * @returns {undefined}\n   */\n  return function protocolHandler (protocol, conn) {\n    conn.getPeerInfo((err, peer) => {\n      if (err) {\n        log.error('Failed to get peer info')\n        log.error(err)\n        return\n      }\n\n      log('from: %s', peer.id.toB58String())\n\n      pull(\n        conn,\n        lp.decode(),\n        pull.filter((msg) => msg.length < c.maxMessageSize),\n        pull.map((rawMsg) => {\n          let msg\n          try {\n            msg = Message.deserialize(rawMsg)\n          } catch (err) {\n            log.error('failed to read incoming message', err)\n            return\n          }\n\n          return msg\n        }),\n        pull.filter(Boolean),\n        pull.asyncMap((msg, cb) => handleMessage(peer, msg, cb)),\n        // Not all handlers will return a response\n        pull.filter(Boolean),\n        pull.map((response) => {\n          let msg\n          try {\n            msg = response.serialize()\n          } catch (err) {\n            log.error('failed to send message', err)\n            return\n          }\n          return msg\n        }),\n        pull.filter(Boolean),\n        lp.encode(),\n        conn\n      )\n    })\n  }\n}\n"},"lineCount":null}},"error":null,"hash":"fe9e586fcaec73e80284a04fc5acd912","cacheData":{"env":{}}}