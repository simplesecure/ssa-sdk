{"id":"F9R5","dependencies":[{"name":"/Users/polluterofminds/Development/simpleid/ssa-sdk/package.json","includedInParent":true,"mtime":1584306008866},{"name":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-kad-dht/package.json","includedInParent":true,"mtime":1582579780032},{"name":"cids","loc":{"line":3,"column":20},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/cids/src/index.js"},{"name":"err-code","loc":{"line":4,"column":24},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-kad-dht/node_modules/err-code/index.js"},{"name":"promise-to-callback","loc":{"line":5,"column":34},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/promise-to-callback/index.js"},{"name":"../../utils","loc":{"line":7,"column":22},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-kad-dht/src/utils.js"}],"generated":{"js":"\"use strict\";const r=require(\"cids\"),e=require(\"err-code\"),i=require(\"promise-to-callback\"),d=require(\"../../utils\");module.exports=(o=>{const t=d.logger(o.peerInfo.id,\"rpc:add-provider\");return function(d,s,n){if(t(\"start\"),!s.key||0===s.key.length)return n(e(new Error(\"Missing key\"),\"ERR_MISSING_KEY\"));let a;try{a=new r(s.key)}catch(l){const r=`Invalid CID: ${l.message}`;return n(e(new Error(r),\"ERR_INVALID_CID\"))}let c=!1;s.providerPeers.forEach(r=>{r.id.isEqual(d.id)?r.multiaddrs.size<1?t(\"no valid addresses for provider %s. Ignore\",d.id.toB58String()):(t(\"received provider %s for %s (addrs %s)\",d.id.toB58String(),a.toBaseEncodedString(),r.multiaddrs.toArray().map(r=>r.toString())),o._isSelf(r.id)||(c=!0,o.peerBook.put(r),i(o.providers.addProvider(a,r.id))(r=>n(r)))):t(\"invalid provider peer %s from %s\",r.id.toB58String(),d.id.toB58String())}),c||i(o.providers.addProvider(a,d.id))(r=>n(r))}});"},"sourceMaps":{"js":{"mappings":[{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","original":{"line":1,"column":0},"generated":{"line":1,"column":0}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","original":{"line":3,"column":0},"generated":{"line":1,"column":13}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"CID","original":{"line":3,"column":6},"generated":{"line":1,"column":19}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"require","original":{"line":3,"column":12},"generated":{"line":1,"column":21}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","original":{"line":3,"column":20},"generated":{"line":1,"column":29}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"errcode","original":{"line":4,"column":6},"generated":{"line":1,"column":37}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"require","original":{"line":4,"column":16},"generated":{"line":1,"column":39}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","original":{"line":4,"column":24},"generated":{"line":1,"column":47}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"promiseToCallback","original":{"line":5,"column":6},"generated":{"line":1,"column":59}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"require","original":{"line":5,"column":26},"generated":{"line":1,"column":61}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","original":{"line":5,"column":34},"generated":{"line":1,"column":69}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"utils","original":{"line":7,"column":6},"generated":{"line":1,"column":92}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"require","original":{"line":7,"column":14},"generated":{"line":1,"column":94}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","original":{"line":7,"column":22},"generated":{"line":1,"column":102}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"module","original":{"line":9,"column":0},"generated":{"line":1,"column":117}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"exports","original":{"line":9,"column":7},"generated":{"line":1,"column":124}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"dht","original":{"line":9,"column":18},"generated":{"line":1,"column":132}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"dht","original":{"line":9,"column":18},"generated":{"line":1,"column":133}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"log","original":{"line":10,"column":8},"generated":{"line":1,"column":137}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"log","original":{"line":10,"column":8},"generated":{"line":1,"column":143}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"utils","original":{"line":10,"column":14},"generated":{"line":1,"column":145}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"logger","original":{"line":10,"column":20},"generated":{"line":1,"column":147}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"dht","original":{"line":10,"column":27},"generated":{"line":1,"column":154}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"peerInfo","original":{"line":10,"column":31},"generated":{"line":1,"column":156}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"id","original":{"line":10,"column":40},"generated":{"line":1,"column":165}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","original":{"line":10,"column":44},"generated":{"line":1,"column":168}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","original":{"line":19,"column":9},"generated":{"line":1,"column":188}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","original":{"line":19,"column":9},"generated":{"line":1,"column":195}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"peer","original":{"line":19,"column":31},"generated":{"line":1,"column":204}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"msg","original":{"line":19,"column":37},"generated":{"line":1,"column":206}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"callback","original":{"line":19,"column":42},"generated":{"line":1,"column":208}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","original":{"line":22,"column":8},"generated":{"line":1,"column":211}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"log","original":{"line":20,"column":4},"generated":{"line":1,"column":214}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","original":{"line":20,"column":8},"generated":{"line":1,"column":216}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"msg","original":{"line":22,"column":9},"generated":{"line":1,"column":226}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"key","original":{"line":22,"column":13},"generated":{"line":1,"column":228}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","original":{"line":22,"column":39},"generated":{"line":1,"column":233}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"msg","original":{"line":22,"column":20},"generated":{"line":1,"column":237}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"key","original":{"line":22,"column":24},"generated":{"line":1,"column":239}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"length","original":{"line":22,"column":28},"generated":{"line":1,"column":243}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"callback","original":{"line":23,"column":13},"generated":{"line":1,"column":250}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"callback","original":{"line":23,"column":13},"generated":{"line":1,"column":257}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"errcode","original":{"line":23,"column":22},"generated":{"line":1,"column":259}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","original":{"line":23,"column":30},"generated":{"line":1,"column":261}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"Error","original":{"line":23,"column":34},"generated":{"line":1,"column":265}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","original":{"line":23,"column":40},"generated":{"line":1,"column":271}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","original":{"line":23,"column":56},"generated":{"line":1,"column":286}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"cid","original":{"line":26,"column":8},"generated":{"line":1,"column":306}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"cid","original":{"line":26,"column":8},"generated":{"line":1,"column":310}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","original":{"line":27,"column":8},"generated":{"line":1,"column":312}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"cid","original":{"line":28,"column":6},"generated":{"line":1,"column":316}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","original":{"line":28,"column":12},"generated":{"line":1,"column":318}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"CID","original":{"line":28,"column":16},"generated":{"line":1,"column":322}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"msg","original":{"line":28,"column":20},"generated":{"line":1,"column":324}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"key","original":{"line":28,"column":24},"generated":{"line":1,"column":326}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","original":{"line":29,"column":6},"generated":{"line":1,"column":331}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"err","original":{"line":29,"column":13},"generated":{"line":1,"column":337}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"errMsg","original":{"line":30,"column":12},"generated":{"line":1,"column":340}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"errMsg","original":{"line":30,"column":12},"generated":{"line":1,"column":346}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"err","original":{"line":30,"column":37},"generated":{"line":1,"column":364}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"message","original":{"line":30,"column":41},"generated":{"line":1,"column":366}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"callback","original":{"line":32,"column":13},"generated":{"line":1,"column":376}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"callback","original":{"line":32,"column":13},"generated":{"line":1,"column":383}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"errcode","original":{"line":32,"column":22},"generated":{"line":1,"column":385}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","original":{"line":32,"column":30},"generated":{"line":1,"column":387}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"Error","original":{"line":32,"column":34},"generated":{"line":1,"column":391}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"errMsg","original":{"line":32,"column":40},"generated":{"line":1,"column":397}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","original":{"line":32,"column":49},"generated":{"line":1,"column":400}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"foundProvider","original":{"line":35,"column":8},"generated":{"line":1,"column":420}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"foundProvider","original":{"line":35,"column":8},"generated":{"line":1,"column":424}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","original":{"line":35,"column":24},"generated":{"line":1,"column":427}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"msg","original":{"line":36,"column":4},"generated":{"line":1,"column":429}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"providerPeers","original":{"line":36,"column":8},"generated":{"line":1,"column":431}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"forEach","original":{"line":36,"column":22},"generated":{"line":1,"column":445}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"pi","original":{"line":36,"column":31},"generated":{"line":1,"column":453}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"pi","original":{"line":38,"column":11},"generated":{"line":1,"column":457}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"id","original":{"line":38,"column":14},"generated":{"line":1,"column":459}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"isEqual","original":{"line":38,"column":17},"generated":{"line":1,"column":462}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"peer","original":{"line":38,"column":25},"generated":{"line":1,"column":470}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"id","original":{"line":38,"column":30},"generated":{"line":1,"column":472}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"pi","original":{"line":43,"column":10},"generated":{"line":1,"column":476}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"multiaddrs","original":{"line":43,"column":13},"generated":{"line":1,"column":478}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"size","original":{"line":43,"column":24},"generated":{"line":1,"column":489}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","original":{"line":43,"column":31},"generated":{"line":1,"column":494}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"log","original":{"line":44,"column":8},"generated":{"line":1,"column":496}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","original":{"line":44,"column":12},"generated":{"line":1,"column":498}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"peer","original":{"line":44,"column":58},"generated":{"line":1,"column":543}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"id","original":{"line":44,"column":63},"generated":{"line":1,"column":545}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"toB58String","original":{"line":44,"column":66},"generated":{"line":1,"column":548}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"log","original":{"line":48,"column":6},"generated":{"line":1,"column":564}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","original":{"line":48,"column":10},"generated":{"line":1,"column":566}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"peer","original":{"line":48,"column":52},"generated":{"line":1,"column":607}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"id","original":{"line":48,"column":57},"generated":{"line":1,"column":609}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"toB58String","original":{"line":48,"column":60},"generated":{"line":1,"column":612}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"cid","original":{"line":48,"column":75},"generated":{"line":1,"column":626}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"toBaseEncodedString","original":{"line":48,"column":79},"generated":{"line":1,"column":628}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"pi","original":{"line":48,"column":102},"generated":{"line":1,"column":650}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"multiaddrs","original":{"line":48,"column":105},"generated":{"line":1,"column":652}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"toArray","original":{"line":48,"column":116},"generated":{"line":1,"column":663}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"map","original":{"line":48,"column":126},"generated":{"line":1,"column":673}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"m","original":{"line":48,"column":131},"generated":{"line":1,"column":677}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"m","original":{"line":48,"column":137},"generated":{"line":1,"column":680}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"toString","original":{"line":48,"column":139},"generated":{"line":1,"column":682}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"dht","original":{"line":50,"column":11},"generated":{"line":1,"column":695}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"_isSelf","original":{"line":50,"column":15},"generated":{"line":1,"column":697}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"pi","original":{"line":50,"column":23},"generated":{"line":1,"column":705}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"id","original":{"line":50,"column":26},"generated":{"line":1,"column":707}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"foundProvider","original":{"line":51,"column":8},"generated":{"line":1,"column":713}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","original":{"line":51,"column":24},"generated":{"line":1,"column":716}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"dht","original":{"line":52,"column":8},"generated":{"line":1,"column":718}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"peerBook","original":{"line":52,"column":12},"generated":{"line":1,"column":720}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"put","original":{"line":52,"column":21},"generated":{"line":1,"column":729}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"pi","original":{"line":52,"column":25},"generated":{"line":1,"column":733}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"promiseToCallback","original":{"line":53,"column":8},"generated":{"line":1,"column":736}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"dht","original":{"line":53,"column":26},"generated":{"line":1,"column":738}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"providers","original":{"line":53,"column":30},"generated":{"line":1,"column":740}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"addProvider","original":{"line":53,"column":40},"generated":{"line":1,"column":750}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"cid","original":{"line":53,"column":52},"generated":{"line":1,"column":762}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"pi","original":{"line":53,"column":57},"generated":{"line":1,"column":764}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"id","original":{"line":53,"column":60},"generated":{"line":1,"column":766}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"promiseToCallback","original":{"line":53,"column":8},"generated":{"line":1,"column":770}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"err","original":{"line":53,"column":65},"generated":{"line":1,"column":771}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"callback","original":{"line":53,"column":72},"generated":{"line":1,"column":774}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"err","original":{"line":53,"column":81},"generated":{"line":1,"column":776}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"log","original":{"line":39,"column":8},"generated":{"line":1,"column":782}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","original":{"line":39,"column":12},"generated":{"line":1,"column":784}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"pi","original":{"line":39,"column":48},"generated":{"line":1,"column":819}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"id","original":{"line":39,"column":51},"generated":{"line":1,"column":821}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"toB58String","original":{"line":39,"column":54},"generated":{"line":1,"column":824}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"peer","original":{"line":39,"column":69},"generated":{"line":1,"column":838}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"id","original":{"line":39,"column":74},"generated":{"line":1,"column":840}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"toB58String","original":{"line":39,"column":77},"generated":{"line":1,"column":843}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"foundProvider","original":{"line":63,"column":9},"generated":{"line":1,"column":860}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"promiseToCallback","original":{"line":64,"column":6},"generated":{"line":1,"column":863}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"dht","original":{"line":64,"column":24},"generated":{"line":1,"column":865}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"providers","original":{"line":64,"column":28},"generated":{"line":1,"column":867}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"addProvider","original":{"line":64,"column":38},"generated":{"line":1,"column":877}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"cid","original":{"line":64,"column":50},"generated":{"line":1,"column":889}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"peer","original":{"line":64,"column":55},"generated":{"line":1,"column":891}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"id","original":{"line":64,"column":60},"generated":{"line":1,"column":893}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"promiseToCallback","original":{"line":64,"column":6},"generated":{"line":1,"column":897}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"err","original":{"line":64,"column":65},"generated":{"line":1,"column":898}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"callback","original":{"line":64,"column":72},"generated":{"line":1,"column":901}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js","name":"err","original":{"line":64,"column":81},"generated":{"line":1,"column":903}}],"sources":{"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/add-provider.js":"'use strict'\n\nconst CID = require('cids')\nconst errcode = require('err-code')\nconst promiseToCallback = require('promise-to-callback')\n\nconst utils = require('../../utils')\n\nmodule.exports = (dht) => {\n  const log = utils.logger(dht.peerInfo.id, 'rpc:add-provider')\n  /**\n   * Process `AddProvider` DHT messages.\n   *\n   * @param {PeerInfo} peer\n   * @param {Message} msg\n   * @param {function(Error)} callback\n   * @returns {undefined}\n   */\n  return function addProvider (peer, msg, callback) {\n    log('start')\n\n    if (!msg.key || msg.key.length === 0) {\n      return callback(errcode(new Error('Missing key'), 'ERR_MISSING_KEY'))\n    }\n\n    let cid\n    try {\n      cid = new CID(msg.key)\n    } catch (err) {\n      const errMsg = `Invalid CID: ${err.message}`\n\n      return callback(errcode(new Error(errMsg), 'ERR_INVALID_CID'))\n    }\n\n    let foundProvider = false\n    msg.providerPeers.forEach((pi) => {\n      // Ignore providers not from the originator\n      if (!pi.id.isEqual(peer.id)) {\n        log('invalid provider peer %s from %s', pi.id.toB58String(), peer.id.toB58String())\n        return\n      }\n\n      if (pi.multiaddrs.size < 1) {\n        log('no valid addresses for provider %s. Ignore', peer.id.toB58String())\n        return\n      }\n\n      log('received provider %s for %s (addrs %s)', peer.id.toB58String(), cid.toBaseEncodedString(), pi.multiaddrs.toArray().map((m) => m.toString()))\n\n      if (!dht._isSelf(pi.id)) {\n        foundProvider = true\n        dht.peerBook.put(pi)\n        promiseToCallback(dht.providers.addProvider(cid, pi.id))(err => callback(err))\n      }\n    })\n\n    // Previous versions of the JS DHT sent erroneous providers in the\n    // `providerPeers` field. In order to accommodate older clients that have\n    // this bug, we fall back to assuming the originator is the provider if\n    // we can't find any valid providers in the payload.\n    // https://github.com/libp2p/js-libp2p-kad-dht/pull/127\n    // https://github.com/libp2p/js-libp2p-kad-dht/issues/128\n    if (!foundProvider) {\n      promiseToCallback(dht.providers.addProvider(cid, peer.id))(err => callback(err))\n    }\n  }\n}\n"},"lineCount":null}},"error":null,"hash":"9faa62a65358de6dc74962604d48afff","cacheData":{"env":{}}}