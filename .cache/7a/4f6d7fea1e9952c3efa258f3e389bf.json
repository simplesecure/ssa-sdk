{"id":"E1T8","dependencies":[{"name":"/Users/polluterofminds/Development/simpleid/ssa-sdk/package.json","includedInParent":true,"mtime":1584306008866},{"name":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/datastore-core/package.json","includedInParent":true,"mtime":1582579787025},{"name":"interface-datastore","loc":{"line":3,"column":20},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/datastore-core/src/namespace.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/datastore-core/node_modules/interface-datastore/src/index.js"},{"name":"./keytransform","loc":{"line":4,"column":38},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/datastore-core/src/namespace.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/datastore-core/src/keytransform.js"}],"generated":{"js":"\"use strict\";const r=require(\"interface-datastore\").Key,e=require(\"./keytransform\");class t extends e{constructor(e,t){super(e,{convert:r=>t.child(r),invert(e){if(\"/\"===t.toString())return e;if(!t.isAncestorOf(e))throw new Error(`Expected prefix: (${t.toString()}) in key: ${e.toString()}`);return new r(e.toString().slice(t.toString().length),!1)}}),this.prefix=t}query(e){return e.prefix&&\"/\"!==this.prefix.toString()?super.query(Object.assign({},e,{prefix:this.prefix.child(new r(e.prefix)).toString()})):super.query(e)}}module.exports=t;"},"sourceMaps":{"js":{"mappings":[{"source":"node_modules/datastore-core/src/namespace.js","original":{"line":1,"column":0},"generated":{"line":1,"column":0}},{"source":"node_modules/datastore-core/src/namespace.js","original":{"line":3,"column":0},"generated":{"line":1,"column":13}},{"source":"node_modules/datastore-core/src/namespace.js","name":"Key","original":{"line":3,"column":6},"generated":{"line":1,"column":19}},{"source":"node_modules/datastore-core/src/namespace.js","name":"require","original":{"line":3,"column":12},"generated":{"line":1,"column":21}},{"source":"node_modules/datastore-core/src/namespace.js","original":{"line":3,"column":20},"generated":{"line":1,"column":29}},{"source":"node_modules/datastore-core/src/namespace.js","name":"Key","original":{"line":3,"column":43},"generated":{"line":1,"column":52}},{"source":"node_modules/datastore-core/src/namespace.js","name":"KeytransformDatastore","original":{"line":4,"column":6},"generated":{"line":1,"column":56}},{"source":"node_modules/datastore-core/src/namespace.js","name":"require","original":{"line":4,"column":30},"generated":{"line":1,"column":58}},{"source":"node_modules/datastore-core/src/namespace.js","original":{"line":4,"column":38},"generated":{"line":1,"column":66}},{"source":"node_modules/datastore-core/src/namespace.js","original":{"line":15,"column":0},"generated":{"line":1,"column":84}},{"source":"node_modules/datastore-core/src/namespace.js","name":"NamespaceDatastore","original":{"line":15,"column":6},"generated":{"line":1,"column":90}},{"source":"node_modules/datastore-core/src/namespace.js","name":"KeytransformDatastore","original":{"line":15,"column":33},"generated":{"line":1,"column":100}},{"source":"node_modules/datastore-core/src/namespace.js","name":"constructor","original":{"line":16,"column":2},"generated":{"line":1,"column":102}},{"source":"node_modules/datastore-core/src/namespace.js","name":"child","original":{"line":16,"column":15},"generated":{"line":1,"column":114}},{"source":"node_modules/datastore-core/src/namespace.js","name":"prefix","original":{"line":16,"column":22},"generated":{"line":1,"column":116}},{"source":"node_modules/datastore-core/src/namespace.js","name":"child","original":{"line":17,"column":10},"generated":{"line":1,"column":119}},{"source":"node_modules/datastore-core/src/namespace.js","name":"child","original":{"line":17,"column":10},"generated":{"line":1,"column":125}},{"source":"node_modules/datastore-core/src/namespace.js","original":{"line":17,"column":17},"generated":{"line":1,"column":127}},{"source":"node_modules/datastore-core/src/namespace.js","name":"convert","original":{"line":18,"column":6},"generated":{"line":1,"column":128}},{"source":"node_modules/datastore-core/src/namespace.js","name":"key","original":{"line":18,"column":15},"generated":{"line":1,"column":136}},{"source":"node_modules/datastore-core/src/namespace.js","name":"prefix","original":{"line":19,"column":15},"generated":{"line":1,"column":139}},{"source":"node_modules/datastore-core/src/namespace.js","name":"child","original":{"line":19,"column":22},"generated":{"line":1,"column":141}},{"source":"node_modules/datastore-core/src/namespace.js","name":"key","original":{"line":19,"column":28},"generated":{"line":1,"column":147}},{"source":"node_modules/datastore-core/src/namespace.js","name":"invert","original":{"line":21,"column":6},"generated":{"line":1,"column":150}},{"source":"node_modules/datastore-core/src/namespace.js","name":"key","original":{"line":21,"column":14},"generated":{"line":1,"column":157}},{"source":"node_modules/datastore-core/src/namespace.js","name":"prefix","original":{"line":22,"column":12},"generated":{"line":1,"column":160}},{"source":"node_modules/datastore-core/src/namespace.js","original":{"line":22,"column":34},"generated":{"line":1,"column":163}},{"source":"node_modules/datastore-core/src/namespace.js","name":"prefix","original":{"line":22,"column":12},"generated":{"line":1,"column":169}},{"source":"node_modules/datastore-core/src/namespace.js","name":"toString","original":{"line":22,"column":19},"generated":{"line":1,"column":171}},{"source":"node_modules/datastore-core/src/namespace.js","name":"key","original":{"line":23,"column":17},"generated":{"line":1,"column":182}},{"source":"node_modules/datastore-core/src/namespace.js","name":"key","original":{"line":23,"column":17},"generated":{"line":1,"column":189}},{"source":"node_modules/datastore-core/src/namespace.js","original":{"line":26,"column":12},"generated":{"line":1,"column":191}},{"source":"node_modules/datastore-core/src/namespace.js","name":"prefix","original":{"line":26,"column":13},"generated":{"line":1,"column":195}},{"source":"node_modules/datastore-core/src/namespace.js","name":"isAncestorOf","original":{"line":26,"column":20},"generated":{"line":1,"column":197}},{"source":"node_modules/datastore-core/src/namespace.js","name":"key","original":{"line":26,"column":33},"generated":{"line":1,"column":210}},{"source":"node_modules/datastore-core/src/namespace.js","original":{"line":27,"column":16},"generated":{"line":1,"column":213}},{"source":"node_modules/datastore-core/src/namespace.js","original":{"line":27,"column":16},"generated":{"line":1,"column":219}},{"source":"node_modules/datastore-core/src/namespace.js","name":"Error","original":{"line":27,"column":20},"generated":{"line":1,"column":223}},{"source":"node_modules/datastore-core/src/namespace.js","name":"prefix","original":{"line":27,"column":47},"generated":{"line":1,"column":250}},{"source":"node_modules/datastore-core/src/namespace.js","name":"toString","original":{"line":27,"column":54},"generated":{"line":1,"column":252}},{"source":"node_modules/datastore-core/src/namespace.js","name":"key","original":{"line":27,"column":77},"generated":{"line":1,"column":275}},{"source":"node_modules/datastore-core/src/namespace.js","name":"toString","original":{"line":27,"column":81},"generated":{"line":1,"column":277}},{"source":"node_modules/datastore-core/src/namespace.js","original":{"line":30,"column":15},"generated":{"line":1,"column":291}},{"source":"node_modules/datastore-core/src/namespace.js","original":{"line":30,"column":15},"generated":{"line":1,"column":298}},{"source":"node_modules/datastore-core/src/namespace.js","name":"Key","original":{"line":30,"column":19},"generated":{"line":1,"column":302}},{"source":"node_modules/datastore-core/src/namespace.js","name":"key","original":{"line":30,"column":23},"generated":{"line":1,"column":304}},{"source":"node_modules/datastore-core/src/namespace.js","name":"toString","original":{"line":30,"column":27},"generated":{"line":1,"column":306}},{"source":"node_modules/datastore-core/src/namespace.js","name":"slice","original":{"line":30,"column":38},"generated":{"line":1,"column":317}},{"source":"node_modules/datastore-core/src/namespace.js","name":"prefix","original":{"line":30,"column":44},"generated":{"line":1,"column":323}},{"source":"node_modules/datastore-core/src/namespace.js","name":"toString","original":{"line":30,"column":51},"generated":{"line":1,"column":325}},{"source":"node_modules/datastore-core/src/namespace.js","name":"length","original":{"line":30,"column":62},"generated":{"line":1,"column":336}},{"source":"node_modules/datastore-core/src/namespace.js","original":{"line":30,"column":71},"generated":{"line":1,"column":345}},{"source":"node_modules/datastore-core/src/namespace.js","name":"prefix","original":{"line":34,"column":9},"generated":{"line":1,"column":351}},{"source":"node_modules/datastore-core/src/namespace.js","name":"prefix","original":{"line":34,"column":9},"generated":{"line":1,"column":356}},{"source":"node_modules/datastore-core/src/namespace.js","name":"prefix","original":{"line":34,"column":18},"generated":{"line":1,"column":363}},{"source":"node_modules/datastore-core/src/namespace.js","name":"query","original":{"line":37,"column":2},"generated":{"line":1,"column":365}},{"source":"node_modules/datastore-core/src/namespace.js","name":"q","original":{"line":37,"column":9},"generated":{"line":1,"column":371}},{"source":"node_modules/datastore-core/src/namespace.js","name":"q","original":{"line":38,"column":8},"generated":{"line":1,"column":374}},{"source":"node_modules/datastore-core/src/namespace.js","name":"q","original":{"line":38,"column":8},"generated":{"line":1,"column":381}},{"source":"node_modules/datastore-core/src/namespace.js","name":"prefix","original":{"line":38,"column":10},"generated":{"line":1,"column":383}},{"source":"node_modules/datastore-core/src/namespace.js","original":{"line":38,"column":47},"generated":{"line":1,"column":391}},{"source":"node_modules/datastore-core/src/namespace.js","original":{"line":38,"column":20},"generated":{"line":1,"column":397}},{"source":"node_modules/datastore-core/src/namespace.js","name":"prefix","original":{"line":38,"column":25},"generated":{"line":1,"column":402}},{"source":"node_modules/datastore-core/src/namespace.js","name":"toString","original":{"line":38,"column":32},"generated":{"line":1,"column":409}},{"source":"node_modules/datastore-core/src/namespace.js","original":{"line":39,"column":13},"generated":{"line":1,"column":420}},{"source":"node_modules/datastore-core/src/namespace.js","name":"query","original":{"line":39,"column":19},"generated":{"line":1,"column":426}},{"source":"node_modules/datastore-core/src/namespace.js","name":"Object","original":{"line":39,"column":25},"generated":{"line":1,"column":432}},{"source":"node_modules/datastore-core/src/namespace.js","name":"assign","original":{"line":39,"column":32},"generated":{"line":1,"column":439}},{"source":"node_modules/datastore-core/src/namespace.js","original":{"line":39,"column":39},"generated":{"line":1,"column":446}},{"source":"node_modules/datastore-core/src/namespace.js","name":"q","original":{"line":39,"column":43},"generated":{"line":1,"column":449}},{"source":"node_modules/datastore-core/src/namespace.js","original":{"line":39,"column":46},"generated":{"line":1,"column":451}},{"source":"node_modules/datastore-core/src/namespace.js","name":"prefix","original":{"line":40,"column":8},"generated":{"line":1,"column":452}},{"source":"node_modules/datastore-core/src/namespace.js","original":{"line":40,"column":16},"generated":{"line":1,"column":459}},{"source":"node_modules/datastore-core/src/namespace.js","name":"prefix","original":{"line":40,"column":21},"generated":{"line":1,"column":464}},{"source":"node_modules/datastore-core/src/namespace.js","name":"child","original":{"line":40,"column":28},"generated":{"line":1,"column":471}},{"source":"node_modules/datastore-core/src/namespace.js","original":{"line":40,"column":34},"generated":{"line":1,"column":477}},{"source":"node_modules/datastore-core/src/namespace.js","name":"Key","original":{"line":40,"column":38},"generated":{"line":1,"column":481}},{"source":"node_modules/datastore-core/src/namespace.js","name":"q","original":{"line":40,"column":42},"generated":{"line":1,"column":483}},{"source":"node_modules/datastore-core/src/namespace.js","name":"prefix","original":{"line":40,"column":44},"generated":{"line":1,"column":485}},{"source":"node_modules/datastore-core/src/namespace.js","name":"toString","original":{"line":40,"column":53},"generated":{"line":1,"column":494}},{"source":"node_modules/datastore-core/src/namespace.js","original":{"line":43,"column":11},"generated":{"line":1,"column":508}},{"source":"node_modules/datastore-core/src/namespace.js","name":"query","original":{"line":43,"column":17},"generated":{"line":1,"column":514}},{"source":"node_modules/datastore-core/src/namespace.js","name":"q","original":{"line":43,"column":23},"generated":{"line":1,"column":520}},{"source":"node_modules/datastore-core/src/namespace.js","name":"module","original":{"line":47,"column":0},"generated":{"line":1,"column":524}},{"source":"node_modules/datastore-core/src/namespace.js","name":"exports","original":{"line":47,"column":7},"generated":{"line":1,"column":531}},{"source":"node_modules/datastore-core/src/namespace.js","name":"NamespaceDatastore","original":{"line":47,"column":17},"generated":{"line":1,"column":539}}],"sources":{"node_modules/datastore-core/src/namespace.js":"'use strict'\n\nconst Key = require('interface-datastore').Key\nconst KeytransformDatastore = require('./keytransform')\n\n/**\n * Wraps a given datastore into a keytransform which\n * makes a given prefix transparent.\n *\n * For example, if the prefix is `new Key(/hello)` a call\n * to `store.put(new Key('/world'), mydata)` would store the data under\n * `/hello/world`.\n *\n */\nclass NamespaceDatastore extends KeytransformDatastore {\n  constructor (child, prefix) {\n    super(child, {\n      convert (key) {\n        return prefix.child(key)\n      },\n      invert (key) {\n        if (prefix.toString() === '/') {\n          return key\n        }\n\n        if (!prefix.isAncestorOf(key)) {\n          throw new Error(`Expected prefix: (${prefix.toString()}) in key: ${key.toString()}`)\n        }\n\n        return new Key(key.toString().slice(prefix.toString().length), false)\n      }\n    })\n\n    this.prefix = prefix\n  }\n\n  query (q) {\n    if (q.prefix && this.prefix.toString() !== '/') {\n      return super.query(Object.assign({}, q, {\n        prefix: this.prefix.child(new Key(q.prefix)).toString()\n      }))\n    }\n    return super.query(q)\n  }\n}\n\nmodule.exports = NamespaceDatastore\n"},"lineCount":null}},"error":null,"hash":"328e0d77ac1d86f79841ae3850a262e4","cacheData":{"env":{}}}