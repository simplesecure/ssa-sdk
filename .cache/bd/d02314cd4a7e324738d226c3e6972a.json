{"id":"iyHN","dependencies":[{"name":"/Users/polluterofminds/Development/simpleid/ssa-sdk/package.json","includedInParent":true,"mtime":1584306008866},{"name":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/package.json","includedInParent":true,"mtime":1582579778668},{"name":"cids","loc":{"line":3,"column":20},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/src/core/components/pin/gc.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/cids/src/index.js"},{"name":"base32.js","loc":{"line":4,"column":23},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/src/core/components/pin/gc.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/base32.js/base32.js"},{"name":"callbackify","loc":{"line":5,"column":28},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/src/core/components/pin/gc.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/callbackify/index.js"},{"name":"../../../utils/cid","loc":{"line":6,"column":32},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/src/core/components/pin/gc.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/src/utils/cid.js"},{"name":"debug","loc":{"line":7,"column":20},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/src/core/components/pin/gc.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/debug/src/browser.js"},{"name":"p-queue","loc":{"line":8,"column":35},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/src/core/components/pin/gc.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/p-queue/dist/index.js"},{"name":"ipfs-mfs/src/core/utils/constants","loc":{"line":11,"column":33},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/src/core/components/pin/gc.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/ipfs-mfs/src/core/utils/constants.js"},{"name":"interface-datastore","loc":{"line":13,"column":27},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/src/core/components/pin/gc.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/interface-datastore/src/index.js"},{"name":"buffer","parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/src/core/components/pin/gc.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/node-libs-browser/node_modules/buffer/index.js"}],"generated":{"js":"var Buffer = require(\"buffer\").Buffer;\nvar e=require(\"buffer\").Buffer;const r=require(\"cids\"),t=require(\"base32.js\"),n=require(\"callbackify\"),{cidToString:o}=require(\"../../../utils/cid\"),s=require(\"debug\")(\"ipfs:gc\"),{default:c}=require(\"p-queue\"),{MFS_ROOT_KEY:a}=require(\"ipfs-mfs/src/core/utils/constants\"),{Errors:i}=require(\"interface-datastore\"),u=i.notFoundError().code,l=256;async function d(e){const t=new Set,n=e=>{s(`Found ${e.length} pinned blocks`),e.forEach(e=>{t.add(o(new r(e),{base:\"base32\"}))})};return await Promise.all([e.pin.ls().then(e=>e.map(e=>e.hash)).then(n),e.pin.pinManager.getInternalBlocks().then(n),e._repo.root.get(a).then(t=>f(e,new r(t))).then(n).catch(e=>{if(e.code===u)return s(\"No blocks in MFS\"),[];throw e})]),t}async function f(e,t){const n=[t,...(await e.refs(t,{recursive:!0})).map(e=>new r(e.ref))];return s(`Found ${n.length} MFS blocks`),n}async function h(e,r,t){const n=[],o=[],a=new c({concurrency:l});for await(const{key:c}of t)try{const t=w(c),u=t.toV1().toString(\"base32\");r.has(u)||(n.push(t),a.add(async()=>{const r={cid:t};try{await e._repo.blocks.delete(t)}catch(n){r.err=new Error(`Could not delete block with CID ${t}: ${n.message}`)}o.push(r)}))}catch(i){const e=`Could not convert block with key '${c}' to CID`;s(e,i),o.push({err:new Error(e+`: ${i.message}`)})}return await a.onIdle(),s(`Marked set has ${r.size} unique blocks. Blockstore has ${t.length} blocks. `+`Deleted ${n.length} blocks.`),o}function w(n){const o=(new t.Decoder).write(n.toString().slice(1)).finalize();return new r(e.from(o))}module.exports=function(e){return n(async()=>{const r=Date.now();s(\"Creating set of marked blocks\");const t=await e._gcLock.writeLock();try{const[n,o]=await Promise.all([e._repo.blocks.query({keysOnly:!0}),d(e)]),c=await h(e,o,n);return s(`Complete (${Date.now()-r}ms)`),c}finally{t()}})};"},"sourceMaps":{"js":{"mappings":[{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":153,"column":1},"generated":{"line":2,"column":0}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":153,"column":1},"generated":{"line":2,"column":4}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":153,"column":1},"generated":{"line":2,"column":6}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":153,"column":1},"generated":{"line":2,"column":14}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":153,"column":1},"generated":{"line":2,"column":24}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":3,"column":0},"generated":{"line":2,"column":31}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"CID","original":{"line":3,"column":6},"generated":{"line":2,"column":37}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"require","original":{"line":3,"column":12},"generated":{"line":2,"column":39}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":3,"column":20},"generated":{"line":2,"column":47}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"base32","original":{"line":4,"column":6},"generated":{"line":2,"column":55}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"require","original":{"line":4,"column":15},"generated":{"line":2,"column":57}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":4,"column":23},"generated":{"line":2,"column":65}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"callbackify","original":{"line":5,"column":6},"generated":{"line":2,"column":78}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"require","original":{"line":5,"column":20},"generated":{"line":2,"column":80}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":5,"column":28},"generated":{"line":2,"column":88}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":6,"column":6},"generated":{"line":2,"column":104}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"cidToString","original":{"line":6,"column":8},"generated":{"line":2,"column":116}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"require","original":{"line":6,"column":24},"generated":{"line":2,"column":119}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":6,"column":32},"generated":{"line":2,"column":127}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"log","original":{"line":7,"column":6},"generated":{"line":2,"column":149}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"require","original":{"line":7,"column":12},"generated":{"line":2,"column":151}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":7,"column":20},"generated":{"line":2,"column":159}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"require","original":{"line":7,"column":12},"generated":{"line":2,"column":167}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":7,"column":29},"generated":{"line":2,"column":168}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"default","original":{"line":8,"column":8},"generated":{"line":2,"column":180}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"Queue","original":{"line":8,"column":17},"generated":{"line":2,"column":188}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"require","original":{"line":8,"column":27},"generated":{"line":2,"column":191}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":8,"column":35},"generated":{"line":2,"column":199}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":11,"column":6},"generated":{"line":2,"column":211}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"MFS_ROOT_KEY","original":{"line":11,"column":8},"generated":{"line":2,"column":224}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"require","original":{"line":11,"column":25},"generated":{"line":2,"column":227}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":11,"column":33},"generated":{"line":2,"column":235}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":13,"column":6},"generated":{"line":2,"column":273}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"Errors","original":{"line":13,"column":8},"generated":{"line":2,"column":280}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"require","original":{"line":13,"column":19},"generated":{"line":2,"column":283}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":13,"column":27},"generated":{"line":2,"column":291}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"ERR_NOT_FOUND","original":{"line":14,"column":6},"generated":{"line":2,"column":314}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"Errors","original":{"line":14,"column":22},"generated":{"line":2,"column":316}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"notFoundError","original":{"line":14,"column":29},"generated":{"line":2,"column":318}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"code","original":{"line":14,"column":45},"generated":{"line":2,"column":334}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"BLOCK_RM_CONCURRENCY","original":{"line":17,"column":6},"generated":{"line":2,"column":339}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":17,"column":29},"generated":{"line":2,"column":341}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":51,"column":0},"generated":{"line":2,"column":345}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"createMarkedSet","original":{"line":51,"column":15},"generated":{"line":2,"column":360}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"ipfs","original":{"line":51,"column":32},"generated":{"line":2,"column":362}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"output","original":{"line":52,"column":8},"generated":{"line":2,"column":365}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"output","original":{"line":52,"column":8},"generated":{"line":2,"column":371}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":52,"column":17},"generated":{"line":2,"column":373}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"Set","original":{"line":52,"column":21},"generated":{"line":2,"column":377}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"addPins","original":{"line":54,"column":8},"generated":{"line":2,"column":381}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"pins","original":{"line":54,"column":18},"generated":{"line":2,"column":383}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"log","original":{"line":55,"column":4},"generated":{"line":2,"column":387}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"pins","original":{"line":55,"column":17},"generated":{"line":2,"column":398}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"length","original":{"line":55,"column":22},"generated":{"line":2,"column":400}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"pins","original":{"line":57,"column":4},"generated":{"line":2,"column":424}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"forEach","original":{"line":57,"column":9},"generated":{"line":2,"column":426}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"pin","original":{"line":57,"column":17},"generated":{"line":2,"column":434}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"output","original":{"line":58,"column":6},"generated":{"line":2,"column":438}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"add","original":{"line":58,"column":13},"generated":{"line":2,"column":440}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"cidToString","original":{"line":58,"column":17},"generated":{"line":2,"column":444}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":58,"column":29},"generated":{"line":2,"column":446}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"CID","original":{"line":58,"column":33},"generated":{"line":2,"column":450}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"pin","original":{"line":58,"column":37},"generated":{"line":2,"column":452}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":58,"column":43},"generated":{"line":2,"column":455}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"base","original":{"line":58,"column":45},"generated":{"line":2,"column":456}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":58,"column":51},"generated":{"line":2,"column":461}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"output","original":{"line":86,"column":9},"generated":{"line":2,"column":476}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"Promise","original":{"line":62,"column":8},"generated":{"line":2,"column":489}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"all","original":{"line":62,"column":16},"generated":{"line":2,"column":497}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":62,"column":20},"generated":{"line":2,"column":501}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"ipfs","original":{"line":64,"column":4},"generated":{"line":2,"column":502}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"pin","original":{"line":64,"column":9},"generated":{"line":2,"column":504}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"ls","original":{"line":64,"column":13},"generated":{"line":2,"column":508}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"then","original":{"line":65,"column":7},"generated":{"line":2,"column":513}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"pins","original":{"line":65,"column":12},"generated":{"line":2,"column":518}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"pins","original":{"line":65,"column":20},"generated":{"line":2,"column":521}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"map","original":{"line":65,"column":25},"generated":{"line":2,"column":523}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"pin","original":{"line":65,"column":29},"generated":{"line":2,"column":527}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"pin","original":{"line":65,"column":36},"generated":{"line":2,"column":530}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"hash","original":{"line":65,"column":40},"generated":{"line":2,"column":532}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"then","original":{"line":66,"column":7},"generated":{"line":2,"column":539}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"addPins","original":{"line":66,"column":12},"generated":{"line":2,"column":544}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"ipfs","original":{"line":69,"column":4},"generated":{"line":2,"column":547}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"pin","original":{"line":69,"column":9},"generated":{"line":2,"column":549}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"pinManager","original":{"line":69,"column":13},"generated":{"line":2,"column":553}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"getInternalBlocks","original":{"line":69,"column":24},"generated":{"line":2,"column":564}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"then","original":{"line":70,"column":7},"generated":{"line":2,"column":584}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"addPins","original":{"line":70,"column":12},"generated":{"line":2,"column":589}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"ipfs","original":{"line":73,"column":4},"generated":{"line":2,"column":592}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"_repo","original":{"line":73,"column":9},"generated":{"line":2,"column":594}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"root","original":{"line":73,"column":15},"generated":{"line":2,"column":600}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"get","original":{"line":73,"column":20},"generated":{"line":2,"column":605}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"MFS_ROOT_KEY","original":{"line":73,"column":24},"generated":{"line":2,"column":609}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"then","original":{"line":74,"column":7},"generated":{"line":2,"column":612}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"mh","original":{"line":74,"column":12},"generated":{"line":2,"column":617}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"getDescendants","original":{"line":74,"column":18},"generated":{"line":2,"column":620}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"ipfs","original":{"line":74,"column":33},"generated":{"line":2,"column":622}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":74,"column":39},"generated":{"line":2,"column":624}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"CID","original":{"line":74,"column":43},"generated":{"line":2,"column":628}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"mh","original":{"line":74,"column":47},"generated":{"line":2,"column":630}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"then","original":{"line":75,"column":7},"generated":{"line":2,"column":635}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"addPins","original":{"line":75,"column":12},"generated":{"line":2,"column":640}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"catch","original":{"line":76,"column":7},"generated":{"line":2,"column":643}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"err","original":{"line":76,"column":13},"generated":{"line":2,"column":649}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"err","original":{"line":77,"column":12},"generated":{"line":2,"column":653}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"err","original":{"line":77,"column":12},"generated":{"line":2,"column":656}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"code","original":{"line":77,"column":16},"generated":{"line":2,"column":658}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"ERR_NOT_FOUND","original":{"line":77,"column":25},"generated":{"line":2,"column":665}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":79,"column":17},"generated":{"line":2,"column":667}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"log","original":{"line":78,"column":10},"generated":{"line":2,"column":674}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":78,"column":14},"generated":{"line":2,"column":676}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":79,"column":17},"generated":{"line":2,"column":696}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"err","original":{"line":82,"column":14},"generated":{"line":2,"column":699}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"err","original":{"line":82,"column":14},"generated":{"line":2,"column":705}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"output","original":{"line":86,"column":9},"generated":{"line":2,"column":711}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":90,"column":0},"generated":{"line":2,"column":713}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"getDescendants","original":{"line":90,"column":15},"generated":{"line":2,"column":728}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"ipfs","original":{"line":90,"column":31},"generated":{"line":2,"column":730}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"cid","original":{"line":90,"column":37},"generated":{"line":2,"column":732}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"refs","original":{"line":91,"column":8},"generated":{"line":2,"column":735}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"cids","original":{"line":92,"column":8},"generated":{"line":2,"column":741}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":92,"column":15},"generated":{"line":2,"column":743}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"cid","original":{"line":92,"column":16},"generated":{"line":2,"column":744}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"ipfs","original":{"line":91,"column":21},"generated":{"line":2,"column":756}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"refs","original":{"line":91,"column":26},"generated":{"line":2,"column":758}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"cid","original":{"line":91,"column":31},"generated":{"line":2,"column":763}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":91,"column":36},"generated":{"line":2,"column":765}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"recursive","original":{"line":91,"column":38},"generated":{"line":2,"column":766}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":91,"column":49},"generated":{"line":2,"column":777}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"map","original":{"line":92,"column":29},"generated":{"line":2,"column":782}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"r","original":{"line":92,"column":33},"generated":{"line":2,"column":786}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":92,"column":38},"generated":{"line":2,"column":789}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"CID","original":{"line":92,"column":42},"generated":{"line":2,"column":793}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"r","original":{"line":92,"column":46},"generated":{"line":2,"column":795}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"ref","original":{"line":92,"column":48},"generated":{"line":2,"column":797}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"cids","original":{"line":96,"column":9},"generated":{"line":2,"column":804}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"log","original":{"line":93,"column":2},"generated":{"line":2,"column":811}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"cids","original":{"line":93,"column":15},"generated":{"line":2,"column":822}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"length","original":{"line":93,"column":20},"generated":{"line":2,"column":824}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"cids","original":{"line":96,"column":9},"generated":{"line":2,"column":845}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":100,"column":0},"generated":{"line":2,"column":847}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"deleteUnmarkedBlocks","original":{"line":100,"column":15},"generated":{"line":2,"column":862}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"ipfs","original":{"line":100,"column":37},"generated":{"line":2,"column":864}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"markedSet","original":{"line":100,"column":43},"generated":{"line":2,"column":866}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"blockKeys","original":{"line":100,"column":54},"generated":{"line":2,"column":868}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"unreferenced","original":{"line":103,"column":8},"generated":{"line":2,"column":871}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"unreferenced","original":{"line":103,"column":8},"generated":{"line":2,"column":877}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":103,"column":23},"generated":{"line":2,"column":879}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"result","original":{"line":104,"column":8},"generated":{"line":2,"column":882}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":104,"column":17},"generated":{"line":2,"column":884}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"queue","original":{"line":106,"column":8},"generated":{"line":2,"column":887}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":106,"column":16},"generated":{"line":2,"column":889}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"Queue","original":{"line":106,"column":20},"generated":{"line":2,"column":893}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":106,"column":26},"generated":{"line":2,"column":895}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"concurrency","original":{"line":107,"column":4},"generated":{"line":2,"column":896}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"BLOCK_RM_CONCURRENCY","original":{"line":107,"column":17},"generated":{"line":2,"column":908}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":110,"column":13},"generated":{"line":2,"column":912}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":110,"column":13},"generated":{"line":2,"column":922}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"key","original":{"line":110,"column":21},"generated":{"line":2,"column":928}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"k","original":{"line":110,"column":26},"generated":{"line":2,"column":932}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"blockKeys","original":{"line":110,"column":33},"generated":{"line":2,"column":937}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":111,"column":8},"generated":{"line":2,"column":939}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"cid","original":{"line":112,"column":12},"generated":{"line":2,"column":943}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"cid","original":{"line":112,"column":12},"generated":{"line":2,"column":949}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"dsKeyToCid","original":{"line":112,"column":18},"generated":{"line":2,"column":951}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"k","original":{"line":112,"column":29},"generated":{"line":2,"column":953}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"b32","original":{"line":113,"column":12},"generated":{"line":2,"column":956}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"cid","original":{"line":113,"column":18},"generated":{"line":2,"column":958}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"toV1","original":{"line":113,"column":22},"generated":{"line":2,"column":960}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"toString","original":{"line":113,"column":29},"generated":{"line":2,"column":967}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":113,"column":38},"generated":{"line":2,"column":976}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"markedSet","original":{"line":114,"column":11},"generated":{"line":2,"column":986}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"has","original":{"line":114,"column":21},"generated":{"line":2,"column":988}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"b32","original":{"line":114,"column":25},"generated":{"line":2,"column":992}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"unreferenced","original":{"line":115,"column":8},"generated":{"line":2,"column":997}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"push","original":{"line":115,"column":21},"generated":{"line":2,"column":999}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"cid","original":{"line":115,"column":26},"generated":{"line":2,"column":1004}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"queue","original":{"line":117,"column":8},"generated":{"line":2,"column":1007}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"add","original":{"line":117,"column":14},"generated":{"line":2,"column":1009}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":117,"column":18},"generated":{"line":2,"column":1013}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"res","original":{"line":118,"column":16},"generated":{"line":2,"column":1023}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"res","original":{"line":118,"column":16},"generated":{"line":2,"column":1029}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":118,"column":22},"generated":{"line":2,"column":1031}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"cid","original":{"line":119,"column":12},"generated":{"line":2,"column":1032}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"cid","original":{"line":119,"column":12},"generated":{"line":2,"column":1036}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":122,"column":14},"generated":{"line":2,"column":1039}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"ipfs","original":{"line":123,"column":18},"generated":{"line":2,"column":1049}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"_repo","original":{"line":123,"column":23},"generated":{"line":2,"column":1051}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"blocks","original":{"line":123,"column":29},"generated":{"line":2,"column":1057}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"delete","original":{"line":123,"column":36},"generated":{"line":2,"column":1064}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"cid","original":{"line":123,"column":43},"generated":{"line":2,"column":1071}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":124,"column":12},"generated":{"line":2,"column":1074}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"err","original":{"line":124,"column":19},"generated":{"line":2,"column":1080}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"res","original":{"line":125,"column":12},"generated":{"line":2,"column":1083}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"err","original":{"line":125,"column":16},"generated":{"line":2,"column":1085}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":125,"column":22},"generated":{"line":2,"column":1089}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"Error","original":{"line":125,"column":26},"generated":{"line":2,"column":1093}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"cid","original":{"line":125,"column":67},"generated":{"line":2,"column":1134}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"err","original":{"line":125,"column":75},"generated":{"line":2,"column":1140}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"message","original":{"line":125,"column":79},"generated":{"line":2,"column":1142}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"result","original":{"line":128,"column":10},"generated":{"line":2,"column":1153}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"push","original":{"line":128,"column":17},"generated":{"line":2,"column":1155}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"res","original":{"line":128,"column":22},"generated":{"line":2,"column":1160}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":131,"column":6},"generated":{"line":2,"column":1166}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"err","original":{"line":131,"column":13},"generated":{"line":2,"column":1172}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"msg","original":{"line":132,"column":12},"generated":{"line":2,"column":1175}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"msg","original":{"line":132,"column":12},"generated":{"line":2,"column":1181}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"k","original":{"line":132,"column":55},"generated":{"line":2,"column":1220}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"log","original":{"line":133,"column":6},"generated":{"line":2,"column":1232}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"msg","original":{"line":133,"column":10},"generated":{"line":2,"column":1234}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"err","original":{"line":133,"column":15},"generated":{"line":2,"column":1236}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"result","original":{"line":134,"column":6},"generated":{"line":2,"column":1239}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"push","original":{"line":134,"column":13},"generated":{"line":2,"column":1241}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":134,"column":18},"generated":{"line":2,"column":1246}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"err","original":{"line":134,"column":20},"generated":{"line":2,"column":1247}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":134,"column":25},"generated":{"line":2,"column":1251}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"Error","original":{"line":134,"column":29},"generated":{"line":2,"column":1255}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"msg","original":{"line":134,"column":35},"generated":{"line":2,"column":1261}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"err","original":{"line":134,"column":46},"generated":{"line":2,"column":1268}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"message","original":{"line":134,"column":50},"generated":{"line":2,"column":1270}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"result","original":{"line":143,"column":9},"generated":{"line":2,"column":1283}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"queue","original":{"line":138,"column":8},"generated":{"line":2,"column":1296}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"onIdle","original":{"line":138,"column":14},"generated":{"line":2,"column":1298}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"log","original":{"line":140,"column":2},"generated":{"line":2,"column":1307}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"markedSet","original":{"line":140,"column":24},"generated":{"line":2,"column":1327}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"size","original":{"line":140,"column":34},"generated":{"line":2,"column":1329}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"blockKeys","original":{"line":140,"column":72},"generated":{"line":2,"column":1367}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"length","original":{"line":140,"column":82},"generated":{"line":2,"column":1369}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"unreferenced","original":{"line":141,"column":13},"generated":{"line":2,"column":1398}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"length","original":{"line":141,"column":26},"generated":{"line":2,"column":1400}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"result","original":{"line":143,"column":9},"generated":{"line":2,"column":1418}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":148,"column":0},"generated":{"line":2,"column":1420}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"dsKeyToCid","original":{"line":148,"column":9},"generated":{"line":2,"column":1429}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"key","original":{"line":148,"column":21},"generated":{"line":2,"column":1431}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"decoder","original":{"line":150,"column":8},"generated":{"line":2,"column":1434}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"buff","original":{"line":151,"column":8},"generated":{"line":2,"column":1440}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":150,"column":18},"generated":{"line":2,"column":1443}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"base32","original":{"line":150,"column":22},"generated":{"line":2,"column":1447}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"Decoder","original":{"line":150,"column":29},"generated":{"line":2,"column":1449}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"write","original":{"line":151,"column":23},"generated":{"line":2,"column":1458}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"key","original":{"line":151,"column":29},"generated":{"line":2,"column":1464}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"toString","original":{"line":151,"column":33},"generated":{"line":2,"column":1466}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"slice","original":{"line":151,"column":44},"generated":{"line":2,"column":1477}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":151,"column":50},"generated":{"line":2,"column":1483}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"finalize","original":{"line":151,"column":54},"generated":{"line":2,"column":1487}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":152,"column":9},"generated":{"line":2,"column":1498}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":152,"column":9},"generated":{"line":2,"column":1505}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"CID","original":{"line":152,"column":13},"generated":{"line":2,"column":1509}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"Buffer","original":{"line":152,"column":17},"generated":{"line":2,"column":1511}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"from","original":{"line":152,"column":24},"generated":{"line":2,"column":1513}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"buff","original":{"line":152,"column":29},"generated":{"line":2,"column":1518}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"module","original":{"line":20,"column":0},"generated":{"line":2,"column":1522}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"exports","original":{"line":20,"column":7},"generated":{"line":2,"column":1529}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":20,"column":17},"generated":{"line":2,"column":1537}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"self","original":{"line":20,"column":30},"generated":{"line":2,"column":1546}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"callbackify","original":{"line":21,"column":9},"generated":{"line":2,"column":1549}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"callbackify","original":{"line":21,"column":9},"generated":{"line":2,"column":1556}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":21,"column":21},"generated":{"line":2,"column":1558}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"start","original":{"line":22,"column":10},"generated":{"line":2,"column":1568}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"start","original":{"line":22,"column":10},"generated":{"line":2,"column":1574}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"Date","original":{"line":22,"column":18},"generated":{"line":2,"column":1576}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"now","original":{"line":22,"column":23},"generated":{"line":2,"column":1581}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"log","original":{"line":23,"column":4},"generated":{"line":2,"column":1587}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":23,"column":8},"generated":{"line":2,"column":1589}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"release","original":{"line":25,"column":10},"generated":{"line":2,"column":1622}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"release","original":{"line":25,"column":10},"generated":{"line":2,"column":1628}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"self","original":{"line":25,"column":26},"generated":{"line":2,"column":1636}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"_gcLock","original":{"line":25,"column":31},"generated":{"line":2,"column":1638}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"writeLock","original":{"line":25,"column":39},"generated":{"line":2,"column":1646}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":27,"column":8},"generated":{"line":2,"column":1658}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":28,"column":12},"generated":{"line":2,"column":1662}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"blockKeys","original":{"line":29,"column":8},"generated":{"line":2,"column":1668}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"markedSet","original":{"line":29,"column":19},"generated":{"line":2,"column":1670}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"Promise","original":{"line":30,"column":16},"generated":{"line":2,"column":1679}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"all","original":{"line":30,"column":24},"generated":{"line":2,"column":1687}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":30,"column":28},"generated":{"line":2,"column":1691}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"self","original":{"line":32,"column":8},"generated":{"line":2,"column":1692}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"_repo","original":{"line":32,"column":13},"generated":{"line":2,"column":1694}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"blocks","original":{"line":32,"column":19},"generated":{"line":2,"column":1700}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"query","original":{"line":32,"column":26},"generated":{"line":2,"column":1707}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":32,"column":32},"generated":{"line":2,"column":1713}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"keysOnly","original":{"line":32,"column":34},"generated":{"line":2,"column":1714}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":32,"column":44},"generated":{"line":2,"column":1724}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"createMarkedSet","original":{"line":35,"column":8},"generated":{"line":2,"column":1728}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"self","original":{"line":35,"column":24},"generated":{"line":2,"column":1730}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"res","original":{"line":39,"column":12},"generated":{"line":2,"column":1735}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"deleteUnmarkedBlocks","original":{"line":39,"column":24},"generated":{"line":2,"column":1743}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"self","original":{"line":39,"column":45},"generated":{"line":2,"column":1745}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"markedSet","original":{"line":39,"column":51},"generated":{"line":2,"column":1747}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"blockKeys","original":{"line":39,"column":62},"generated":{"line":2,"column":1749}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"res","original":{"line":43,"column":13},"generated":{"line":2,"column":1752}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"log","original":{"line":41,"column":6},"generated":{"line":2,"column":1759}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"Date","original":{"line":41,"column":23},"generated":{"line":2,"column":1774}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"now","original":{"line":41,"column":28},"generated":{"line":2,"column":1779}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"start","original":{"line":41,"column":36},"generated":{"line":2,"column":1785}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"res","original":{"line":43,"column":13},"generated":{"line":2,"column":1793}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","original":{"line":44,"column":14},"generated":{"line":2,"column":1795}},{"source":"node_modules/ipfs/src/core/components/pin/gc.js","name":"release","original":{"line":45,"column":6},"generated":{"line":2,"column":1803}}],"sources":{"node_modules/ipfs/src/core/components/pin/gc.js":"'use strict'\n\nconst CID = require('cids')\nconst base32 = require('base32.js')\nconst callbackify = require('callbackify')\nconst { cidToString } = require('../../../utils/cid')\nconst log = require('debug')('ipfs:gc')\nconst { default: Queue } = require('p-queue')\n// TODO: Use exported key from root when upgraded to ipfs-mfs@>=13\n// https://github.com/ipfs/js-ipfs-mfs/pull/58\nconst { MFS_ROOT_KEY } = require('ipfs-mfs/src/core/utils/constants')\n\nconst { Errors } = require('interface-datastore')\nconst ERR_NOT_FOUND = Errors.notFoundError().code\n\n// Limit on the number of parallel block remove operations\nconst BLOCK_RM_CONCURRENCY = 256\n\n// Perform mark and sweep garbage collection\nmodule.exports = function gc (self) {\n  return callbackify(async () => {\n    const start = Date.now()\n    log('Creating set of marked blocks')\n\n    const release = await self._gcLock.writeLock()\n\n    try {\n      const [\n        blockKeys, markedSet\n      ] = await Promise.all([\n        // Get all blocks keys from the blockstore\n        self._repo.blocks.query({ keysOnly: true }),\n\n        // Mark all blocks that are being used\n        createMarkedSet(self)\n      ])\n\n      // Delete blocks that are not being used\n      const res = await deleteUnmarkedBlocks(self, markedSet, blockKeys)\n\n      log(`Complete (${Date.now() - start}ms)`)\n\n      return res\n    } finally {\n      release()\n    }\n  })\n}\n\n// Get Set of CIDs of blocks to keep\nasync function createMarkedSet (ipfs) {\n  const output = new Set()\n\n  const addPins = pins => {\n    log(`Found ${pins.length} pinned blocks`)\n\n    pins.forEach(pin => {\n      output.add(cidToString(new CID(pin), { base: 'base32' }))\n    })\n  }\n\n  await Promise.all([\n    // All pins, direct and indirect\n    ipfs.pin.ls()\n      .then(pins => pins.map(pin => pin.hash))\n      .then(addPins),\n\n    // Blocks used internally by the pinner\n    ipfs.pin.pinManager.getInternalBlocks()\n      .then(addPins),\n\n    // The MFS root and all its descendants\n    ipfs._repo.root.get(MFS_ROOT_KEY)\n      .then(mh => getDescendants(ipfs, new CID(mh)))\n      .then(addPins)\n      .catch(err => {\n        if (err.code === ERR_NOT_FOUND) {\n          log('No blocks in MFS')\n          return []\n        }\n\n        throw err\n      })\n  ])\n\n  return output\n}\n\n// Recursively get descendants of the given CID\nasync function getDescendants (ipfs, cid) {\n  const refs = await ipfs.refs(cid, { recursive: true })\n  const cids = [cid, ...refs.map(r => new CID(r.ref))]\n  log(`Found ${cids.length} MFS blocks`)\n  // log('  ' + cids.join('\\n  '))\n\n  return cids\n}\n\n// Delete all blocks that are not marked as in use\nasync function deleteUnmarkedBlocks (ipfs, markedSet, blockKeys) {\n  // Iterate through all blocks and find those that are not in the marked set\n  // The blockKeys variable has the form [ { key: Key() }, { key: Key() }, ... ]\n  const unreferenced = []\n  const result = []\n\n  const queue = new Queue({\n    concurrency: BLOCK_RM_CONCURRENCY\n  })\n\n  for await (const { key: k } of blockKeys) {\n    try {\n      const cid = dsKeyToCid(k)\n      const b32 = cid.toV1().toString('base32')\n      if (!markedSet.has(b32)) {\n        unreferenced.push(cid)\n\n        queue.add(async () => {\n          const res = {\n            cid\n          }\n\n          try {\n            await ipfs._repo.blocks.delete(cid)\n          } catch (err) {\n            res.err = new Error(`Could not delete block with CID ${cid}: ${err.message}`)\n          }\n\n          result.push(res)\n        })\n      }\n    } catch (err) {\n      const msg = `Could not convert block with key '${k}' to CID`\n      log(msg, err)\n      result.push({ err: new Error(msg + `: ${err.message}`) })\n    }\n  }\n\n  await queue.onIdle()\n\n  log(`Marked set has ${markedSet.size} unique blocks. Blockstore has ${blockKeys.length} blocks. ` +\n  `Deleted ${unreferenced.length} blocks.`)\n\n  return result\n}\n\n// TODO: Use exported utility when upgrade to ipfs-repo@>=0.27.1\n// https://github.com/ipfs/js-ipfs-repo/pull/206\nfunction dsKeyToCid (key) {\n  // Block key is of the form /<base32 encoded string>\n  const decoder = new base32.Decoder()\n  const buff = decoder.write(key.toString().slice(1)).finalize()\n  return new CID(Buffer.from(buff))\n}\n"},"lineCount":null}},"error":null,"hash":"761171b23847cc993724130d9ea80ecd","cacheData":{"env":{}}}