{"id":"NrSu","dependencies":[{"name":"/Users/polluterofminds/Development/simpleid/ssa-sdk/package.json","includedInParent":true,"mtime":1584306008866},{"name":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/package.json","includedInParent":true,"mtime":1582579778668},{"name":"ipns","loc":{"line":3,"column":21},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/src/core/ipns/republisher.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/ipns/src/index.js"},{"name":"libp2p-crypto","loc":{"line":4,"column":23},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/src/core/ipns/republisher.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-crypto/src/index.js"},{"name":"peer-id","loc":{"line":5,"column":23},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/src/core/ipns/republisher.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/peer-id/src/index.js"},{"name":"err-code","loc":{"line":6,"column":24},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/src/core/ipns/republisher.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/err-code/index.js"},{"name":"promisify-es6","loc":{"line":7,"column":26},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/src/core/ipns/republisher.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/promisify-es6/index.js"},{"name":"debug","loc":{"line":9,"column":22},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/src/core/ipns/republisher.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/debug/src/browser.js"},{"name":"buffer","parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/src/core/ipns/republisher.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/node-libs-browser/node_modules/buffer/index.js"}],"generated":{"js":"var Buffer = require(\"buffer\").Buffer;\nvar r=require(\"buffer\").Buffer;const e=require(\"ipns\"),t=require(\"libp2p-crypto\"),i=require(\"peer-id\"),s=require(\"err-code\"),n=require(\"promisify-es6\"),a=require(\"debug\"),o=a(\"ipfs:ipns:republisher\");o.error=a(\"ipfs:ipns:republisher:error\");const h=6e4,l=60*h,u=4*l,_=24*l;class c{constructor(r,e,t,i,s){this._publisher=r,this._datastore=e,this._peerInfo=t,this._keychain=i,this._options=s,this._republishHandle=null}start(){if(this._republishHandle)throw s(new Error(\"republisher is already running\"),\"ERR_REPUBLISH_ALREADY_RUNNING\");const r={_task:null,_inflightTask:null,_timeoutId:null,runPeriodically:e=>{r._timeoutId=setTimeout(async()=>{r._timeoutId=null;try{r._inflightTask=r._task(),await r._inflightTask,r._task&&r.runPeriodically(e)}catch(t){o.error(t)}},e())},cancel:async()=>{clearTimeout(r._timeoutId),r._task=null,await r._inflightTask}},{privKey:e}=this._peerInfo.id,{pass:t}=this._options;let i=!0;r._task=(async()=>(await this._republishEntries(e,t),u)),r.runPeriodically(()=>i?(i=!1,h):u),this._republishHandle=r}async stop(){const r=this._republishHandle;if(!r)throw s(new Error(\"republisher is not running\"),\"ERR_REPUBLISH_NOT_RUNNING\");this._republishHandle=null,await r.cancel()}async _republishEntries(r,e){try{await this._republishEntry(r)}catch(i){const r=\"cannot republish entry for the node's private key\";return void o.error(r)}if(e)try{const r=await this._keychain.listKeys();for(const i in r){const r=await this._keychain.exportKey(i.name,e),s=await t.keys.import(r,e);await this._republishEntry(s)}}catch(i){o.error(i)}}async _republishEntry(r){if(!r||!r.bytes)throw s(new Error(\"invalid private key\"),\"ERR_INVALID_PRIVATE_KEY\");try{const t=await n(i.createFromPrivKey)(r.bytes),s=await this._getPreviousValue(t);await this._publisher.publishWithEOL(r,s,_)}catch(e){if(\"ERR_NO_ENTRY_FOUND\"===e.code)return;throw e}}async _getPreviousValue(t){if(!i.isPeerId(t))throw s(new Error(\"invalid peer ID\"),\"ERR_INVALID_PEER_ID\");try{const i=await this._datastore.get(e.getLocalKey(t.id));if(!r.isBuffer(i))throw s(new Error(\"found ipns record that we couldn't process\"),\"ERR_INVALID_IPNS_RECORD\");try{return e.unmarshal(i).value}catch(n){throw o.error(n),s(new Error(\"found ipns record that we couldn't convert to a value\"),\"ERR_INVALID_IPNS_RECORD\")}}catch(n){if(n&&n.notFound)throw s(new Error(`no previous entry for record with id: ${t.id}`),\"ERR_NO_ENTRY_FOUND\");throw n}}}exports=module.exports=c;"},"sourceMaps":{"js":{"mappings":[{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":180,"column":0},"generated":{"line":2,"column":0}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":180,"column":0},"generated":{"line":2,"column":4}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":180,"column":0},"generated":{"line":2,"column":6}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":180,"column":0},"generated":{"line":2,"column":14}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":180,"column":0},"generated":{"line":2,"column":24}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":3,"column":0},"generated":{"line":2,"column":31}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"ipns","original":{"line":3,"column":6},"generated":{"line":2,"column":37}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"require","original":{"line":3,"column":13},"generated":{"line":2,"column":39}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":3,"column":21},"generated":{"line":2,"column":47}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"crypto","original":{"line":4,"column":6},"generated":{"line":2,"column":55}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"require","original":{"line":4,"column":15},"generated":{"line":2,"column":57}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":4,"column":23},"generated":{"line":2,"column":65}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"PeerId","original":{"line":5,"column":6},"generated":{"line":2,"column":82}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"require","original":{"line":5,"column":15},"generated":{"line":2,"column":84}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":5,"column":23},"generated":{"line":2,"column":92}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"errcode","original":{"line":6,"column":6},"generated":{"line":2,"column":103}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"require","original":{"line":6,"column":16},"generated":{"line":2,"column":105}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":6,"column":24},"generated":{"line":2,"column":113}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"promisify","original":{"line":7,"column":6},"generated":{"line":2,"column":125}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"require","original":{"line":7,"column":18},"generated":{"line":2,"column":127}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":7,"column":26},"generated":{"line":2,"column":135}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"debug","original":{"line":9,"column":6},"generated":{"line":2,"column":152}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"require","original":{"line":9,"column":14},"generated":{"line":2,"column":154}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":9,"column":22},"generated":{"line":2,"column":162}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"log","original":{"line":10,"column":6},"generated":{"line":2,"column":171}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"debug","original":{"line":10,"column":12},"generated":{"line":2,"column":173}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":10,"column":18},"generated":{"line":2,"column":175}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"log","original":{"line":11,"column":0},"generated":{"line":2,"column":200}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"error","original":{"line":11,"column":4},"generated":{"line":2,"column":202}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"debug","original":{"line":11,"column":12},"generated":{"line":2,"column":208}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":11,"column":18},"generated":{"line":2,"column":210}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":13,"column":0},"generated":{"line":2,"column":241}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"minute","original":{"line":13,"column":6},"generated":{"line":2,"column":247}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":13,"column":15},"generated":{"line":2,"column":249}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"hour","original":{"line":14,"column":6},"generated":{"line":2,"column":253}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":14,"column":13},"generated":{"line":2,"column":255}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"minute","original":{"line":14,"column":18},"generated":{"line":2,"column":258}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"defaultBroadcastInterval","original":{"line":16,"column":6},"generated":{"line":2,"column":260}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":16,"column":33},"generated":{"line":2,"column":262}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"hour","original":{"line":16,"column":37},"generated":{"line":2,"column":264}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"defaultRecordLifetime","original":{"line":17,"column":6},"generated":{"line":2,"column":266}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":17,"column":30},"generated":{"line":2,"column":268}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"hour","original":{"line":17,"column":35},"generated":{"line":2,"column":271}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":19,"column":0},"generated":{"line":2,"column":273}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"IpnsRepublisher","original":{"line":19,"column":6},"generated":{"line":2,"column":279}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"constructor","original":{"line":20,"column":2},"generated":{"line":2,"column":281}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"publisher","original":{"line":20,"column":15},"generated":{"line":2,"column":293}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"datastore","original":{"line":20,"column":26},"generated":{"line":2,"column":295}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"peerInfo","original":{"line":20,"column":37},"generated":{"line":2,"column":297}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"keychain","original":{"line":20,"column":47},"generated":{"line":2,"column":299}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"options","original":{"line":20,"column":57},"generated":{"line":2,"column":301}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_publisher","original":{"line":21,"column":9},"generated":{"line":2,"column":304}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_publisher","original":{"line":21,"column":9},"generated":{"line":2,"column":309}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"publisher","original":{"line":21,"column":22},"generated":{"line":2,"column":320}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_datastore","original":{"line":22,"column":9},"generated":{"line":2,"column":322}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_datastore","original":{"line":22,"column":9},"generated":{"line":2,"column":327}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"datastore","original":{"line":22,"column":22},"generated":{"line":2,"column":338}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_peerInfo","original":{"line":23,"column":9},"generated":{"line":2,"column":340}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_peerInfo","original":{"line":23,"column":9},"generated":{"line":2,"column":345}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"peerInfo","original":{"line":23,"column":21},"generated":{"line":2,"column":355}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_keychain","original":{"line":24,"column":9},"generated":{"line":2,"column":357}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_keychain","original":{"line":24,"column":9},"generated":{"line":2,"column":362}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"keychain","original":{"line":24,"column":21},"generated":{"line":2,"column":372}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_options","original":{"line":25,"column":9},"generated":{"line":2,"column":374}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_options","original":{"line":25,"column":9},"generated":{"line":2,"column":379}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"options","original":{"line":25,"column":20},"generated":{"line":2,"column":388}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_republishHandle","original":{"line":26,"column":9},"generated":{"line":2,"column":390}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_republishHandle","original":{"line":26,"column":9},"generated":{"line":2,"column":395}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":26,"column":28},"generated":{"line":2,"column":412}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"start","original":{"line":29,"column":2},"generated":{"line":2,"column":417}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":30,"column":8},"generated":{"line":2,"column":425}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":30,"column":8},"generated":{"line":2,"column":428}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_republishHandle","original":{"line":30,"column":13},"generated":{"line":2,"column":433}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"errcode","original":{"line":31,"column":12},"generated":{"line":2,"column":450}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"errcode","original":{"line":31,"column":12},"generated":{"line":2,"column":456}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":31,"column":20},"generated":{"line":2,"column":458}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"Error","original":{"line":31,"column":24},"generated":{"line":2,"column":462}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":31,"column":30},"generated":{"line":2,"column":468}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":31,"column":65},"generated":{"line":2,"column":502}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"republishHandle","original":{"line":35,"column":10},"generated":{"line":2,"column":535}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"republishHandle","original":{"line":35,"column":10},"generated":{"line":2,"column":541}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":35,"column":28},"generated":{"line":2,"column":543}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_task","original":{"line":36,"column":6},"generated":{"line":2,"column":544}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":36,"column":13},"generated":{"line":2,"column":550}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_inflightTask","original":{"line":37,"column":6},"generated":{"line":2,"column":555}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":37,"column":21},"generated":{"line":2,"column":569}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_timeoutId","original":{"line":38,"column":6},"generated":{"line":2,"column":574}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":38,"column":18},"generated":{"line":2,"column":585}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"runPeriodically","original":{"line":39,"column":6},"generated":{"line":2,"column":590}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"period","original":{"line":39,"column":24},"generated":{"line":2,"column":606}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"republishHandle","original":{"line":40,"column":8},"generated":{"line":2,"column":610}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_timeoutId","original":{"line":40,"column":24},"generated":{"line":2,"column":612}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"setTimeout","original":{"line":40,"column":37},"generated":{"line":2,"column":623}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":40,"column":48},"generated":{"line":2,"column":634}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"republishHandle","original":{"line":41,"column":10},"generated":{"line":2,"column":644}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_timeoutId","original":{"line":41,"column":26},"generated":{"line":2,"column":646}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":41,"column":39},"generated":{"line":2,"column":657}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":43,"column":14},"generated":{"line":2,"column":662}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"republishHandle","original":{"line":44,"column":12},"generated":{"line":2,"column":666}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_inflightTask","original":{"line":44,"column":28},"generated":{"line":2,"column":668}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"republishHandle","original":{"line":44,"column":44},"generated":{"line":2,"column":682}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_task","original":{"line":44,"column":60},"generated":{"line":2,"column":684}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"republishHandle","original":{"line":45,"column":18},"generated":{"line":2,"column":698}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_inflightTask","original":{"line":45,"column":34},"generated":{"line":2,"column":700}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"republishHandle","original":{"line":48,"column":16},"generated":{"line":2,"column":714}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_task","original":{"line":48,"column":32},"generated":{"line":2,"column":716}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"republishHandle","original":{"line":49,"column":14},"generated":{"line":2,"column":723}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"runPeriodically","original":{"line":49,"column":30},"generated":{"line":2,"column":725}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"period","original":{"line":49,"column":46},"generated":{"line":2,"column":741}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":51,"column":12},"generated":{"line":2,"column":744}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"err","original":{"line":51,"column":19},"generated":{"line":2,"column":750}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"log","original":{"line":52,"column":12},"generated":{"line":2,"column":753}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"error","original":{"line":52,"column":16},"generated":{"line":2,"column":755}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"err","original":{"line":52,"column":22},"generated":{"line":2,"column":761}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"period","original":{"line":54,"column":11},"generated":{"line":2,"column":766}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"cancel","original":{"line":56,"column":6},"generated":{"line":2,"column":772}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":56,"column":14},"generated":{"line":2,"column":779}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"clearTimeout","original":{"line":58,"column":8},"generated":{"line":2,"column":789}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"republishHandle","original":{"line":58,"column":21},"generated":{"line":2,"column":802}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_timeoutId","original":{"line":58,"column":37},"generated":{"line":2,"column":804}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"republishHandle","original":{"line":59,"column":8},"generated":{"line":2,"column":816}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_task","original":{"line":59,"column":24},"generated":{"line":2,"column":818}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":59,"column":32},"generated":{"line":2,"column":824}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"republishHandle","original":{"line":62,"column":14},"generated":{"line":2,"column":835}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_inflightTask","original":{"line":62,"column":30},"generated":{"line":2,"column":837}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":66,"column":10},"generated":{"line":2,"column":854}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"privKey","original":{"line":66,"column":12},"generated":{"line":2,"column":862}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":66,"column":24},"generated":{"line":2,"column":865}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_peerInfo","original":{"line":66,"column":29},"generated":{"line":2,"column":870}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"id","original":{"line":66,"column":39},"generated":{"line":2,"column":880}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":67,"column":10},"generated":{"line":2,"column":884}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"pass","original":{"line":67,"column":12},"generated":{"line":2,"column":889}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":67,"column":21},"generated":{"line":2,"column":892}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_options","original":{"line":67,"column":26},"generated":{"line":2,"column":897}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"firstRun","original":{"line":68,"column":8},"generated":{"line":2,"column":906}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"firstRun","original":{"line":68,"column":8},"generated":{"line":2,"column":910}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":68,"column":19},"generated":{"line":2,"column":913}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"republishHandle","original":{"line":70,"column":4},"generated":{"line":2,"column":915}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_task","original":{"line":70,"column":20},"generated":{"line":2,"column":917}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":70,"column":28},"generated":{"line":2,"column":923}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":71,"column":12},"generated":{"line":2,"column":940}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_republishEntries","original":{"line":71,"column":17},"generated":{"line":2,"column":945}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"privKey","original":{"line":71,"column":35},"generated":{"line":2,"column":963}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"pass","original":{"line":71,"column":44},"generated":{"line":2,"column":965}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"defaultBroadcastInterval","original":{"line":73,"column":13},"generated":{"line":2,"column":968}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"republishHandle","original":{"line":75,"column":4},"generated":{"line":2,"column":972}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"runPeriodically","original":{"line":75,"column":20},"generated":{"line":2,"column":974}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":75,"column":36},"generated":{"line":2,"column":990}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"firstRun","original":{"line":76,"column":10},"generated":{"line":2,"column":994}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"firstRun","original":{"line":77,"column":8},"generated":{"line":2,"column":997}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":77,"column":19},"generated":{"line":2,"column":1000}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"minute","original":{"line":79,"column":15},"generated":{"line":2,"column":1002}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"defaultBroadcastInterval","original":{"line":82,"column":13},"generated":{"line":2,"column":1005}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_republishHandle","original":{"line":85,"column":9},"generated":{"line":2,"column":1008}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_republishHandle","original":{"line":85,"column":9},"generated":{"line":2,"column":1013}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"republishHandle","original":{"line":85,"column":28},"generated":{"line":2,"column":1030}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"stop","original":{"line":88,"column":8},"generated":{"line":2,"column":1032}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"republishHandle","original":{"line":89,"column":10},"generated":{"line":2,"column":1045}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"republishHandle","original":{"line":89,"column":10},"generated":{"line":2,"column":1051}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":89,"column":28},"generated":{"line":2,"column":1053}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_republishHandle","original":{"line":89,"column":33},"generated":{"line":2,"column":1058}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":91,"column":8},"generated":{"line":2,"column":1075}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"republishHandle","original":{"line":91,"column":9},"generated":{"line":2,"column":1079}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"errcode","original":{"line":92,"column":12},"generated":{"line":2,"column":1081}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"errcode","original":{"line":92,"column":12},"generated":{"line":2,"column":1087}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":92,"column":20},"generated":{"line":2,"column":1089}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"Error","original":{"line":92,"column":24},"generated":{"line":2,"column":1093}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":92,"column":30},"generated":{"line":2,"column":1099}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":92,"column":61},"generated":{"line":2,"column":1129}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_republishHandle","original":{"line":95,"column":9},"generated":{"line":2,"column":1158}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_republishHandle","original":{"line":95,"column":9},"generated":{"line":2,"column":1163}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":95,"column":28},"generated":{"line":2,"column":1180}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"republishHandle","original":{"line":97,"column":10},"generated":{"line":2,"column":1191}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"cancel","original":{"line":97,"column":26},"generated":{"line":2,"column":1193}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_republishEntries","original":{"line":100,"column":8},"generated":{"line":2,"column":1202}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"privateKey","original":{"line":100,"column":27},"generated":{"line":2,"column":1226}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"pass","original":{"line":100,"column":39},"generated":{"line":2,"column":1228}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":103,"column":8},"generated":{"line":2,"column":1231}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":104,"column":12},"generated":{"line":2,"column":1241}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_republishEntry","original":{"line":104,"column":17},"generated":{"line":2,"column":1246}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"privateKey","original":{"line":104,"column":33},"generated":{"line":2,"column":1262}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":105,"column":6},"generated":{"line":2,"column":1265}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"err","original":{"line":105,"column":13},"generated":{"line":2,"column":1271}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"errMsg","original":{"line":106,"column":12},"generated":{"line":2,"column":1274}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"errMsg","original":{"line":106,"column":12},"generated":{"line":2,"column":1280}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":106,"column":21},"generated":{"line":2,"column":1282}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":109,"column":6},"generated":{"line":2,"column":1334}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"log","original":{"line":108,"column":6},"generated":{"line":2,"column":1346}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"error","original":{"line":108,"column":10},"generated":{"line":2,"column":1348}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"errMsg","original":{"line":108,"column":16},"generated":{"line":2,"column":1354}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"pass","original":{"line":113,"column":8},"generated":{"line":2,"column":1357}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"pass","original":{"line":113,"column":8},"generated":{"line":2,"column":1360}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":114,"column":10},"generated":{"line":2,"column":1362}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"keys","original":{"line":115,"column":14},"generated":{"line":2,"column":1366}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"keys","original":{"line":115,"column":14},"generated":{"line":2,"column":1372}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":115,"column":27},"generated":{"line":2,"column":1380}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_keychain","original":{"line":115,"column":32},"generated":{"line":2,"column":1385}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"listKeys","original":{"line":115,"column":42},"generated":{"line":2,"column":1395}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":117,"column":13},"generated":{"line":2,"column":1406}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":117,"column":13},"generated":{"line":2,"column":1410}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"key","original":{"line":117,"column":19},"generated":{"line":2,"column":1416}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"keys","original":{"line":117,"column":26},"generated":{"line":2,"column":1421}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":117,"column":32},"generated":{"line":2,"column":1423}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"pem","original":{"line":118,"column":16},"generated":{"line":2,"column":1424}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"pem","original":{"line":118,"column":16},"generated":{"line":2,"column":1430}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":118,"column":28},"generated":{"line":2,"column":1438}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_keychain","original":{"line":118,"column":33},"generated":{"line":2,"column":1443}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"exportKey","original":{"line":118,"column":43},"generated":{"line":2,"column":1453}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"key","original":{"line":118,"column":53},"generated":{"line":2,"column":1463}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"name","original":{"line":118,"column":57},"generated":{"line":2,"column":1465}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"pass","original":{"line":118,"column":63},"generated":{"line":2,"column":1470}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"privKey","original":{"line":119,"column":16},"generated":{"line":2,"column":1473}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"crypto","original":{"line":119,"column":32},"generated":{"line":2,"column":1481}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"keys","original":{"line":119,"column":39},"generated":{"line":2,"column":1483}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"import","original":{"line":119,"column":44},"generated":{"line":2,"column":1488}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"pem","original":{"line":119,"column":51},"generated":{"line":2,"column":1495}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"pass","original":{"line":119,"column":56},"generated":{"line":2,"column":1497}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":121,"column":16},"generated":{"line":2,"column":1506}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_republishEntry","original":{"line":121,"column":21},"generated":{"line":2,"column":1511}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"privKey","original":{"line":121,"column":37},"generated":{"line":2,"column":1527}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":123,"column":8},"generated":{"line":2,"column":1531}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"err","original":{"line":123,"column":15},"generated":{"line":2,"column":1537}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"log","original":{"line":124,"column":8},"generated":{"line":2,"column":1540}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"error","original":{"line":124,"column":12},"generated":{"line":2,"column":1542}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"err","original":{"line":124,"column":18},"generated":{"line":2,"column":1548}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_republishEntry","original":{"line":129,"column":8},"generated":{"line":2,"column":1552}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"privateKey","original":{"line":129,"column":25},"generated":{"line":2,"column":1574}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":130,"column":8},"generated":{"line":2,"column":1577}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"privateKey","original":{"line":130,"column":9},"generated":{"line":2,"column":1581}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"privateKey","original":{"line":130,"column":24},"generated":{"line":2,"column":1585}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"bytes","original":{"line":130,"column":35},"generated":{"line":2,"column":1587}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"errcode","original":{"line":131,"column":12},"generated":{"line":2,"column":1593}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"errcode","original":{"line":131,"column":12},"generated":{"line":2,"column":1599}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":131,"column":20},"generated":{"line":2,"column":1601}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"Error","original":{"line":131,"column":24},"generated":{"line":2,"column":1605}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":131,"column":30},"generated":{"line":2,"column":1611}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":131,"column":54},"generated":{"line":2,"column":1634}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":134,"column":8},"generated":{"line":2,"column":1661}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"peerId","original":{"line":135,"column":12},"generated":{"line":2,"column":1665}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"peerId","original":{"line":135,"column":12},"generated":{"line":2,"column":1671}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"promisify","original":{"line":135,"column":27},"generated":{"line":2,"column":1679}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"PeerId","original":{"line":135,"column":37},"generated":{"line":2,"column":1681}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"createFromPrivKey","original":{"line":135,"column":44},"generated":{"line":2,"column":1683}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"promisify","original":{"line":135,"column":27},"generated":{"line":2,"column":1701}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"privateKey","original":{"line":135,"column":63},"generated":{"line":2,"column":1702}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"bytes","original":{"line":135,"column":74},"generated":{"line":2,"column":1704}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"value","original":{"line":136,"column":12},"generated":{"line":2,"column":1711}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":136,"column":26},"generated":{"line":2,"column":1719}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_getPreviousValue","original":{"line":136,"column":31},"generated":{"line":2,"column":1724}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"peerId","original":{"line":136,"column":49},"generated":{"line":2,"column":1742}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":137,"column":12},"generated":{"line":2,"column":1751}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_publisher","original":{"line":137,"column":17},"generated":{"line":2,"column":1756}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"publishWithEOL","original":{"line":137,"column":28},"generated":{"line":2,"column":1767}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"privateKey","original":{"line":137,"column":43},"generated":{"line":2,"column":1782}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"value","original":{"line":137,"column":55},"generated":{"line":2,"column":1784}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"defaultRecordLifetime","original":{"line":137,"column":62},"generated":{"line":2,"column":1786}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":138,"column":6},"generated":{"line":2,"column":1789}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"err","original":{"line":138,"column":13},"generated":{"line":2,"column":1795}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"err","original":{"line":139,"column":10},"generated":{"line":2,"column":1798}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":139,"column":23},"generated":{"line":2,"column":1801}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"err","original":{"line":139,"column":10},"generated":{"line":2,"column":1824}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"code","original":{"line":139,"column":14},"generated":{"line":2,"column":1826}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":140,"column":8},"generated":{"line":2,"column":1831}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"err","original":{"line":143,"column":12},"generated":{"line":2,"column":1838}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"err","original":{"line":143,"column":12},"generated":{"line":2,"column":1844}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_getPreviousValue","original":{"line":147,"column":8},"generated":{"line":2,"column":1847}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"peerId","original":{"line":147,"column":27},"generated":{"line":2,"column":1871}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":148,"column":8},"generated":{"line":2,"column":1874}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"PeerId","original":{"line":148,"column":10},"generated":{"line":2,"column":1878}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"isPeerId","original":{"line":148,"column":17},"generated":{"line":2,"column":1880}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"peerId","original":{"line":148,"column":26},"generated":{"line":2,"column":1889}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"errcode","original":{"line":149,"column":12},"generated":{"line":2,"column":1892}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"errcode","original":{"line":149,"column":12},"generated":{"line":2,"column":1898}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":149,"column":20},"generated":{"line":2,"column":1900}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"Error","original":{"line":149,"column":24},"generated":{"line":2,"column":1904}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":149,"column":30},"generated":{"line":2,"column":1910}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":149,"column":50},"generated":{"line":2,"column":1929}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":152,"column":8},"generated":{"line":2,"column":1952}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"dsVal","original":{"line":153,"column":12},"generated":{"line":2,"column":1956}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"dsVal","original":{"line":153,"column":12},"generated":{"line":2,"column":1962}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":153,"column":26},"generated":{"line":2,"column":1970}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"_datastore","original":{"line":153,"column":31},"generated":{"line":2,"column":1975}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"get","original":{"line":153,"column":42},"generated":{"line":2,"column":1986}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"ipns","original":{"line":153,"column":46},"generated":{"line":2,"column":1990}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"getLocalKey","original":{"line":153,"column":51},"generated":{"line":2,"column":1992}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"peerId","original":{"line":153,"column":63},"generated":{"line":2,"column":2004}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"id","original":{"line":153,"column":70},"generated":{"line":2,"column":2006}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":155,"column":10},"generated":{"line":2,"column":2011}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"Buffer","original":{"line":155,"column":11},"generated":{"line":2,"column":2015}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"isBuffer","original":{"line":155,"column":18},"generated":{"line":2,"column":2017}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"dsVal","original":{"line":155,"column":27},"generated":{"line":2,"column":2026}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"errcode","original":{"line":156,"column":14},"generated":{"line":2,"column":2029}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"errcode","original":{"line":156,"column":14},"generated":{"line":2,"column":2035}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":156,"column":22},"generated":{"line":2,"column":2037}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"Error","original":{"line":156,"column":26},"generated":{"line":2,"column":2041}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":156,"column":32},"generated":{"line":2,"column":2047}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":156,"column":79},"generated":{"line":2,"column":2093}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":160,"column":10},"generated":{"line":2,"column":2120}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"record","original":{"line":163,"column":15},"generated":{"line":2,"column":2124}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"ipns","original":{"line":161,"column":23},"generated":{"line":2,"column":2131}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"unmarshal","original":{"line":161,"column":28},"generated":{"line":2,"column":2133}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"dsVal","original":{"line":161,"column":38},"generated":{"line":2,"column":2143}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"value","original":{"line":163,"column":22},"generated":{"line":2,"column":2146}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":164,"column":8},"generated":{"line":2,"column":2152}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"err","original":{"line":164,"column":15},"generated":{"line":2,"column":2158}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"errcode","original":{"line":166,"column":14},"generated":{"line":2,"column":2161}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"log","original":{"line":165,"column":8},"generated":{"line":2,"column":2167}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"error","original":{"line":165,"column":12},"generated":{"line":2,"column":2169}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"err","original":{"line":165,"column":18},"generated":{"line":2,"column":2175}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"errcode","original":{"line":166,"column":14},"generated":{"line":2,"column":2178}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":166,"column":22},"generated":{"line":2,"column":2180}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"Error","original":{"line":166,"column":26},"generated":{"line":2,"column":2184}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":166,"column":32},"generated":{"line":2,"column":2190}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":166,"column":91},"generated":{"line":2,"column":2247}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":168,"column":6},"generated":{"line":2,"column":2275}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"err","original":{"line":168,"column":13},"generated":{"line":2,"column":2281}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"err","original":{"line":171,"column":10},"generated":{"line":2,"column":2284}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"err","original":{"line":171,"column":10},"generated":{"line":2,"column":2287}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"err","original":{"line":171,"column":17},"generated":{"line":2,"column":2290}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"notFound","original":{"line":171,"column":21},"generated":{"line":2,"column":2292}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"errcode","original":{"line":172,"column":14},"generated":{"line":2,"column":2301}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"errcode","original":{"line":172,"column":14},"generated":{"line":2,"column":2307}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":172,"column":22},"generated":{"line":2,"column":2309}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"Error","original":{"line":172,"column":26},"generated":{"line":2,"column":2313}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"peerId","original":{"line":172,"column":73},"generated":{"line":2,"column":2360}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"id","original":{"line":172,"column":80},"generated":{"line":2,"column":2362}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","original":{"line":172,"column":87},"generated":{"line":2,"column":2368}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"err","original":{"line":175,"column":12},"generated":{"line":2,"column":2390}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"err","original":{"line":175,"column":12},"generated":{"line":2,"column":2396}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"exports","original":{"line":180,"column":0},"generated":{"line":2,"column":2400}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"module","original":{"line":180,"column":10},"generated":{"line":2,"column":2408}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"exports","original":{"line":180,"column":17},"generated":{"line":2,"column":2415}},{"source":"node_modules/ipfs/src/core/ipns/republisher.js","name":"IpnsRepublisher","original":{"line":180,"column":27},"generated":{"line":2,"column":2423}}],"sources":{"node_modules/ipfs/src/core/ipns/republisher.js":"'use strict'\n\nconst ipns = require('ipns')\nconst crypto = require('libp2p-crypto')\nconst PeerId = require('peer-id')\nconst errcode = require('err-code')\nconst promisify = require('promisify-es6')\n\nconst debug = require('debug')\nconst log = debug('ipfs:ipns:republisher')\nlog.error = debug('ipfs:ipns:republisher:error')\n\nconst minute = 60 * 1000\nconst hour = 60 * minute\n\nconst defaultBroadcastInterval = 4 * hour\nconst defaultRecordLifetime = 24 * hour\n\nclass IpnsRepublisher {\n  constructor (publisher, datastore, peerInfo, keychain, options) {\n    this._publisher = publisher\n    this._datastore = datastore\n    this._peerInfo = peerInfo\n    this._keychain = keychain\n    this._options = options\n    this._republishHandle = null\n  }\n\n  start () {\n    if (this._republishHandle) {\n      throw errcode(new Error('republisher is already running'), 'ERR_REPUBLISH_ALREADY_RUNNING')\n    }\n\n    // TODO: this handler should be isolated in another module\n    const republishHandle = {\n      _task: null,\n      _inflightTask: null,\n      _timeoutId: null,\n      runPeriodically: (period) => {\n        republishHandle._timeoutId = setTimeout(async () => {\n          republishHandle._timeoutId = null\n\n          try {\n            republishHandle._inflightTask = republishHandle._task()\n            await republishHandle._inflightTask\n\n            // Schedule next\n            if (republishHandle._task) {\n              republishHandle.runPeriodically(period)\n            }\n          } catch (err) {\n            log.error(err)\n          }\n        }, period())\n      },\n      cancel: async () => {\n        // do not run again\n        clearTimeout(republishHandle._timeoutId)\n        republishHandle._task = null\n\n        // wait for the currently in flight task to complete\n        await republishHandle._inflightTask\n      }\n    }\n\n    const { privKey } = this._peerInfo.id\n    const { pass } = this._options\n    let firstRun = true\n\n    republishHandle._task = async () => {\n      await this._republishEntries(privKey, pass)\n\n      return defaultBroadcastInterval\n    }\n    republishHandle.runPeriodically(() => {\n      if (firstRun) {\n        firstRun = false\n\n        return minute\n      }\n\n      return defaultBroadcastInterval\n    })\n\n    this._republishHandle = republishHandle\n  }\n\n  async stop () {\n    const republishHandle = this._republishHandle\n\n    if (!republishHandle) {\n      throw errcode(new Error('republisher is not running'), 'ERR_REPUBLISH_NOT_RUNNING')\n    }\n\n    this._republishHandle = null\n\n    await republishHandle.cancel()\n  }\n\n  async _republishEntries (privateKey, pass) {\n    // TODO: Should use list of published entries.\n    // We can't currently *do* that because go uses this method for now.\n    try {\n      await this._republishEntry(privateKey)\n    } catch (err) {\n      const errMsg = 'cannot republish entry for the node\\'s private key'\n\n      log.error(errMsg)\n      return\n    }\n\n    // keychain needs pass to get the cryptographic keys\n    if (pass) {\n      try {\n        const keys = await this._keychain.listKeys()\n\n        for (const key in keys) {\n          const pem = await this._keychain.exportKey(key.name, pass)\n          const privKey = await crypto.keys.import(pem, pass)\n\n          await this._republishEntry(privKey)\n        }\n      } catch (err) {\n        log.error(err)\n      }\n    }\n  }\n\n  async _republishEntry (privateKey) {\n    if (!privateKey || !privateKey.bytes) {\n      throw errcode(new Error('invalid private key'), 'ERR_INVALID_PRIVATE_KEY')\n    }\n\n    try {\n      const peerId = await promisify(PeerId.createFromPrivKey)(privateKey.bytes)\n      const value = await this._getPreviousValue(peerId)\n      await this._publisher.publishWithEOL(privateKey, value, defaultRecordLifetime)\n    } catch (err) {\n      if (err.code === 'ERR_NO_ENTRY_FOUND') {\n        return\n      }\n\n      throw err\n    }\n  }\n\n  async _getPreviousValue (peerId) {\n    if (!(PeerId.isPeerId(peerId))) {\n      throw errcode(new Error('invalid peer ID'), 'ERR_INVALID_PEER_ID')\n    }\n\n    try {\n      const dsVal = await this._datastore.get(ipns.getLocalKey(peerId.id))\n\n      if (!Buffer.isBuffer(dsVal)) {\n        throw errcode(new Error(\"found ipns record that we couldn't process\"), 'ERR_INVALID_IPNS_RECORD')\n      }\n\n      // unmarshal data\n      try {\n        const record = ipns.unmarshal(dsVal)\n\n        return record.value\n      } catch (err) {\n        log.error(err)\n        throw errcode(new Error('found ipns record that we couldn\\'t convert to a value'), 'ERR_INVALID_IPNS_RECORD')\n      }\n    } catch (err) {\n      // error handling\n      // no need to republish\n      if (err && err.notFound) {\n        throw errcode(new Error(`no previous entry for record with id: ${peerId.id}`), 'ERR_NO_ENTRY_FOUND')\n      }\n\n      throw err\n    }\n  }\n}\n\nexports = module.exports = IpnsRepublisher\n"},"lineCount":null}},"error":null,"hash":"ec80bfcac413e37a76ae6a25d0435741","cacheData":{"env":{}}}