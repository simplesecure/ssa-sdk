{"id":"JpYB","dependencies":[{"name":"/Users/polluterofminds/Development/simpleid/ssa-sdk/package.json","includedInParent":true,"mtime":1584306008866},{"name":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p/package.json","includedInParent":true,"mtime":1582579780031},{"name":"debug","loc":{"line":3,"column":22},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/debug/src/browser.js"},{"name":"./incoming","loc":{"line":4,"column":35},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p/src/switch/connection/incoming.js"},{"name":"../observe-connection","loc":{"line":5,"column":28},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p/src/switch/observe-connection.js"}],"generated":{"js":"\"use strict\";const e=require(\"debug\"),n=require(\"./incoming\"),r=require(\"../observe-connection\");function o(o){const t=e(\"libp2p:switch:listener\");return function(e,c){return function(i){t(\"received incoming connection for transport %s\",e),i.getPeerInfo((s,u)=>{const p=e?r(e,null,i,o.observer):i,f=new n({connection:p,_switch:o,transportKey:e,peerInfo:u});f.once(\"error\",e=>t(e)),f.once(\"private\",e=>{if(c)return c(e);f.encrypt()}),f.once(\"encrypted\",()=>f.upgrade()),f.protect()})}}}module.exports=o;"},"sourceMaps":{"js":{"mappings":[{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","original":{"line":1,"column":0},"generated":{"line":1,"column":0}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","original":{"line":3,"column":0},"generated":{"line":1,"column":13}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"debug","original":{"line":3,"column":6},"generated":{"line":1,"column":19}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"require","original":{"line":3,"column":14},"generated":{"line":1,"column":21}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","original":{"line":3,"column":22},"generated":{"line":1,"column":29}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"IncomingConnection","original":{"line":4,"column":6},"generated":{"line":1,"column":38}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"require","original":{"line":4,"column":27},"generated":{"line":1,"column":40}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","original":{"line":4,"column":35},"generated":{"line":1,"column":48}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"observeConn","original":{"line":5,"column":6},"generated":{"line":1,"column":62}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"require","original":{"line":5,"column":20},"generated":{"line":1,"column":64}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","original":{"line":5,"column":28},"generated":{"line":1,"column":72}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","original":{"line":7,"column":0},"generated":{"line":1,"column":97}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"listener","original":{"line":7,"column":9},"generated":{"line":1,"column":106}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"_switch","original":{"line":7,"column":19},"generated":{"line":1,"column":108}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"log","original":{"line":8,"column":8},"generated":{"line":1,"column":111}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"log","original":{"line":8,"column":8},"generated":{"line":1,"column":117}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"debug","original":{"line":8,"column":14},"generated":{"line":1,"column":119}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","original":{"line":8,"column":20},"generated":{"line":1,"column":121}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","original":{"line":17,"column":9},"generated":{"line":1,"column":147}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","original":{"line":17,"column":9},"generated":{"line":1,"column":154}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"transportKey","original":{"line":17,"column":19},"generated":{"line":1,"column":163}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"handler","original":{"line":17,"column":33},"generated":{"line":1,"column":165}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","original":{"line":24,"column":11},"generated":{"line":1,"column":168}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","original":{"line":24,"column":11},"generated":{"line":1,"column":175}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"conn","original":{"line":24,"column":21},"generated":{"line":1,"column":184}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"log","original":{"line":25,"column":6},"generated":{"line":1,"column":187}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","original":{"line":25,"column":10},"generated":{"line":1,"column":189}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"transportKey","original":{"line":25,"column":59},"generated":{"line":1,"column":237}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"conn","original":{"line":26,"column":6},"generated":{"line":1,"column":240}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"getPeerInfo","original":{"line":26,"column":11},"generated":{"line":1,"column":242}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","original":{"line":26,"column":23},"generated":{"line":1,"column":254}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"_","original":{"line":26,"column":24},"generated":{"line":1,"column":255}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"peerInfo","original":{"line":26,"column":27},"generated":{"line":1,"column":257}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"connection","original":{"line":28,"column":14},"generated":{"line":1,"column":262}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"connection","original":{"line":28,"column":14},"generated":{"line":1,"column":268}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"transportKey","original":{"line":28,"column":27},"generated":{"line":1,"column":270}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"observeConn","original":{"line":28,"column":42},"generated":{"line":1,"column":272}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"transportKey","original":{"line":28,"column":54},"generated":{"line":1,"column":274}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","original":{"line":28,"column":68},"generated":{"line":1,"column":276}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"conn","original":{"line":28,"column":74},"generated":{"line":1,"column":281}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"_switch","original":{"line":28,"column":80},"generated":{"line":1,"column":283}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"observer","original":{"line":28,"column":88},"generated":{"line":1,"column":285}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"conn","original":{"line":28,"column":100},"generated":{"line":1,"column":295}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"connFSM","original":{"line":29,"column":14},"generated":{"line":1,"column":297}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","original":{"line":29,"column":24},"generated":{"line":1,"column":299}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"IncomingConnection","original":{"line":29,"column":28},"generated":{"line":1,"column":303}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","original":{"line":29,"column":47},"generated":{"line":1,"column":305}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"connection","original":{"line":29,"column":49},"generated":{"line":1,"column":306}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"connection","original":{"line":29,"column":49},"generated":{"line":1,"column":317}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"_switch","original":{"line":29,"column":61},"generated":{"line":1,"column":319}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"_switch","original":{"line":29,"column":61},"generated":{"line":1,"column":327}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"transportKey","original":{"line":29,"column":70},"generated":{"line":1,"column":329}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"transportKey","original":{"line":29,"column":70},"generated":{"line":1,"column":342}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"peerInfo","original":{"line":29,"column":84},"generated":{"line":1,"column":344}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"peerInfo","original":{"line":29,"column":84},"generated":{"line":1,"column":353}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"connFSM","original":{"line":31,"column":8},"generated":{"line":1,"column":357}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"once","original":{"line":31,"column":16},"generated":{"line":1,"column":359}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","original":{"line":31,"column":21},"generated":{"line":1,"column":364}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"err","original":{"line":31,"column":31},"generated":{"line":1,"column":372}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"log","original":{"line":31,"column":39},"generated":{"line":1,"column":375}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"err","original":{"line":31,"column":43},"generated":{"line":1,"column":377}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"connFSM","original":{"line":32,"column":8},"generated":{"line":1,"column":381}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"once","original":{"line":32,"column":16},"generated":{"line":1,"column":383}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","original":{"line":32,"column":21},"generated":{"line":1,"column":388}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"_conn","original":{"line":32,"column":33},"generated":{"line":1,"column":398}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"handler","original":{"line":34,"column":14},"generated":{"line":1,"column":402}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"handler","original":{"line":34,"column":14},"generated":{"line":1,"column":405}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"handler","original":{"line":35,"column":19},"generated":{"line":1,"column":407}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"handler","original":{"line":35,"column":19},"generated":{"line":1,"column":414}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"_conn","original":{"line":35,"column":27},"generated":{"line":1,"column":416}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"connFSM","original":{"line":37,"column":10},"generated":{"line":1,"column":419}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"encrypt","original":{"line":37,"column":18},"generated":{"line":1,"column":421}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"connFSM","original":{"line":39,"column":8},"generated":{"line":1,"column":433}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"once","original":{"line":39,"column":16},"generated":{"line":1,"column":435}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","original":{"line":39,"column":21},"generated":{"line":1,"column":440}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","original":{"line":39,"column":34},"generated":{"line":1,"column":452}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"connFSM","original":{"line":39,"column":40},"generated":{"line":1,"column":456}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"upgrade","original":{"line":39,"column":48},"generated":{"line":1,"column":458}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"connFSM","original":{"line":41,"column":8},"generated":{"line":1,"column":469}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"protect","original":{"line":41,"column":16},"generated":{"line":1,"column":471}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"module","original":{"line":47,"column":0},"generated":{"line":1,"column":485}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"exports","original":{"line":47,"column":7},"generated":{"line":1,"column":492}},{"source":"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js","name":"listener","original":{"line":47,"column":17},"generated":{"line":1,"column":500}}],"sources":{"node_modules/ipfs/node_modules/libp2p/src/switch/connection/handler.js":"'use strict'\n\nconst debug = require('debug')\nconst IncomingConnection = require('./incoming')\nconst observeConn = require('../observe-connection')\n\nfunction listener (_switch) {\n  const log = debug('libp2p:switch:listener')\n\n  /**\n   * Takes a transport key and returns a connection handler function\n   *\n   * @param {string} transportKey The key of the transport to handle connections for\n   * @param {function} handler A custom handler to use\n   * @returns {function(Connection)} A connection handler function\n   */\n  return function (transportKey, handler) {\n    /**\n     * Takes a base connection and manages listening behavior\n     *\n     * @param {Connection} conn The connection to manage\n     * @returns {void}\n     */\n    return function (conn) {\n      log('received incoming connection for transport %s', transportKey)\n      conn.getPeerInfo((_, peerInfo) => {\n        // Add a transport level observer, if needed\n        const connection = transportKey ? observeConn(transportKey, null, conn, _switch.observer) : conn\n        const connFSM = new IncomingConnection({ connection, _switch, transportKey, peerInfo })\n\n        connFSM.once('error', (err) => log(err))\n        connFSM.once('private', (_conn) => {\n          // Use the custom handler, if it was provided\n          if (handler) {\n            return handler(_conn)\n          }\n          connFSM.encrypt()\n        })\n        connFSM.once('encrypted', () => connFSM.upgrade())\n\n        connFSM.protect()\n      })\n    }\n  }\n}\n\nmodule.exports = listener\n"},"lineCount":null}},"error":null,"hash":"bb145c705d85cd49a581d6aadd367ff7","cacheData":{"env":{}}}