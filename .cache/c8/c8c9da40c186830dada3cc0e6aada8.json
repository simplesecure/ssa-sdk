{"id":"K8WA","dependencies":[{"name":"/Users/polluterofminds/Development/simpleid/ssa-sdk/package.json","includedInParent":true,"mtime":1584306008866},{"name":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-kad-dht/package.json","includedInParent":true,"mtime":1582579780032},{"name":"cids","loc":{"line":3,"column":20},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/cids/src/index.js"},{"name":"peer-info","loc":{"line":4,"column":25},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/peer-info/src/index.js"},{"name":"promise-to-callback","loc":{"line":5,"column":34},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/promise-to-callback/index.js"},{"name":"err-code","loc":{"line":6,"column":24},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-kad-dht/node_modules/err-code/index.js"},{"name":"../../message","loc":{"line":8,"column":24},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-kad-dht/src/message/index.js"},{"name":"../../utils","loc":{"line":9,"column":22},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-kad-dht/src/utils.js"}],"generated":{"js":"\"use strict\";const e=require(\"cids\"),r=require(\"peer-info\"),o=require(\"promise-to-callback\"),s=require(\"err-code\"),t=require(\"../../message\"),n=require(\"../../utils\");module.exports=(i=>{const c=n.logger(i.peerInfo.id,\"rpc:get-providers\");return function(u,l,p){o(async function(o,u){let l;try{l=new e(u.key)}catch(y){throw s(new Error(`Invalid CID: ${y.message}`),\"ERR_INVALID_CID\")}c(\"%s\",l.toBaseEncodedString());const p=n.bufferToKey(l.buffer),[a,d,g]=await Promise.all([i.datastore.has(p),i.providers.getProviders(l),i._betterPeersToQueryAsync(u,o)]),f=d.map(e=>i.peerBook.has(e)?i.peerBook.get(e):i.peerBook.put(new r(e)));a&&f.push(i.peerInfo);const h=new t(u.type,u.key,u.clusterLevel);return f.length>0&&(h.providerPeers=f),g.length>0&&(h.closerPeers=g),c(\"got %s providers %s closerPeers\",f.length,g.length),h}(u,l))(p)}});"},"sourceMaps":{"js":{"mappings":[{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","original":{"line":1,"column":0},"generated":{"line":1,"column":0}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","original":{"line":3,"column":0},"generated":{"line":1,"column":13}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"CID","original":{"line":3,"column":6},"generated":{"line":1,"column":19}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"require","original":{"line":3,"column":12},"generated":{"line":1,"column":21}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","original":{"line":3,"column":20},"generated":{"line":1,"column":29}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"PeerInfo","original":{"line":4,"column":6},"generated":{"line":1,"column":37}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"require","original":{"line":4,"column":17},"generated":{"line":1,"column":39}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","original":{"line":4,"column":25},"generated":{"line":1,"column":47}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"promiseToCallback","original":{"line":5,"column":6},"generated":{"line":1,"column":60}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"require","original":{"line":5,"column":26},"generated":{"line":1,"column":62}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","original":{"line":5,"column":34},"generated":{"line":1,"column":70}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"errcode","original":{"line":6,"column":6},"generated":{"line":1,"column":93}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"require","original":{"line":6,"column":16},"generated":{"line":1,"column":95}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","original":{"line":6,"column":24},"generated":{"line":1,"column":103}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"Message","original":{"line":8,"column":6},"generated":{"line":1,"column":115}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"require","original":{"line":8,"column":16},"generated":{"line":1,"column":117}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","original":{"line":8,"column":24},"generated":{"line":1,"column":125}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"utils","original":{"line":9,"column":6},"generated":{"line":1,"column":142}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"require","original":{"line":9,"column":14},"generated":{"line":1,"column":144}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","original":{"line":9,"column":22},"generated":{"line":1,"column":152}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"module","original":{"line":11,"column":0},"generated":{"line":1,"column":167}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"exports","original":{"line":11,"column":7},"generated":{"line":1,"column":174}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"dht","original":{"line":11,"column":18},"generated":{"line":1,"column":182}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"dht","original":{"line":11,"column":18},"generated":{"line":1,"column":183}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"log","original":{"line":12,"column":8},"generated":{"line":1,"column":187}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"log","original":{"line":12,"column":8},"generated":{"line":1,"column":193}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"utils","original":{"line":12,"column":14},"generated":{"line":1,"column":195}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"logger","original":{"line":12,"column":20},"generated":{"line":1,"column":197}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"dht","original":{"line":12,"column":27},"generated":{"line":1,"column":204}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"peerInfo","original":{"line":12,"column":31},"generated":{"line":1,"column":206}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"id","original":{"line":12,"column":40},"generated":{"line":1,"column":215}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","original":{"line":12,"column":44},"generated":{"line":1,"column":218}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","original":{"line":72,"column":9},"generated":{"line":1,"column":239}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","original":{"line":72,"column":9},"generated":{"line":1,"column":246}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"peer","original":{"line":72,"column":32},"generated":{"line":1,"column":255}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"msg","original":{"line":72,"column":38},"generated":{"line":1,"column":257}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"callback","original":{"line":72,"column":43},"generated":{"line":1,"column":259}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"promiseToCallback","original":{"line":73,"column":4},"generated":{"line":1,"column":262}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"getProvidersAsync","original":{"line":21,"column":17},"generated":{"line":1,"column":264}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"peer","original":{"line":21,"column":36},"generated":{"line":1,"column":279}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"msg","original":{"line":21,"column":42},"generated":{"line":1,"column":281}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"cid","original":{"line":22,"column":8},"generated":{"line":1,"column":284}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"cid","original":{"line":22,"column":8},"generated":{"line":1,"column":288}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","original":{"line":23,"column":8},"generated":{"line":1,"column":290}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"cid","original":{"line":24,"column":6},"generated":{"line":1,"column":294}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","original":{"line":24,"column":12},"generated":{"line":1,"column":296}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"CID","original":{"line":24,"column":16},"generated":{"line":1,"column":300}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"msg","original":{"line":24,"column":20},"generated":{"line":1,"column":302}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"key","original":{"line":24,"column":24},"generated":{"line":1,"column":304}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","original":{"line":25,"column":6},"generated":{"line":1,"column":309}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"err","original":{"line":25,"column":13},"generated":{"line":1,"column":315}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"errcode","original":{"line":26,"column":12},"generated":{"line":1,"column":318}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"errcode","original":{"line":26,"column":12},"generated":{"line":1,"column":324}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","original":{"line":26,"column":20},"generated":{"line":1,"column":326}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"Error","original":{"line":26,"column":24},"generated":{"line":1,"column":330}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"err","original":{"line":26,"column":46},"generated":{"line":1,"column":352}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"message","original":{"line":26,"column":50},"generated":{"line":1,"column":354}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","original":{"line":26,"column":62},"generated":{"line":1,"column":365}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"log","original":{"line":29,"column":4},"generated":{"line":1,"column":384}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","original":{"line":29,"column":8},"generated":{"line":1,"column":386}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"cid","original":{"line":29,"column":14},"generated":{"line":1,"column":391}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"toBaseEncodedString","original":{"line":29,"column":18},"generated":{"line":1,"column":393}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"dsKey","original":{"line":30,"column":10},"generated":{"line":1,"column":416}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"dsKey","original":{"line":30,"column":10},"generated":{"line":1,"column":422}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"utils","original":{"line":30,"column":18},"generated":{"line":1,"column":424}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"bufferToKey","original":{"line":30,"column":24},"generated":{"line":1,"column":426}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"cid","original":{"line":30,"column":36},"generated":{"line":1,"column":438}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"buffer","original":{"line":30,"column":40},"generated":{"line":1,"column":440}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"has","original":{"line":32,"column":11},"generated":{"line":1,"column":449}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"peers","original":{"line":32,"column":16},"generated":{"line":1,"column":451}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"closer","original":{"line":32,"column":23},"generated":{"line":1,"column":453}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"Promise","original":{"line":32,"column":39},"generated":{"line":1,"column":462}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"all","original":{"line":32,"column":47},"generated":{"line":1,"column":470}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","original":{"line":32,"column":51},"generated":{"line":1,"column":474}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"dht","original":{"line":33,"column":6},"generated":{"line":1,"column":475}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"datastore","original":{"line":33,"column":10},"generated":{"line":1,"column":477}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"has","original":{"line":33,"column":20},"generated":{"line":1,"column":487}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"dsKey","original":{"line":33,"column":24},"generated":{"line":1,"column":491}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"dht","original":{"line":34,"column":6},"generated":{"line":1,"column":494}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"providers","original":{"line":34,"column":10},"generated":{"line":1,"column":496}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"getProviders","original":{"line":34,"column":20},"generated":{"line":1,"column":506}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"cid","original":{"line":34,"column":33},"generated":{"line":1,"column":519}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"dht","original":{"line":35,"column":6},"generated":{"line":1,"column":522}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"_betterPeersToQueryAsync","original":{"line":35,"column":10},"generated":{"line":1,"column":524}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"msg","original":{"line":35,"column":35},"generated":{"line":1,"column":549}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"peer","original":{"line":35,"column":40},"generated":{"line":1,"column":551}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"providers","original":{"line":38,"column":10},"generated":{"line":1,"column":556}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"peers","original":{"line":38,"column":22},"generated":{"line":1,"column":558}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"map","original":{"line":38,"column":28},"generated":{"line":1,"column":560}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"p","original":{"line":38,"column":33},"generated":{"line":1,"column":564}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"dht","original":{"line":39,"column":10},"generated":{"line":1,"column":567}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"peerBook","original":{"line":39,"column":14},"generated":{"line":1,"column":569}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"has","original":{"line":39,"column":23},"generated":{"line":1,"column":578}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"p","original":{"line":39,"column":27},"generated":{"line":1,"column":582}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"dht","original":{"line":40,"column":15},"generated":{"line":1,"column":585}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"peerBook","original":{"line":40,"column":19},"generated":{"line":1,"column":587}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"get","original":{"line":40,"column":28},"generated":{"line":1,"column":596}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"p","original":{"line":40,"column":32},"generated":{"line":1,"column":600}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"dht","original":{"line":43,"column":13},"generated":{"line":1,"column":603}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"peerBook","original":{"line":43,"column":17},"generated":{"line":1,"column":605}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"put","original":{"line":43,"column":26},"generated":{"line":1,"column":614}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","original":{"line":43,"column":30},"generated":{"line":1,"column":618}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"PeerInfo","original":{"line":43,"column":34},"generated":{"line":1,"column":622}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"p","original":{"line":43,"column":43},"generated":{"line":1,"column":624}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"has","original":{"line":46,"column":8},"generated":{"line":1,"column":629}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"providers","original":{"line":47,"column":6},"generated":{"line":1,"column":632}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"push","original":{"line":47,"column":16},"generated":{"line":1,"column":634}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"dht","original":{"line":47,"column":21},"generated":{"line":1,"column":639}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"peerInfo","original":{"line":47,"column":25},"generated":{"line":1,"column":641}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"response","original":{"line":50,"column":10},"generated":{"line":1,"column":651}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"response","original":{"line":50,"column":10},"generated":{"line":1,"column":657}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","original":{"line":50,"column":21},"generated":{"line":1,"column":659}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"Message","original":{"line":50,"column":25},"generated":{"line":1,"column":663}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"msg","original":{"line":50,"column":33},"generated":{"line":1,"column":665}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"type","original":{"line":50,"column":37},"generated":{"line":1,"column":667}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"msg","original":{"line":50,"column":43},"generated":{"line":1,"column":672}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"key","original":{"line":50,"column":47},"generated":{"line":1,"column":674}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"msg","original":{"line":50,"column":52},"generated":{"line":1,"column":678}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"clusterLevel","original":{"line":50,"column":56},"generated":{"line":1,"column":680}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"response","original":{"line":61,"column":11},"generated":{"line":1,"column":694}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"providers","original":{"line":52,"column":8},"generated":{"line":1,"column":701}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"length","original":{"line":52,"column":18},"generated":{"line":1,"column":703}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","original":{"line":52,"column":27},"generated":{"line":1,"column":710}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"response","original":{"line":53,"column":6},"generated":{"line":1,"column":714}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"providerPeers","original":{"line":53,"column":15},"generated":{"line":1,"column":716}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"providers","original":{"line":53,"column":31},"generated":{"line":1,"column":730}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"closer","original":{"line":56,"column":8},"generated":{"line":1,"column":733}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"length","original":{"line":56,"column":15},"generated":{"line":1,"column":735}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","original":{"line":56,"column":24},"generated":{"line":1,"column":742}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"response","original":{"line":57,"column":6},"generated":{"line":1,"column":746}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"closerPeers","original":{"line":57,"column":15},"generated":{"line":1,"column":748}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"closer","original":{"line":57,"column":29},"generated":{"line":1,"column":760}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"log","original":{"line":60,"column":4},"generated":{"line":1,"column":763}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","original":{"line":60,"column":8},"generated":{"line":1,"column":765}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"providers","original":{"line":60,"column":43},"generated":{"line":1,"column":799}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"length","original":{"line":60,"column":53},"generated":{"line":1,"column":801}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"closer","original":{"line":60,"column":61},"generated":{"line":1,"column":808}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"length","original":{"line":60,"column":68},"generated":{"line":1,"column":810}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"response","original":{"line":61,"column":11},"generated":{"line":1,"column":818}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"getProvidersAsync","original":{"line":73,"column":22},"generated":{"line":1,"column":820}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"peer","original":{"line":73,"column":40},"generated":{"line":1,"column":821}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"msg","original":{"line":73,"column":46},"generated":{"line":1,"column":823}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"promiseToCallback","original":{"line":73,"column":4},"generated":{"line":1,"column":826}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js","name":"callback","original":{"line":73,"column":52},"generated":{"line":1,"column":827}}],"sources":{"node_modules/ipfs/node_modules/libp2p-kad-dht/src/rpc/handlers/get-providers.js":"'use strict'\n\nconst CID = require('cids')\nconst PeerInfo = require('peer-info')\nconst promiseToCallback = require('promise-to-callback')\nconst errcode = require('err-code')\n\nconst Message = require('../../message')\nconst utils = require('../../utils')\n\nmodule.exports = (dht) => {\n  const log = utils.logger(dht.peerInfo.id, 'rpc:get-providers')\n\n  /**\n   * Process `GetProviders` DHT messages.\n   *\n   * @param {PeerInfo} peer\n   * @param {Message} msg\n   * @returns {Promise<Message>} Resolves a `Message` response\n   */\n  async function getProvidersAsync (peer, msg) {\n    let cid\n    try {\n      cid = new CID(msg.key)\n    } catch (err) {\n      throw errcode(new Error(`Invalid CID: ${err.message}`), 'ERR_INVALID_CID')\n    }\n\n    log('%s', cid.toBaseEncodedString())\n    const dsKey = utils.bufferToKey(cid.buffer)\n\n    const [has, peers, closer] = await Promise.all([\n      dht.datastore.has(dsKey),\n      dht.providers.getProviders(cid),\n      dht._betterPeersToQueryAsync(msg, peer)\n    ])\n\n    const providers = peers.map((p) => {\n      if (dht.peerBook.has(p)) {\n        return dht.peerBook.get(p)\n      }\n\n      return dht.peerBook.put(new PeerInfo(p))\n    })\n\n    if (has) {\n      providers.push(dht.peerInfo)\n    }\n\n    const response = new Message(msg.type, msg.key, msg.clusterLevel)\n\n    if (providers.length > 0) {\n      response.providerPeers = providers\n    }\n\n    if (closer.length > 0) {\n      response.closerPeers = closer\n    }\n\n    log('got %s providers %s closerPeers', providers.length, closer.length)\n    return response\n  }\n\n  /**\n   * Process `GetProviders` DHT messages.\n   *\n   * @param {PeerInfo} peer\n   * @param {Message} msg\n   * @param {function(Error, Message)} callback\n   * @returns {undefined}\n   */\n  return function getProviders (peer, msg, callback) {\n    promiseToCallback(getProvidersAsync(peer, msg))(callback)\n  }\n}\n"},"lineCount":null}},"error":null,"hash":"c589a75befd323c44d019fed9e7cb0a5","cacheData":{"env":{}}}