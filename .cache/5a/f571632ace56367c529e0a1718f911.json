{"id":"nvl2","dependencies":[{"name":"/Users/polluterofminds/Development/simpleid/ssa-sdk/package.json","includedInParent":true,"mtime":1584306008866},{"name":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/package.json","includedInParent":true,"mtime":1582579778668},{"name":"ipns","loc":{"line":3,"column":21},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/ipns/src/index.js"},{"name":"multihashes","loc":{"line":4,"column":47},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/multihashes/src/index.js"},{"name":"datastore-pubsub","loc":{"line":5,"column":32},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/datastore-pubsub/src/index.js"},{"name":"class-is","loc":{"line":7,"column":23},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/class-is/index.js"},{"name":"err-code","loc":{"line":9,"column":24},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/err-code/index.js"},{"name":"debug","loc":{"line":10,"column":22},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/debug/src/browser.js"},{"name":"buffer","parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/node-libs-browser/node_modules/buffer/index.js"}],"generated":{"js":"var Buffer = require(\"buffer\").Buffer;\nvar s=require(\"buffer\").Buffer;const e=require(\"ipns\"),{fromB58String:t,toB58String:r}=require(\"multihashes\"),i=require(\"datastore-pubsub\"),n=require(\"class-is\"),u=require(\"err-code\"),o=require(\"debug\"),c=o(\"ipfs:ipns:pubsub\");c.error=o(\"ipfs:ipns:pubsub:error\");class b{constructor(s,t,r){this._pubsub=s,this._subscriptions={},this._handleSubscriptionKey=this._handleSubscriptionKey.bind(this),this._pubsubDs=new i(s,t,r,e.validator,this._handleSubscriptionKey)}async put(s,e){return this._pubsubDs.put(s,e)}async get(s){let t,i;try{t=await this._pubsubDs.get(s)}catch(n){i=n}if(s.slice(0,e.namespaceLength).toString()===e.namespace){const t=r(s),i=r(s.slice(e.namespaceLength));this._subscriptions[t]=i,c(`subscribed to pubsub topic ${t}, id ${i}`)}if(i)throw i;return t}_handleSubscriptionKey(i){s.isBuffer(i)&&(i=r(i));const n=this._subscriptions[i];if(!n)throw u(new Error(`key ${i} does not correspond to a subscription`),\"ERR_INVALID_KEY\");let o;try{o=e.getIdKeys(t(n))}catch(b){throw c.error(b),b}return o.routingKey.toBuffer()}getSubscriptions(){return Object.values(this._subscriptions).filter(Boolean).map(s=>`${e.namespace}${s}`)}async cancel(t){if(\"string\"!=typeof t)throw u(new Error(\"invalid subscription name\"),\"ERR_INVALID_SUBSCRIPTION_NAME\");t.startsWith(e.namespace)&&(t=t.substring(e.namespaceLength));const r=Object.keys(this._subscriptions).find(s=>this._subscriptions[s]===t);if(!r)return{canceled:!1};const i=s.from(r);return this._pubsubDs.unsubscribe(i),this._subscriptions[r]=void 0,c(`unsubscribed pubsub ${r}: ${t}`),{canceled:!0}}}exports=module.exports=n(b,{className:\"IpnsPubsubDatastore\",symbolName:\"@js-ipfs/ipns/IpnsPubsubDatastore\"});"},"sourceMaps":{"js":{"mappings":[{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":147,"column":0},"generated":{"line":2,"column":0}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":147,"column":0},"generated":{"line":2,"column":4}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":147,"column":0},"generated":{"line":2,"column":6}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":147,"column":0},"generated":{"line":2,"column":14}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":147,"column":0},"generated":{"line":2,"column":24}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":3,"column":0},"generated":{"line":2,"column":31}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"ipns","original":{"line":3,"column":6},"generated":{"line":2,"column":37}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"require","original":{"line":3,"column":13},"generated":{"line":2,"column":39}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":3,"column":21},"generated":{"line":2,"column":47}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":4,"column":6},"generated":{"line":2,"column":56}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"fromB58String","original":{"line":4,"column":8},"generated":{"line":2,"column":70}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":4,"column":6},"generated":{"line":2,"column":72}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"toB58String","original":{"line":4,"column":23},"generated":{"line":2,"column":84}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"require","original":{"line":4,"column":39},"generated":{"line":2,"column":87}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":4,"column":47},"generated":{"line":2,"column":95}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"PubsubDatastore","original":{"line":5,"column":6},"generated":{"line":2,"column":110}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"require","original":{"line":5,"column":24},"generated":{"line":2,"column":112}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":5,"column":32},"generated":{"line":2,"column":120}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"withIs","original":{"line":7,"column":6},"generated":{"line":2,"column":140}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"require","original":{"line":7,"column":15},"generated":{"line":2,"column":142}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":7,"column":23},"generated":{"line":2,"column":150}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"errcode","original":{"line":9,"column":6},"generated":{"line":2,"column":162}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"require","original":{"line":9,"column":16},"generated":{"line":2,"column":164}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":9,"column":24},"generated":{"line":2,"column":172}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"debug","original":{"line":10,"column":6},"generated":{"line":2,"column":184}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"require","original":{"line":10,"column":14},"generated":{"line":2,"column":186}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":10,"column":22},"generated":{"line":2,"column":194}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"log","original":{"line":11,"column":6},"generated":{"line":2,"column":203}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"debug","original":{"line":11,"column":12},"generated":{"line":2,"column":205}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":11,"column":18},"generated":{"line":2,"column":207}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"log","original":{"line":12,"column":0},"generated":{"line":2,"column":227}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"error","original":{"line":12,"column":4},"generated":{"line":2,"column":229}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"debug","original":{"line":12,"column":12},"generated":{"line":2,"column":235}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":12,"column":18},"generated":{"line":2,"column":237}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":15,"column":0},"generated":{"line":2,"column":263}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"IpnsPubsubDatastore","original":{"line":15,"column":6},"generated":{"line":2,"column":269}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"constructor","original":{"line":16,"column":2},"generated":{"line":2,"column":271}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"pubsub","original":{"line":16,"column":15},"generated":{"line":2,"column":283}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"localDatastore","original":{"line":16,"column":23},"generated":{"line":2,"column":285}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"peerId","original":{"line":16,"column":39},"generated":{"line":2,"column":287}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"_pubsub","original":{"line":17,"column":9},"generated":{"line":2,"column":290}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"_pubsub","original":{"line":17,"column":9},"generated":{"line":2,"column":295}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"pubsub","original":{"line":17,"column":19},"generated":{"line":2,"column":303}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"_subscriptions","original":{"line":18,"column":9},"generated":{"line":2,"column":305}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"_subscriptions","original":{"line":18,"column":9},"generated":{"line":2,"column":310}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":18,"column":26},"generated":{"line":2,"column":325}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"_handleSubscriptionKey","original":{"line":21,"column":9},"generated":{"line":2,"column":328}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"_handleSubscriptionKey","original":{"line":21,"column":9},"generated":{"line":2,"column":333}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":21,"column":34},"generated":{"line":2,"column":356}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"_handleSubscriptionKey","original":{"line":21,"column":39},"generated":{"line":2,"column":361}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"bind","original":{"line":21,"column":62},"generated":{"line":2,"column":384}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":21,"column":67},"generated":{"line":2,"column":389}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"_pubsubDs","original":{"line":22,"column":9},"generated":{"line":2,"column":395}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"_pubsubDs","original":{"line":22,"column":9},"generated":{"line":2,"column":400}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":22,"column":21},"generated":{"line":2,"column":410}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"PubsubDatastore","original":{"line":22,"column":25},"generated":{"line":2,"column":414}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"pubsub","original":{"line":22,"column":41},"generated":{"line":2,"column":416}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"localDatastore","original":{"line":22,"column":49},"generated":{"line":2,"column":418}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"peerId","original":{"line":22,"column":65},"generated":{"line":2,"column":420}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"ipns","original":{"line":22,"column":73},"generated":{"line":2,"column":422}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"validator","original":{"line":22,"column":78},"generated":{"line":2,"column":424}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":22,"column":89},"generated":{"line":2,"column":434}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"_handleSubscriptionKey","original":{"line":22,"column":94},"generated":{"line":2,"column":439}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"put","original":{"line":32,"column":8},"generated":{"line":2,"column":463}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"key","original":{"line":32,"column":13},"generated":{"line":2,"column":473}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"value","original":{"line":32,"column":18},"generated":{"line":2,"column":475}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":33,"column":11},"generated":{"line":2,"column":478}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":33,"column":11},"generated":{"line":2,"column":485}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"_pubsubDs","original":{"line":33,"column":16},"generated":{"line":2,"column":490}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"put","original":{"line":33,"column":26},"generated":{"line":2,"column":500}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"key","original":{"line":33,"column":30},"generated":{"line":2,"column":504}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"value","original":{"line":33,"column":35},"generated":{"line":2,"column":506}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"get","original":{"line":44,"column":8},"generated":{"line":2,"column":509}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"key","original":{"line":44,"column":13},"generated":{"line":2,"column":519}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"res","original":{"line":45,"column":8},"generated":{"line":2,"column":522}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"res","original":{"line":45,"column":8},"generated":{"line":2,"column":526}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"err","original":{"line":46,"column":8},"generated":{"line":2,"column":528}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":48,"column":8},"generated":{"line":2,"column":530}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"res","original":{"line":49,"column":6},"generated":{"line":2,"column":534}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":49,"column":18},"generated":{"line":2,"column":542}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"_pubsubDs","original":{"line":49,"column":23},"generated":{"line":2,"column":547}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"get","original":{"line":49,"column":33},"generated":{"line":2,"column":557}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"key","original":{"line":49,"column":37},"generated":{"line":2,"column":561}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":50,"column":6},"generated":{"line":2,"column":564}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"e","original":{"line":50,"column":13},"generated":{"line":2,"column":570}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"err","original":{"line":51,"column":6},"generated":{"line":2,"column":573}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"e","original":{"line":51,"column":12},"generated":{"line":2,"column":575}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"ns","original":{"line":57,"column":8},"generated":{"line":2,"column":577}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"key","original":{"line":55,"column":15},"generated":{"line":2,"column":580}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"slice","original":{"line":55,"column":19},"generated":{"line":2,"column":582}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":55,"column":25},"generated":{"line":2,"column":588}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"ipns","original":{"line":55,"column":28},"generated":{"line":2,"column":590}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"namespaceLength","original":{"line":55,"column":33},"generated":{"line":2,"column":592}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"toString","original":{"line":57,"column":11},"generated":{"line":2,"column":609}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"ipns","original":{"line":57,"column":26},"generated":{"line":2,"column":622}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"namespace","original":{"line":57,"column":31},"generated":{"line":2,"column":624}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":57,"column":42},"generated":{"line":2,"column":634}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"stringifiedTopic","original":{"line":58,"column":12},"generated":{"line":2,"column":635}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"stringifiedTopic","original":{"line":58,"column":12},"generated":{"line":2,"column":641}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"toB58String","original":{"line":58,"column":31},"generated":{"line":2,"column":643}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"key","original":{"line":58,"column":43},"generated":{"line":2,"column":645}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"id","original":{"line":59,"column":12},"generated":{"line":2,"column":648}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"toB58String","original":{"line":59,"column":17},"generated":{"line":2,"column":650}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"key","original":{"line":59,"column":29},"generated":{"line":2,"column":652}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"slice","original":{"line":59,"column":33},"generated":{"line":2,"column":654}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"ipns","original":{"line":59,"column":39},"generated":{"line":2,"column":660}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"namespaceLength","original":{"line":59,"column":44},"generated":{"line":2,"column":662}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"_subscriptions","original":{"line":61,"column":11},"generated":{"line":2,"column":680}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"_subscriptions","original":{"line":61,"column":11},"generated":{"line":2,"column":685}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"stringifiedTopic","original":{"line":61,"column":26},"generated":{"line":2,"column":700}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"id","original":{"line":61,"column":46},"generated":{"line":2,"column":703}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"log","original":{"line":63,"column":6},"generated":{"line":2,"column":705}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"stringifiedTopic","original":{"line":63,"column":40},"generated":{"line":2,"column":737}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"id","original":{"line":63,"column":64},"generated":{"line":2,"column":746}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"err","original":{"line":67,"column":8},"generated":{"line":2,"column":751}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"err","original":{"line":67,"column":8},"generated":{"line":2,"column":754}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"err","original":{"line":68,"column":12},"generated":{"line":2,"column":756}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"err","original":{"line":68,"column":12},"generated":{"line":2,"column":762}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"res","original":{"line":71,"column":11},"generated":{"line":2,"column":764}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"res","original":{"line":71,"column":11},"generated":{"line":2,"column":771}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"_handleSubscriptionKey","original":{"line":75,"column":2},"generated":{"line":2,"column":773}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"key","original":{"line":75,"column":26},"generated":{"line":2,"column":796}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"Buffer","original":{"line":76,"column":8},"generated":{"line":2,"column":799}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"isBuffer","original":{"line":76,"column":15},"generated":{"line":2,"column":801}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"key","original":{"line":76,"column":24},"generated":{"line":2,"column":810}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"key","original":{"line":77,"column":6},"generated":{"line":2,"column":815}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"toB58String","original":{"line":77,"column":12},"generated":{"line":2,"column":817}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"key","original":{"line":77,"column":24},"generated":{"line":2,"column":819}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"subscriber","original":{"line":80,"column":10},"generated":{"line":2,"column":823}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"subscriber","original":{"line":80,"column":10},"generated":{"line":2,"column":829}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":80,"column":23},"generated":{"line":2,"column":831}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"_subscriptions","original":{"line":80,"column":28},"generated":{"line":2,"column":836}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"key","original":{"line":80,"column":43},"generated":{"line":2,"column":851}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":82,"column":8},"generated":{"line":2,"column":854}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"subscriber","original":{"line":82,"column":9},"generated":{"line":2,"column":858}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"errcode","original":{"line":83,"column":12},"generated":{"line":2,"column":860}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"errcode","original":{"line":83,"column":12},"generated":{"line":2,"column":866}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":83,"column":20},"generated":{"line":2,"column":868}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"Error","original":{"line":83,"column":24},"generated":{"line":2,"column":872}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"key","original":{"line":83,"column":37},"generated":{"line":2,"column":885}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":83,"column":83},"generated":{"line":2,"column":928}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"keys","original":{"line":86,"column":8},"generated":{"line":2,"column":947}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"keys","original":{"line":86,"column":8},"generated":{"line":2,"column":951}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":87,"column":8},"generated":{"line":2,"column":953}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"keys","original":{"line":88,"column":6},"generated":{"line":2,"column":957}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"ipns","original":{"line":88,"column":13},"generated":{"line":2,"column":959}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"getIdKeys","original":{"line":88,"column":18},"generated":{"line":2,"column":961}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"fromB58String","original":{"line":88,"column":28},"generated":{"line":2,"column":971}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"subscriber","original":{"line":88,"column":42},"generated":{"line":2,"column":973}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":89,"column":6},"generated":{"line":2,"column":977}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"err","original":{"line":89,"column":13},"generated":{"line":2,"column":983}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"err","original":{"line":91,"column":12},"generated":{"line":2,"column":986}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"log","original":{"line":90,"column":6},"generated":{"line":2,"column":992}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"error","original":{"line":90,"column":10},"generated":{"line":2,"column":994}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"err","original":{"line":90,"column":16},"generated":{"line":2,"column":1000}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"err","original":{"line":91,"column":12},"generated":{"line":2,"column":1003}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"keys","original":{"line":94,"column":11},"generated":{"line":2,"column":1005}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"keys","original":{"line":94,"column":11},"generated":{"line":2,"column":1012}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"routingKey","original":{"line":94,"column":16},"generated":{"line":2,"column":1014}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"toBuffer","original":{"line":94,"column":27},"generated":{"line":2,"column":1025}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"getSubscriptions","original":{"line":102,"column":2},"generated":{"line":2,"column":1036}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"subscriptions","original":{"line":105,"column":11},"generated":{"line":2,"column":1055}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"Object","original":{"line":103,"column":26},"generated":{"line":2,"column":1062}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"values","original":{"line":103,"column":33},"generated":{"line":2,"column":1069}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":103,"column":40},"generated":{"line":2,"column":1076}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"_subscriptions","original":{"line":103,"column":45},"generated":{"line":2,"column":1081}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"filter","original":{"line":103,"column":61},"generated":{"line":2,"column":1097}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"Boolean","original":{"line":103,"column":68},"generated":{"line":2,"column":1104}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"map","original":{"line":105,"column":25},"generated":{"line":2,"column":1113}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"sub","original":{"line":105,"column":30},"generated":{"line":2,"column":1117}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"ipns","original":{"line":105,"column":41},"generated":{"line":2,"column":1123}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"namespace","original":{"line":105,"column":46},"generated":{"line":2,"column":1125}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"sub","original":{"line":105,"column":58},"generated":{"line":2,"column":1137}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"cancel","original":{"line":114,"column":8},"generated":{"line":2,"column":1142}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"name","original":{"line":114,"column":16},"generated":{"line":2,"column":1155}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":115,"column":8},"generated":{"line":2,"column":1158}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":115,"column":24},"generated":{"line":2,"column":1161}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"name","original":{"line":115,"column":15},"generated":{"line":2,"column":1178}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"errcode","original":{"line":116,"column":12},"generated":{"line":2,"column":1180}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"errcode","original":{"line":116,"column":12},"generated":{"line":2,"column":1186}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":116,"column":20},"generated":{"line":2,"column":1188}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"Error","original":{"line":116,"column":24},"generated":{"line":2,"column":1192}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":116,"column":30},"generated":{"line":2,"column":1198}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":116,"column":60},"generated":{"line":2,"column":1227}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"name","original":{"line":120,"column":8},"generated":{"line":2,"column":1260}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"startsWith","original":{"line":120,"column":13},"generated":{"line":2,"column":1262}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"ipns","original":{"line":120,"column":24},"generated":{"line":2,"column":1273}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"namespace","original":{"line":120,"column":29},"generated":{"line":2,"column":1275}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"name","original":{"line":121,"column":6},"generated":{"line":2,"column":1288}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"name","original":{"line":121,"column":13},"generated":{"line":2,"column":1290}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"substring","original":{"line":121,"column":18},"generated":{"line":2,"column":1292}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"ipns","original":{"line":121,"column":28},"generated":{"line":2,"column":1302}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"namespaceLength","original":{"line":121,"column":33},"generated":{"line":2,"column":1304}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"stringifiedTopic","original":{"line":124,"column":10},"generated":{"line":2,"column":1322}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"stringifiedTopic","original":{"line":124,"column":10},"generated":{"line":2,"column":1328}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"Object","original":{"line":124,"column":29},"generated":{"line":2,"column":1330}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"keys","original":{"line":124,"column":36},"generated":{"line":2,"column":1337}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":124,"column":41},"generated":{"line":2,"column":1342}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"_subscriptions","original":{"line":124,"column":46},"generated":{"line":2,"column":1347}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"find","original":{"line":124,"column":62},"generated":{"line":2,"column":1363}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"key","original":{"line":124,"column":68},"generated":{"line":2,"column":1368}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":124,"column":76},"generated":{"line":2,"column":1371}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"_subscriptions","original":{"line":124,"column":81},"generated":{"line":2,"column":1376}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"key","original":{"line":124,"column":96},"generated":{"line":2,"column":1391}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"name","original":{"line":124,"column":105},"generated":{"line":2,"column":1396}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":127,"column":8},"generated":{"line":2,"column":1399}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"stringifiedTopic","original":{"line":127,"column":9},"generated":{"line":2,"column":1403}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":128,"column":13},"generated":{"line":2,"column":1405}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":128,"column":13},"generated":{"line":2,"column":1411}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"canceled","original":{"line":129,"column":8},"generated":{"line":2,"column":1412}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":129,"column":18},"generated":{"line":2,"column":1422}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"bufTopic","original":{"line":134,"column":10},"generated":{"line":2,"column":1425}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"bufTopic","original":{"line":134,"column":10},"generated":{"line":2,"column":1431}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"Buffer","original":{"line":134,"column":21},"generated":{"line":2,"column":1433}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"from","original":{"line":134,"column":28},"generated":{"line":2,"column":1435}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"stringifiedTopic","original":{"line":134,"column":33},"generated":{"line":2,"column":1440}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":141,"column":11},"generated":{"line":2,"column":1443}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"_pubsubDs","original":{"line":136,"column":9},"generated":{"line":2,"column":1450}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"_pubsubDs","original":{"line":136,"column":9},"generated":{"line":2,"column":1455}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"unsubscribe","original":{"line":136,"column":19},"generated":{"line":2,"column":1465}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"bufTopic","original":{"line":136,"column":31},"generated":{"line":2,"column":1477}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"_subscriptions","original":{"line":138,"column":9},"generated":{"line":2,"column":1480}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"_subscriptions","original":{"line":138,"column":9},"generated":{"line":2,"column":1485}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"stringifiedTopic","original":{"line":138,"column":24},"generated":{"line":2,"column":1500}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"undefined","original":{"line":138,"column":44},"generated":{"line":2,"column":1508}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"log","original":{"line":139,"column":4},"generated":{"line":2,"column":1510}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"stringifiedTopic","original":{"line":139,"column":31},"generated":{"line":2,"column":1535}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"name","original":{"line":139,"column":52},"generated":{"line":2,"column":1541}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":141,"column":11},"generated":{"line":2,"column":1546}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"canceled","original":{"line":142,"column":6},"generated":{"line":2,"column":1547}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":142,"column":16},"generated":{"line":2,"column":1557}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"exports","original":{"line":147,"column":0},"generated":{"line":2,"column":1561}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"module","original":{"line":147,"column":10},"generated":{"line":2,"column":1569}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"exports","original":{"line":147,"column":17},"generated":{"line":2,"column":1576}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"withIs","original":{"line":147,"column":27},"generated":{"line":2,"column":1584}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"IpnsPubsubDatastore","original":{"line":147,"column":34},"generated":{"line":2,"column":1586}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":147,"column":55},"generated":{"line":2,"column":1588}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"className","original":{"line":147,"column":57},"generated":{"line":2,"column":1589}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":147,"column":68},"generated":{"line":2,"column":1599}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","name":"symbolName","original":{"line":147,"column":91},"generated":{"line":2,"column":1621}},{"source":"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js","original":{"line":147,"column":103},"generated":{"line":2,"column":1632}}],"sources":{"node_modules/ipfs/src/core/ipns/routing/pubsub-datastore.js":"'use strict'\n\nconst ipns = require('ipns')\nconst { fromB58String, toB58String } = require('multihashes')\nconst PubsubDatastore = require('datastore-pubsub')\n\nconst withIs = require('class-is')\n\nconst errcode = require('err-code')\nconst debug = require('debug')\nconst log = debug('ipfs:ipns:pubsub')\nlog.error = debug('ipfs:ipns:pubsub:error')\n\n// Pubsub datastore aims to manage the pubsub subscriptions for IPNS\nclass IpnsPubsubDatastore {\n  constructor (pubsub, localDatastore, peerId) {\n    this._pubsub = pubsub\n    this._subscriptions = {}\n\n    // Bind _handleSubscriptionKey function, which is called by PubsubDatastore.\n    this._handleSubscriptionKey = this._handleSubscriptionKey.bind(this)\n    this._pubsubDs = new PubsubDatastore(pubsub, localDatastore, peerId, ipns.validator, this._handleSubscriptionKey)\n  }\n\n  /**\n   * Put a value to the pubsub datastore indexed by the received key properly encoded.\n   * @param {Buffer} key identifier of the value.\n   * @param {Buffer} value value to be stored.\n   * @param {function(Error)} callback\n   * @returns {void}\n   */\n  async put (key, value) { // eslint-disable-line require-await\n    return this._pubsubDs.put(key, value)\n  }\n\n  /**\n   * Get a value from the pubsub datastore indexed by the received key properly encoded.\n   * Also, the identifier topic is subscribed to and the pubsub datastore records will be\n   * updated once new publishes occur.\n   * @param {Buffer} key identifier of the value to be obtained.\n   * @param {function(Error, Buffer)} callback\n   * @returns {void}\n   */\n  async get (key) {\n    let res\n    let err\n\n    try {\n      res = await this._pubsubDs.get(key)\n    } catch (e) {\n      err = e\n    }\n\n    // Add topic subscribed\n    const ns = key.slice(0, ipns.namespaceLength)\n\n    if (ns.toString() === ipns.namespace) {\n      const stringifiedTopic = toB58String(key)\n      const id = toB58String(key.slice(ipns.namespaceLength))\n\n      this._subscriptions[stringifiedTopic] = id\n\n      log(`subscribed to pubsub topic ${stringifiedTopic}, id ${id}`)\n    }\n\n    // If no data was obtained, after storing the subscription, return the error.\n    if (err) {\n      throw err\n    }\n\n    return res\n  }\n\n  // Modify subscription key to have a proper encoding\n  _handleSubscriptionKey (key) {\n    if (Buffer.isBuffer(key)) {\n      key = toB58String(key)\n    }\n\n    const subscriber = this._subscriptions[key]\n\n    if (!subscriber) {\n      throw errcode(new Error(`key ${key} does not correspond to a subscription`), 'ERR_INVALID_KEY')\n    }\n\n    let keys\n    try {\n      keys = ipns.getIdKeys(fromB58String(subscriber))\n    } catch (err) {\n      log.error(err)\n      throw err\n    }\n\n    return keys.routingKey.toBuffer()\n  }\n\n  /**\n   * Get pubsub subscriptions related to ipns.\n   * @param {function(Error, Object)} callback\n   * @returns {Array<Object>}\n   */\n  getSubscriptions () {\n    const subscriptions = Object.values(this._subscriptions).filter(Boolean)\n\n    return subscriptions.map((sub) => `${ipns.namespace}${sub}`)\n  }\n\n  /**\n   * Cancel pubsub subscriptions related to ipns.\n   * @param {String} name ipns path to cancel the pubsub subscription.\n   * @param {function(Error, Object)} callback\n   * @returns {void}\n   */\n  async cancel (name) { // eslint-disable-line require-await\n    if (typeof name !== 'string') {\n      throw errcode(new Error('invalid subscription name'), 'ERR_INVALID_SUBSCRIPTION_NAME')\n    }\n\n    // Trim /ipns/ prefix from the name\n    if (name.startsWith(ipns.namespace)) {\n      name = name.substring(ipns.namespaceLength)\n    }\n\n    const stringifiedTopic = Object.keys(this._subscriptions).find((key) => this._subscriptions[key] === name)\n\n    // Not found topic\n    if (!stringifiedTopic) {\n      return {\n        canceled: false\n      }\n    }\n\n    // Unsubscribe topic\n    const bufTopic = Buffer.from(stringifiedTopic)\n\n    this._pubsubDs.unsubscribe(bufTopic)\n\n    this._subscriptions[stringifiedTopic] = undefined\n    log(`unsubscribed pubsub ${stringifiedTopic}: ${name}`)\n\n    return {\n      canceled: true\n    }\n  }\n}\n\nexports = module.exports = withIs(IpnsPubsubDatastore, { className: 'IpnsPubsubDatastore', symbolName: '@js-ipfs/ipns/IpnsPubsubDatastore' })\n"},"lineCount":null}},"error":null,"hash":"5383faa582f0c3acd2858ce4de3bb118","cacheData":{"env":{}}}