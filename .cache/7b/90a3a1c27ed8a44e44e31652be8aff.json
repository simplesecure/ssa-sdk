{"id":"yYk6","dependencies":[{"name":"/Users/polluterofminds/Development/simpleid/ssa-sdk/package.json","includedInParent":true,"mtime":1584306008866},{"name":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p/package.json","includedInParent":true,"mtime":1582579780031},{"name":"pull-stream/sources/values","loc":{"line":3,"column":23},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/pull-stream/sources/values.js"},{"name":"pull-stream/sinks/collect","loc":{"line":4,"column":24},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/pull-stream/sinks/collect.js"},{"name":"pull-stream/sources/empty","loc":{"line":5,"column":22},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/pull-stream/sources/empty.js"},{"name":"pull-stream/pull","loc":{"line":6,"column":21},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/pull-stream/pull.js"},{"name":"pull-length-prefixed","loc":{"line":7,"column":19},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/pull-length-prefixed/src/index.js"},{"name":"pull-handshake","loc":{"line":8,"column":26},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/pull-handshake/index.js"},{"name":"debug","loc":{"line":10,"column":22},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/debug/src/browser.js"}],"generated":{"js":"\"use strict\";const e=require(\"pull-stream/sources/values\"),t=require(\"pull-stream/sinks/collect\"),s=require(\"pull-stream/sources/empty\"),r=require(\"pull-stream/pull\"),i=require(\"pull-length-prefixed\"),a=require(\"pull-handshake\"),h=require(\"debug\"),l=h(\"libp2p:circuit:stream-handler\");l.err=h(\"libp2p:circuit:error:stream-handler\");class n{constructor(e,t,s,i){this.conn=e,this.stream=null,this.shake=null,this.timeout=t||6e4,this.maxLength=i||4096,\"function\"==typeof t&&(this.timeout=s||6e4),this.stream=a({timeout:this.timeout},t),this.shake=this.stream.handshake,r(this.stream,e,this.stream)}isValid(){return this.conn&&this.shake&&this.stream}read(e){if(!this.isValid())return e(new Error(\"handler is not in a valid state\"));i.decodeFromReader(this.shake,{maxLength:this.maxLength},(t,s)=>t?(l.err(t),e(t)):e(null,s))}write(s,a){if(a=a||(()=>{}),!this.isValid())return a(new Error(\"handler is not in a valid state\"));r(e([s]),i.encode(),t((e,t)=>{if(e)return l.err(e),this.shake.abort(e),a(e);t.forEach(e=>this.shake.write(e)),a()}))}getRawConn(){return this.conn}rest(){const e=this.shake.rest();return this.conn=null,this.stream=null,this.shake=null,e}close(){this.isValid()&&r(s(),this.rest())}}module.exports=n;"},"sourceMaps":{"js":{"mappings":[{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":1,"column":0},"generated":{"line":1,"column":0}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":3,"column":0},"generated":{"line":1,"column":13}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"values","original":{"line":3,"column":6},"generated":{"line":1,"column":19}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"require","original":{"line":3,"column":15},"generated":{"line":1,"column":21}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":3,"column":23},"generated":{"line":1,"column":29}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"collect","original":{"line":4,"column":6},"generated":{"line":1,"column":59}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"require","original":{"line":4,"column":16},"generated":{"line":1,"column":61}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":4,"column":24},"generated":{"line":1,"column":69}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"empty","original":{"line":5,"column":6},"generated":{"line":1,"column":98}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"require","original":{"line":5,"column":14},"generated":{"line":1,"column":100}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":5,"column":22},"generated":{"line":1,"column":108}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"pull","original":{"line":6,"column":6},"generated":{"line":1,"column":137}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"require","original":{"line":6,"column":13},"generated":{"line":1,"column":139}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":6,"column":21},"generated":{"line":1,"column":147}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"lp","original":{"line":7,"column":6},"generated":{"line":1,"column":167}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"require","original":{"line":7,"column":11},"generated":{"line":1,"column":169}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":7,"column":19},"generated":{"line":1,"column":177}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"handshake","original":{"line":8,"column":6},"generated":{"line":1,"column":201}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"require","original":{"line":8,"column":18},"generated":{"line":1,"column":203}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":8,"column":26},"generated":{"line":1,"column":211}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"debug","original":{"line":10,"column":6},"generated":{"line":1,"column":229}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"require","original":{"line":10,"column":14},"generated":{"line":1,"column":231}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":10,"column":22},"generated":{"line":1,"column":239}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"log","original":{"line":11,"column":6},"generated":{"line":1,"column":248}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"debug","original":{"line":11,"column":12},"generated":{"line":1,"column":250}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":11,"column":18},"generated":{"line":1,"column":252}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"log","original":{"line":12,"column":0},"generated":{"line":1,"column":285}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"err","original":{"line":12,"column":4},"generated":{"line":1,"column":287}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"debug","original":{"line":12,"column":10},"generated":{"line":1,"column":291}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":12,"column":16},"generated":{"line":1,"column":293}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":14,"column":0},"generated":{"line":1,"column":332}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"StreamHandler","original":{"line":14,"column":6},"generated":{"line":1,"column":338}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"constructor","original":{"line":23,"column":2},"generated":{"line":1,"column":340}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"conn","original":{"line":23,"column":15},"generated":{"line":1,"column":352}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"cb","original":{"line":23,"column":21},"generated":{"line":1,"column":354}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"timeout","original":{"line":23,"column":25},"generated":{"line":1,"column":356}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"maxLength","original":{"line":23,"column":34},"generated":{"line":1,"column":358}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"conn","original":{"line":24,"column":9},"generated":{"line":1,"column":361}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"conn","original":{"line":24,"column":9},"generated":{"line":1,"column":366}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"conn","original":{"line":24,"column":16},"generated":{"line":1,"column":371}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"stream","original":{"line":25,"column":9},"generated":{"line":1,"column":373}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"stream","original":{"line":25,"column":9},"generated":{"line":1,"column":378}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":25,"column":18},"generated":{"line":1,"column":385}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"shake","original":{"line":26,"column":9},"generated":{"line":1,"column":390}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"shake","original":{"line":26,"column":9},"generated":{"line":1,"column":395}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":26,"column":17},"generated":{"line":1,"column":401}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"timeout","original":{"line":27,"column":9},"generated":{"line":1,"column":406}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"timeout","original":{"line":27,"column":9},"generated":{"line":1,"column":411}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"cb","original":{"line":27,"column":19},"generated":{"line":1,"column":419}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":27,"column":25},"generated":{"line":1,"column":422}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"maxLength","original":{"line":28,"column":9},"generated":{"line":1,"column":426}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"maxLength","original":{"line":28,"column":9},"generated":{"line":1,"column":431}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"maxLength","original":{"line":28,"column":21},"generated":{"line":1,"column":441}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":28,"column":34},"generated":{"line":1,"column":444}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":30,"column":22},"generated":{"line":1,"column":449}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"cb","original":{"line":30,"column":15},"generated":{"line":1,"column":468}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"timeout","original":{"line":31,"column":11},"generated":{"line":1,"column":472}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"timeout","original":{"line":31,"column":11},"generated":{"line":1,"column":477}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"timeout","original":{"line":31,"column":21},"generated":{"line":1,"column":485}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":31,"column":32},"generated":{"line":1,"column":488}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"stream","original":{"line":34,"column":9},"generated":{"line":1,"column":493}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"stream","original":{"line":34,"column":9},"generated":{"line":1,"column":498}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"handshake","original":{"line":34,"column":18},"generated":{"line":1,"column":505}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":34,"column":28},"generated":{"line":1,"column":507}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"timeout","original":{"line":34,"column":30},"generated":{"line":1,"column":508}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":34,"column":39},"generated":{"line":1,"column":516}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"timeout","original":{"line":34,"column":44},"generated":{"line":1,"column":521}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"cb","original":{"line":34,"column":55},"generated":{"line":1,"column":530}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"shake","original":{"line":35,"column":9},"generated":{"line":1,"column":533}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"shake","original":{"line":35,"column":9},"generated":{"line":1,"column":538}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":35,"column":17},"generated":{"line":1,"column":544}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"stream","original":{"line":35,"column":22},"generated":{"line":1,"column":549}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"handshake","original":{"line":35,"column":29},"generated":{"line":1,"column":556}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"pull","original":{"line":37,"column":4},"generated":{"line":1,"column":566}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":37,"column":9},"generated":{"line":1,"column":568}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"stream","original":{"line":37,"column":14},"generated":{"line":1,"column":573}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"conn","original":{"line":37,"column":22},"generated":{"line":1,"column":580}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":37,"column":28},"generated":{"line":1,"column":582}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"stream","original":{"line":37,"column":33},"generated":{"line":1,"column":587}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"isValid","original":{"line":40,"column":2},"generated":{"line":1,"column":595}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":41,"column":11},"generated":{"line":1,"column":605}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":41,"column":11},"generated":{"line":1,"column":612}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"conn","original":{"line":41,"column":16},"generated":{"line":1,"column":617}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":41,"column":24},"generated":{"line":1,"column":623}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"shake","original":{"line":41,"column":29},"generated":{"line":1,"column":628}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":41,"column":38},"generated":{"line":1,"column":635}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"stream","original":{"line":41,"column":43},"generated":{"line":1,"column":640}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"read","original":{"line":50,"column":2},"generated":{"line":1,"column":647}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"cb","original":{"line":50,"column":8},"generated":{"line":1,"column":652}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":51,"column":8},"generated":{"line":1,"column":655}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":51,"column":9},"generated":{"line":1,"column":659}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"isValid","original":{"line":51,"column":14},"generated":{"line":1,"column":664}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"cb","original":{"line":52,"column":13},"generated":{"line":1,"column":674}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"cb","original":{"line":52,"column":13},"generated":{"line":1,"column":681}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":52,"column":16},"generated":{"line":1,"column":683}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"Error","original":{"line":52,"column":20},"generated":{"line":1,"column":687}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":52,"column":26},"generated":{"line":1,"column":693}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"lp","original":{"line":55,"column":4},"generated":{"line":1,"column":729}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"decodeFromReader","original":{"line":55,"column":7},"generated":{"line":1,"column":731}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":56,"column":6},"generated":{"line":1,"column":748}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"shake","original":{"line":56,"column":11},"generated":{"line":1,"column":753}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":57,"column":6},"generated":{"line":1,"column":759}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"maxLength","original":{"line":57,"column":8},"generated":{"line":1,"column":760}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":57,"column":19},"generated":{"line":1,"column":770}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"maxLength","original":{"line":57,"column":24},"generated":{"line":1,"column":775}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":58,"column":6},"generated":{"line":1,"column":786}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"err","original":{"line":58,"column":7},"generated":{"line":1,"column":787}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"msg","original":{"line":58,"column":12},"generated":{"line":1,"column":789}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"err","original":{"line":59,"column":12},"generated":{"line":1,"column":793}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"log","original":{"line":60,"column":10},"generated":{"line":1,"column":796}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"err","original":{"line":60,"column":14},"generated":{"line":1,"column":798}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"err","original":{"line":60,"column":18},"generated":{"line":1,"column":802}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"cb","original":{"line":62,"column":17},"generated":{"line":1,"column":805}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"err","original":{"line":62,"column":20},"generated":{"line":1,"column":807}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"cb","original":{"line":65,"column":15},"generated":{"line":1,"column":811}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":65,"column":18},"generated":{"line":1,"column":813}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"msg","original":{"line":65,"column":24},"generated":{"line":1,"column":818}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"write","original":{"line":76,"column":2},"generated":{"line":1,"column":822}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"msg","original":{"line":76,"column":9},"generated":{"line":1,"column":828}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"cb","original":{"line":76,"column":14},"generated":{"line":1,"column":830}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":79,"column":8},"generated":{"line":1,"column":833}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"cb","original":{"line":77,"column":4},"generated":{"line":1,"column":836}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"cb","original":{"line":77,"column":9},"generated":{"line":1,"column":838}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":77,"column":16},"generated":{"line":1,"column":841}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":79,"column":9},"generated":{"line":1,"column":851}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"isValid","original":{"line":79,"column":14},"generated":{"line":1,"column":856}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"cb","original":{"line":80,"column":13},"generated":{"line":1,"column":866}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"cb","original":{"line":80,"column":13},"generated":{"line":1,"column":873}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":80,"column":16},"generated":{"line":1,"column":875}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"Error","original":{"line":80,"column":20},"generated":{"line":1,"column":879}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":80,"column":26},"generated":{"line":1,"column":885}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"pull","original":{"line":83,"column":4},"generated":{"line":1,"column":921}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"values","original":{"line":84,"column":6},"generated":{"line":1,"column":923}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":84,"column":13},"generated":{"line":1,"column":925}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"msg","original":{"line":84,"column":14},"generated":{"line":1,"column":926}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"lp","original":{"line":85,"column":6},"generated":{"line":1,"column":930}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"encode","original":{"line":85,"column":9},"generated":{"line":1,"column":932}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"collect","original":{"line":86,"column":6},"generated":{"line":1,"column":941}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":86,"column":14},"generated":{"line":1,"column":943}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"err","original":{"line":86,"column":15},"generated":{"line":1,"column":944}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"encoded","original":{"line":86,"column":20},"generated":{"line":1,"column":946}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"err","original":{"line":87,"column":12},"generated":{"line":1,"column":951}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"err","original":{"line":87,"column":12},"generated":{"line":1,"column":954}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"cb","original":{"line":90,"column":17},"generated":{"line":1,"column":956}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"log","original":{"line":88,"column":10},"generated":{"line":1,"column":963}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"err","original":{"line":88,"column":14},"generated":{"line":1,"column":965}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"err","original":{"line":88,"column":18},"generated":{"line":1,"column":969}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"shake","original":{"line":89,"column":15},"generated":{"line":1,"column":972}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"shake","original":{"line":89,"column":15},"generated":{"line":1,"column":977}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"abort","original":{"line":89,"column":21},"generated":{"line":1,"column":983}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"err","original":{"line":89,"column":27},"generated":{"line":1,"column":989}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"cb","original":{"line":90,"column":17},"generated":{"line":1,"column":992}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"err","original":{"line":90,"column":20},"generated":{"line":1,"column":994}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"encoded","original":{"line":93,"column":8},"generated":{"line":1,"column":997}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"forEach","original":{"line":93,"column":16},"generated":{"line":1,"column":999}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"e","original":{"line":93,"column":25},"generated":{"line":1,"column":1007}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":93,"column":31},"generated":{"line":1,"column":1010}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"shake","original":{"line":93,"column":36},"generated":{"line":1,"column":1015}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"write","original":{"line":93,"column":42},"generated":{"line":1,"column":1021}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"e","original":{"line":93,"column":48},"generated":{"line":1,"column":1027}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"cb","original":{"line":94,"column":8},"generated":{"line":1,"column":1031}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"getRawConn","original":{"line":104,"column":2},"generated":{"line":1,"column":1038}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":105,"column":11},"generated":{"line":1,"column":1051}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":105,"column":11},"generated":{"line":1,"column":1058}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"conn","original":{"line":105,"column":16},"generated":{"line":1,"column":1063}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"rest","original":{"line":113,"column":2},"generated":{"line":1,"column":1068}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"rest","original":{"line":114,"column":10},"generated":{"line":1,"column":1075}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"rest","original":{"line":114,"column":10},"generated":{"line":1,"column":1081}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":114,"column":17},"generated":{"line":1,"column":1083}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"shake","original":{"line":114,"column":22},"generated":{"line":1,"column":1088}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"rest","original":{"line":114,"column":28},"generated":{"line":1,"column":1094}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"rest","original":{"line":119,"column":11},"generated":{"line":1,"column":1101}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"conn","original":{"line":116,"column":9},"generated":{"line":1,"column":1108}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"conn","original":{"line":116,"column":9},"generated":{"line":1,"column":1113}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":116,"column":16},"generated":{"line":1,"column":1118}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"stream","original":{"line":117,"column":9},"generated":{"line":1,"column":1123}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"stream","original":{"line":117,"column":9},"generated":{"line":1,"column":1128}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":117,"column":18},"generated":{"line":1,"column":1135}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"shake","original":{"line":118,"column":9},"generated":{"line":1,"column":1140}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"shake","original":{"line":118,"column":9},"generated":{"line":1,"column":1145}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":118,"column":17},"generated":{"line":1,"column":1151}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"rest","original":{"line":119,"column":11},"generated":{"line":1,"column":1156}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"close","original":{"line":127,"column":2},"generated":{"line":1,"column":1158}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":128,"column":9},"generated":{"line":1,"column":1166}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"isValid","original":{"line":128,"column":14},"generated":{"line":1,"column":1171}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"pull","original":{"line":133,"column":4},"generated":{"line":1,"column":1182}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"empty","original":{"line":134,"column":6},"generated":{"line":1,"column":1184}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","original":{"line":135,"column":6},"generated":{"line":1,"column":1188}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"rest","original":{"line":135,"column":11},"generated":{"line":1,"column":1193}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"module","original":{"line":140,"column":0},"generated":{"line":1,"column":1202}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"exports","original":{"line":140,"column":7},"generated":{"line":1,"column":1209}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js","name":"StreamHandler","original":{"line":140,"column":17},"generated":{"line":1,"column":1217}}],"sources":{"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/stream-handler.js":"'use strict'\n\nconst values = require('pull-stream/sources/values')\nconst collect = require('pull-stream/sinks/collect')\nconst empty = require('pull-stream/sources/empty')\nconst pull = require('pull-stream/pull')\nconst lp = require('pull-length-prefixed')\nconst handshake = require('pull-handshake')\n\nconst debug = require('debug')\nconst log = debug('libp2p:circuit:stream-handler')\nlog.err = debug('libp2p:circuit:error:stream-handler')\n\nclass StreamHandler {\n  /**\n   * Create a stream handler for connection\n   *\n   * @param {Connection} conn - connection to read/write\n   * @param {Function|undefined} cb - handshake callback called on error\n   * @param {Number} timeout - handshake timeout\n   * @param {Number} maxLength - max bytes length of message\n   */\n  constructor (conn, cb, timeout, maxLength) {\n    this.conn = conn\n    this.stream = null\n    this.shake = null\n    this.timeout = cb || 1000 * 60\n    this.maxLength = maxLength || 4096\n\n    if (typeof cb === 'function') {\n      this.timeout = timeout || 1000 * 60\n    }\n\n    this.stream = handshake({ timeout: this.timeout }, cb)\n    this.shake = this.stream.handshake\n\n    pull(this.stream, conn, this.stream)\n  }\n\n  isValid () {\n    return this.conn && this.shake && this.stream\n  }\n\n  /**\n   * Read and decode message\n   *\n   * @param {Function} cb\n   * @returns {void|Function}\n   */\n  read (cb) {\n    if (!this.isValid()) {\n      return cb(new Error('handler is not in a valid state'))\n    }\n\n    lp.decodeFromReader(\n      this.shake,\n      { maxLength: this.maxLength },\n      (err, msg) => {\n        if (err) {\n          log.err(err)\n          // this.shake.abort(err)\n          return cb(err)\n        }\n\n        return cb(null, msg)\n      })\n  }\n\n  /**\n   * Encode and write array of buffers\n   *\n   * @param {Buffer[]} msg\n   * @param {Function} [cb]\n   * @returns {Function}\n   */\n  write (msg, cb) {\n    cb = cb || (() => {})\n\n    if (!this.isValid()) {\n      return cb(new Error('handler is not in a valid state'))\n    }\n\n    pull(\n      values([msg]),\n      lp.encode(),\n      collect((err, encoded) => {\n        if (err) {\n          log.err(err)\n          this.shake.abort(err)\n          return cb(err)\n        }\n\n        encoded.forEach((e) => this.shake.write(e))\n        cb()\n      })\n    )\n  }\n\n  /**\n   * Get the raw Connection\n   *\n   * @returns {null|Connection|*}\n   */\n  getRawConn () {\n    return this.conn\n  }\n\n  /**\n   * Return the handshake rest stream and invalidate handler\n   *\n   * @return {*|{source, sink}}\n   */\n  rest () {\n    const rest = this.shake.rest()\n\n    this.conn = null\n    this.stream = null\n    this.shake = null\n    return rest\n  }\n\n  /**\n   * Close the stream\n   *\n   * @returns {undefined}\n   */\n  close () {\n    if (!this.isValid()) {\n      return\n    }\n\n    // close stream\n    pull(\n      empty(),\n      this.rest()\n    )\n  }\n}\n\nmodule.exports = StreamHandler\n"},"lineCount":null}},"error":null,"hash":"221cfbf021f336c6fa1aae9f75ffe132","cacheData":{"env":{}}}