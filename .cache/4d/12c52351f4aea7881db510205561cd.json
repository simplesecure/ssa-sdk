{"id":"kZ1g","dependencies":[{"name":"/Users/polluterofminds/Development/simpleid/ssa-sdk/package.json","includedInParent":true,"mtime":1584306008866},{"name":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-record/package.json","includedInParent":true,"mtime":1582579780694},{"name":"multihashing-async","loc":{"line":3,"column":29},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-record/node_modules/multihashing-async/src/index.js"},{"name":"err-code","loc":{"line":4,"column":24},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-record/node_modules/err-code/index.js"},{"name":"buffer","parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/node-libs-browser/node_modules/buffer/index.js"}],"generated":{"js":"var Buffer = require(\"buffer\").Buffer;\nvar e=require(\"buffer\").Buffer;const i=require(\"multihashing-async\"),r=require(\"err-code\"),R=async(R,_)=>{if(!e.isBuffer(R))throw r('\"key\" must be a Buffer',\"ERR_INVALID_RECORD_KEY_NOT_BUFFER\");if(R.length<5)throw r(\"invalid public key record\",\"ERR_INVALID_RECORD_KEY_TOO_SHORT\");if(\"/pk/\"!==R.slice(0,4).toString())throw r(\"key was not prefixed with /pk/\",\"ERR_INVALID_RECORD_KEY_BAD_PREFIX\");const s=R.slice(4),t=await i(_,\"sha2-256\");if(!s.equals(t))throw r(\"public key does not match passed in key\",\"ERR_INVALID_RECORD_HASH_MISMATCH\")};module.exports={func:R,sign:!1};"},"sourceMaps":{"js":{"mappings":[{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","original":{"line":40,"column":0},"generated":{"line":2,"column":0}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","original":{"line":40,"column":0},"generated":{"line":2,"column":4}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","original":{"line":40,"column":0},"generated":{"line":2,"column":6}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","original":{"line":40,"column":0},"generated":{"line":2,"column":14}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","original":{"line":40,"column":0},"generated":{"line":2,"column":24}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","original":{"line":3,"column":0},"generated":{"line":2,"column":31}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"multihashing","original":{"line":3,"column":6},"generated":{"line":2,"column":37}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"require","original":{"line":3,"column":21},"generated":{"line":2,"column":39}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","original":{"line":3,"column":29},"generated":{"line":2,"column":47}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"errcode","original":{"line":4,"column":6},"generated":{"line":2,"column":69}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"require","original":{"line":4,"column":16},"generated":{"line":2,"column":71}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","original":{"line":4,"column":24},"generated":{"line":2,"column":79}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"validatePublicKeyRecord","original":{"line":16,"column":6},"generated":{"line":2,"column":91}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","original":{"line":16,"column":32},"generated":{"line":2,"column":93}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"key","original":{"line":16,"column":39},"generated":{"line":2,"column":99}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"publicKey","original":{"line":16,"column":44},"generated":{"line":2,"column":101}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","original":{"line":17,"column":6},"generated":{"line":2,"column":106}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"Buffer","original":{"line":17,"column":7},"generated":{"line":2,"column":110}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"isBuffer","original":{"line":17,"column":14},"generated":{"line":2,"column":112}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"key","original":{"line":17,"column":23},"generated":{"line":2,"column":121}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"errcode","original":{"line":18,"column":10},"generated":{"line":2,"column":124}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"errcode","original":{"line":18,"column":10},"generated":{"line":2,"column":130}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","original":{"line":18,"column":18},"generated":{"line":2,"column":132}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","original":{"line":18,"column":44},"generated":{"line":2,"column":157}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"key","original":{"line":21,"column":6},"generated":{"line":2,"column":194}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"key","original":{"line":21,"column":6},"generated":{"line":2,"column":197}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"length","original":{"line":21,"column":10},"generated":{"line":2,"column":199}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","original":{"line":21,"column":19},"generated":{"line":2,"column":206}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"errcode","original":{"line":22,"column":10},"generated":{"line":2,"column":208}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"errcode","original":{"line":22,"column":10},"generated":{"line":2,"column":214}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","original":{"line":22,"column":18},"generated":{"line":2,"column":216}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","original":{"line":22,"column":47},"generated":{"line":2,"column":244}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"prefix","original":{"line":27,"column":6},"generated":{"line":2,"column":280}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","original":{"line":27,"column":17},"generated":{"line":2,"column":283}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"key","original":{"line":25,"column":17},"generated":{"line":2,"column":292}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"slice","original":{"line":25,"column":21},"generated":{"line":2,"column":294}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","original":{"line":25,"column":27},"generated":{"line":2,"column":300}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","original":{"line":25,"column":30},"generated":{"line":2,"column":302}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"toString","original":{"line":25,"column":33},"generated":{"line":2,"column":305}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"errcode","original":{"line":28,"column":10},"generated":{"line":2,"column":316}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"errcode","original":{"line":28,"column":10},"generated":{"line":2,"column":322}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","original":{"line":28,"column":18},"generated":{"line":2,"column":324}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","original":{"line":28,"column":52},"generated":{"line":2,"column":357}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"keyhash","original":{"line":31,"column":8},"generated":{"line":2,"column":394}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"keyhash","original":{"line":31,"column":8},"generated":{"line":2,"column":400}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"key","original":{"line":31,"column":18},"generated":{"line":2,"column":402}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"slice","original":{"line":31,"column":22},"generated":{"line":2,"column":404}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","original":{"line":31,"column":28},"generated":{"line":2,"column":410}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"publicKeyHash","original":{"line":33,"column":8},"generated":{"line":2,"column":413}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"multihashing","original":{"line":33,"column":30},"generated":{"line":2,"column":421}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"publicKey","original":{"line":33,"column":43},"generated":{"line":2,"column":423}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","original":{"line":33,"column":54},"generated":{"line":2,"column":425}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","original":{"line":35,"column":6},"generated":{"line":2,"column":437}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"keyhash","original":{"line":35,"column":7},"generated":{"line":2,"column":441}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"equals","original":{"line":35,"column":15},"generated":{"line":2,"column":443}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"publicKeyHash","original":{"line":35,"column":22},"generated":{"line":2,"column":450}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"errcode","original":{"line":36,"column":10},"generated":{"line":2,"column":453}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"errcode","original":{"line":36,"column":10},"generated":{"line":2,"column":459}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","original":{"line":36,"column":18},"generated":{"line":2,"column":461}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","original":{"line":36,"column":61},"generated":{"line":2,"column":503}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"module","original":{"line":40,"column":0},"generated":{"line":2,"column":540}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"exports","original":{"line":40,"column":7},"generated":{"line":2,"column":547}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","original":{"line":40,"column":17},"generated":{"line":2,"column":555}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"func","original":{"line":41,"column":2},"generated":{"line":2,"column":556}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"validatePublicKeyRecord","original":{"line":41,"column":8},"generated":{"line":2,"column":561}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","name":"sign","original":{"line":42,"column":2},"generated":{"line":2,"column":563}},{"source":"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js","original":{"line":42,"column":8},"generated":{"line":2,"column":569}}],"sources":{"node_modules/ipfs/node_modules/libp2p-record/src/validators/public-key.js":"'use strict'\n\nconst multihashing = require('multihashing-async')\nconst errcode = require('err-code')\n\n/**\n * Validator for publick key records.\n * Verifies that the passed in record value is the PublicKey\n * that matches the passed in key.\n * If validation fails the returned Promise will reject with the error.\n *\n * @param {Buffer} key - A valid key is of the form `'/pk/<keymultihash>'`\n * @param {Buffer} publicKey - The public key to validate against (protobuf encoded).\n * @returns {Promise}\n */\nconst validatePublicKeyRecord = async (key, publicKey) => {\n  if (!Buffer.isBuffer(key)) {\n    throw errcode('\"key\" must be a Buffer', 'ERR_INVALID_RECORD_KEY_NOT_BUFFER')\n  }\n\n  if (key.length < 5) {\n    throw errcode('invalid public key record', 'ERR_INVALID_RECORD_KEY_TOO_SHORT')\n  }\n\n  const prefix = key.slice(0, 4).toString()\n\n  if (prefix !== '/pk/') {\n    throw errcode('key was not prefixed with /pk/', 'ERR_INVALID_RECORD_KEY_BAD_PREFIX')\n  }\n\n  const keyhash = key.slice(4)\n\n  const publicKeyHash = await multihashing(publicKey, 'sha2-256')\n\n  if (!keyhash.equals(publicKeyHash)) {\n    throw errcode('public key does not match passed in key', 'ERR_INVALID_RECORD_HASH_MISMATCH')\n  }\n}\n\nmodule.exports = {\n  func: validatePublicKeyRecord,\n  sign: false\n}\n"},"lineCount":null}},"error":null,"hash":"a5ada385da70fd10fc6d4f51aaf55228","cacheData":{"env":{}}}