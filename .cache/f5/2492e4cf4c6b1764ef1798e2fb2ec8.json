{"id":"PxAj","dependencies":[{"name":"/Users/polluterofminds/Development/simpleid/ssa-sdk/package.json","includedInParent":true,"mtime":1584306008866},{"name":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-keychain/package.json","includedInParent":true,"mtime":1582579780441},{"name":"node-forge/lib/pkcs7","loc":{"line":3,"column":8},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-keychain/node_modules/node-forge/lib/pkcs7.js"},{"name":"node-forge/lib/pbe","loc":{"line":4,"column":8},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-keychain/node_modules/node-forge/lib/pbe.js"},{"name":"node-forge/lib/forge","loc":{"line":5,"column":22},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-keychain/node_modules/node-forge/lib/forge.js"},{"name":"./util","loc":{"line":6,"column":49},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-keychain/src/util.js"},{"name":"err-code","loc":{"line":7,"column":24},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/err-code/index.js"},{"name":"buffer","parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/node-libs-browser/node_modules/buffer/index.js"}],"generated":{"js":"var Buffer = require(\"buffer\").Buffer;\nvar e=require(\"buffer\").Buffer;require(\"node-forge/lib/pkcs7\"),require(\"node-forge/lib/pbe\");const r=require(\"node-forge/lib/forge\"),{certificateForKey:t,findAsync:i}=require(\"./util\"),n=require(\"err-code\");class a{constructor(e){if(!e)throw n(new Error(\"keychain is required\"),\"ERR_KEYCHAIN_REQUIRED\");this.keychain=e}async encrypt(i,a){if(!e.isBuffer(a))throw n(new Error(\"Plain data must be a Buffer\"),\"ERR_INVALID_PARAMS\");const s=await this.keychain.findKeyByName(i),c=await this.keychain._getPrivateKey(i),o=r.pki.decryptRsaPrivateKey(c,this.keychain._()),y=await t(s,o),f=r.pkcs7.createEnvelopedData();f.addRecipient(y),f.content=r.util.createBuffer(a),f.encrypt();const d=r.asn1.toDer(f.toAsn1()).getBytes();return e.from(d,\"binary\")}async decrypt(t){if(!e.isBuffer(t))throw n(new Error(\"CMS data is required\"),\"ERR_INVALID_PARAMS\");let a;try{const e=r.util.createBuffer(t.toString(\"binary\")),i=r.asn1.fromDer(e);a=r.pkcs7.messageFromAsn1(i)}catch(d){throw n(new Error(\"Invalid CMS: \"+d.message),\"ERR_INVALID_CMS\")}const s=a.recipients.filter(e=>e.issuer.find(e=>\"O\"===e.shortName&&\"ipfs\"===e.value)).filter(e=>e.issuer.find(e=>\"CN\"===e.shortName)).map(e=>({recipient:e,keyId:e.issuer.find(e=>\"CN\"===e.shortName).value})),c=await i(s,async e=>{try{if(await this.keychain.findKeyById(e.keyId))return!0}catch(d){return!1}return!1});if(!c){const e=s.map(e=>e.keyId);throw n(new Error(\"Decryption needs one of the key(s): \"+e.join(\", \")),\"ERR_MISSING_KEYS\",{missingKeys:e})}const o=await this.keychain.findKeyById(c.keyId),y=await this.keychain._getPrivateKey(o.name),f=r.pki.decryptRsaPrivateKey(y,this.keychain._());return a.decrypt(c.recipient,f),e.from(a.content.getBytes(),\"binary\")}}module.exports=a;"},"sourceMaps":{"js":{"mappings":[{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":122,"column":0},"generated":{"line":2,"column":0}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":122,"column":0},"generated":{"line":2,"column":4}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":122,"column":0},"generated":{"line":2,"column":6}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":122,"column":0},"generated":{"line":2,"column":14}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":122,"column":0},"generated":{"line":2,"column":24}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"require","original":{"line":3,"column":0},"generated":{"line":2,"column":31}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":3,"column":8},"generated":{"line":2,"column":39}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"require","original":{"line":4,"column":0},"generated":{"line":2,"column":63}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":4,"column":8},"generated":{"line":2,"column":71}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":5,"column":0},"generated":{"line":2,"column":93}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"forge","original":{"line":5,"column":6},"generated":{"line":2,"column":99}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"require","original":{"line":5,"column":14},"generated":{"line":2,"column":101}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":5,"column":22},"generated":{"line":2,"column":109}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":6,"column":6},"generated":{"line":2,"column":134}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"certificateForKey","original":{"line":6,"column":8},"generated":{"line":2,"column":152}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":6,"column":6},"generated":{"line":2,"column":154}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"findAsync","original":{"line":6,"column":27},"generated":{"line":2,"column":164}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"require","original":{"line":6,"column":41},"generated":{"line":2,"column":167}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":6,"column":49},"generated":{"line":2,"column":175}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"errcode","original":{"line":7,"column":6},"generated":{"line":2,"column":185}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"require","original":{"line":7,"column":16},"generated":{"line":2,"column":187}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":7,"column":24},"generated":{"line":2,"column":195}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":18,"column":0},"generated":{"line":2,"column":207}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"CMS","original":{"line":18,"column":6},"generated":{"line":2,"column":213}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"constructor","original":{"line":24,"column":2},"generated":{"line":2,"column":215}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"keychain","original":{"line":24,"column":15},"generated":{"line":2,"column":227}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":25,"column":8},"generated":{"line":2,"column":230}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"keychain","original":{"line":25,"column":9},"generated":{"line":2,"column":234}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"errcode","original":{"line":26,"column":12},"generated":{"line":2,"column":236}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"errcode","original":{"line":26,"column":12},"generated":{"line":2,"column":242}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":26,"column":20},"generated":{"line":2,"column":244}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"Error","original":{"line":26,"column":24},"generated":{"line":2,"column":248}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":26,"column":30},"generated":{"line":2,"column":254}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":26,"column":55},"generated":{"line":2,"column":278}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"keychain","original":{"line":29,"column":9},"generated":{"line":2,"column":303}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"keychain","original":{"line":29,"column":9},"generated":{"line":2,"column":308}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"keychain","original":{"line":29,"column":20},"generated":{"line":2,"column":317}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"encrypt","original":{"line":41,"column":8},"generated":{"line":2,"column":319}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"name","original":{"line":41,"column":17},"generated":{"line":2,"column":333}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"plain","original":{"line":41,"column":23},"generated":{"line":2,"column":335}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":42,"column":8},"generated":{"line":2,"column":338}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"Buffer","original":{"line":42,"column":9},"generated":{"line":2,"column":342}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"isBuffer","original":{"line":42,"column":16},"generated":{"line":2,"column":344}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"plain","original":{"line":42,"column":25},"generated":{"line":2,"column":353}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"errcode","original":{"line":43,"column":12},"generated":{"line":2,"column":356}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"errcode","original":{"line":43,"column":12},"generated":{"line":2,"column":362}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":43,"column":20},"generated":{"line":2,"column":364}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"Error","original":{"line":43,"column":24},"generated":{"line":2,"column":368}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":43,"column":30},"generated":{"line":2,"column":374}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":43,"column":62},"generated":{"line":2,"column":405}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"key","original":{"line":46,"column":10},"generated":{"line":2,"column":427}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"key","original":{"line":46,"column":10},"generated":{"line":2,"column":433}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":46,"column":22},"generated":{"line":2,"column":441}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"keychain","original":{"line":46,"column":27},"generated":{"line":2,"column":446}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"findKeyByName","original":{"line":46,"column":36},"generated":{"line":2,"column":455}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"name","original":{"line":46,"column":50},"generated":{"line":2,"column":469}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"pem","original":{"line":47,"column":10},"generated":{"line":2,"column":472}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":47,"column":22},"generated":{"line":2,"column":480}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"keychain","original":{"line":47,"column":27},"generated":{"line":2,"column":485}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"_getPrivateKey","original":{"line":47,"column":36},"generated":{"line":2,"column":494}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"name","original":{"line":47,"column":51},"generated":{"line":2,"column":509}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"privateKey","original":{"line":48,"column":10},"generated":{"line":2,"column":512}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"forge","original":{"line":48,"column":23},"generated":{"line":2,"column":514}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"pki","original":{"line":48,"column":29},"generated":{"line":2,"column":516}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"decryptRsaPrivateKey","original":{"line":48,"column":33},"generated":{"line":2,"column":520}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"pem","original":{"line":48,"column":54},"generated":{"line":2,"column":541}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":48,"column":59},"generated":{"line":2,"column":543}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"keychain","original":{"line":48,"column":64},"generated":{"line":2,"column":548}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"_","original":{"line":48,"column":73},"generated":{"line":2,"column":557}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"certificate","original":{"line":49,"column":10},"generated":{"line":2,"column":562}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"certificateForKey","original":{"line":49,"column":30},"generated":{"line":2,"column":570}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"key","original":{"line":49,"column":48},"generated":{"line":2,"column":572}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"privateKey","original":{"line":49,"column":53},"generated":{"line":2,"column":574}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"p7","original":{"line":52,"column":10},"generated":{"line":2,"column":577}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"forge","original":{"line":52,"column":15},"generated":{"line":2,"column":579}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"pkcs7","original":{"line":52,"column":21},"generated":{"line":2,"column":581}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"createEnvelopedData","original":{"line":52,"column":27},"generated":{"line":2,"column":587}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"p7","original":{"line":53,"column":4},"generated":{"line":2,"column":609}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"addRecipient","original":{"line":53,"column":7},"generated":{"line":2,"column":611}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"certificate","original":{"line":53,"column":20},"generated":{"line":2,"column":624}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"p7","original":{"line":54,"column":4},"generated":{"line":2,"column":627}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"content","original":{"line":54,"column":7},"generated":{"line":2,"column":629}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"forge","original":{"line":54,"column":17},"generated":{"line":2,"column":637}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"util","original":{"line":54,"column":23},"generated":{"line":2,"column":639}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"createBuffer","original":{"line":54,"column":28},"generated":{"line":2,"column":644}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"plain","original":{"line":54,"column":41},"generated":{"line":2,"column":657}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"p7","original":{"line":55,"column":4},"generated":{"line":2,"column":660}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"encrypt","original":{"line":55,"column":7},"generated":{"line":2,"column":662}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"der","original":{"line":58,"column":10},"generated":{"line":2,"column":672}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"der","original":{"line":58,"column":10},"generated":{"line":2,"column":678}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"forge","original":{"line":58,"column":16},"generated":{"line":2,"column":680}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"asn1","original":{"line":58,"column":22},"generated":{"line":2,"column":682}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"toDer","original":{"line":58,"column":27},"generated":{"line":2,"column":687}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"p7","original":{"line":58,"column":33},"generated":{"line":2,"column":693}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"toAsn1","original":{"line":58,"column":36},"generated":{"line":2,"column":695}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"getBytes","original":{"line":58,"column":46},"generated":{"line":2,"column":705}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"Buffer","original":{"line":59,"column":11},"generated":{"line":2,"column":716}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"Buffer","original":{"line":59,"column":11},"generated":{"line":2,"column":723}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"from","original":{"line":59,"column":18},"generated":{"line":2,"column":725}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"der","original":{"line":59,"column":23},"generated":{"line":2,"column":730}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":59,"column":28},"generated":{"line":2,"column":732}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"decrypt","original":{"line":71,"column":8},"generated":{"line":2,"column":742}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"cmsData","original":{"line":71,"column":17},"generated":{"line":2,"column":756}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":72,"column":8},"generated":{"line":2,"column":759}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"Buffer","original":{"line":72,"column":9},"generated":{"line":2,"column":763}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"isBuffer","original":{"line":72,"column":16},"generated":{"line":2,"column":765}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"cmsData","original":{"line":72,"column":25},"generated":{"line":2,"column":774}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"errcode","original":{"line":73,"column":12},"generated":{"line":2,"column":777}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"errcode","original":{"line":73,"column":12},"generated":{"line":2,"column":783}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":73,"column":20},"generated":{"line":2,"column":785}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"Error","original":{"line":73,"column":24},"generated":{"line":2,"column":789}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":73,"column":30},"generated":{"line":2,"column":795}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":73,"column":55},"generated":{"line":2,"column":819}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"cms","original":{"line":76,"column":8},"generated":{"line":2,"column":841}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"cms","original":{"line":76,"column":8},"generated":{"line":2,"column":845}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":77,"column":8},"generated":{"line":2,"column":847}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"buf","original":{"line":78,"column":12},"generated":{"line":2,"column":851}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"buf","original":{"line":78,"column":12},"generated":{"line":2,"column":857}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"forge","original":{"line":78,"column":18},"generated":{"line":2,"column":859}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"util","original":{"line":78,"column":24},"generated":{"line":2,"column":861}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"createBuffer","original":{"line":78,"column":29},"generated":{"line":2,"column":866}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"cmsData","original":{"line":78,"column":42},"generated":{"line":2,"column":879}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"toString","original":{"line":78,"column":50},"generated":{"line":2,"column":881}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":78,"column":59},"generated":{"line":2,"column":890}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"obj","original":{"line":79,"column":12},"generated":{"line":2,"column":901}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"forge","original":{"line":79,"column":18},"generated":{"line":2,"column":903}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"asn1","original":{"line":79,"column":24},"generated":{"line":2,"column":905}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"fromDer","original":{"line":79,"column":29},"generated":{"line":2,"column":910}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"buf","original":{"line":79,"column":37},"generated":{"line":2,"column":918}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"cms","original":{"line":80,"column":6},"generated":{"line":2,"column":921}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"forge","original":{"line":80,"column":12},"generated":{"line":2,"column":923}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"pkcs7","original":{"line":80,"column":18},"generated":{"line":2,"column":925}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"messageFromAsn1","original":{"line":80,"column":24},"generated":{"line":2,"column":931}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"obj","original":{"line":80,"column":40},"generated":{"line":2,"column":947}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":81,"column":6},"generated":{"line":2,"column":950}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"err","original":{"line":81,"column":13},"generated":{"line":2,"column":956}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"errcode","original":{"line":82,"column":12},"generated":{"line":2,"column":959}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"errcode","original":{"line":82,"column":12},"generated":{"line":2,"column":965}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":82,"column":20},"generated":{"line":2,"column":967}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"Error","original":{"line":82,"column":24},"generated":{"line":2,"column":971}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":82,"column":30},"generated":{"line":2,"column":977}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"err","original":{"line":82,"column":48},"generated":{"line":2,"column":993}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"message","original":{"line":82,"column":52},"generated":{"line":2,"column":995}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":82,"column":62},"generated":{"line":2,"column":1004}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"recipients","original":{"line":87,"column":10},"generated":{"line":2,"column":1023}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"recipients","original":{"line":87,"column":10},"generated":{"line":2,"column":1029}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"cms","original":{"line":87,"column":23},"generated":{"line":2,"column":1031}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"recipients","original":{"line":87,"column":27},"generated":{"line":2,"column":1033}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"filter","original":{"line":88,"column":7},"generated":{"line":2,"column":1044}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"r","original":{"line":88,"column":14},"generated":{"line":2,"column":1051}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"r","original":{"line":88,"column":19},"generated":{"line":2,"column":1054}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"issuer","original":{"line":88,"column":21},"generated":{"line":2,"column":1056}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"find","original":{"line":88,"column":28},"generated":{"line":2,"column":1063}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"a","original":{"line":88,"column":33},"generated":{"line":2,"column":1068}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":88,"column":54},"generated":{"line":2,"column":1071}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"a","original":{"line":88,"column":38},"generated":{"line":2,"column":1077}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"shortName","original":{"line":88,"column":40},"generated":{"line":2,"column":1079}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":88,"column":73},"generated":{"line":2,"column":1090}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"a","original":{"line":88,"column":61},"generated":{"line":2,"column":1099}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"value","original":{"line":88,"column":63},"generated":{"line":2,"column":1101}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"filter","original":{"line":89,"column":7},"generated":{"line":2,"column":1109}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"r","original":{"line":89,"column":14},"generated":{"line":2,"column":1116}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"r","original":{"line":89,"column":19},"generated":{"line":2,"column":1119}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"issuer","original":{"line":89,"column":21},"generated":{"line":2,"column":1121}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"find","original":{"line":89,"column":28},"generated":{"line":2,"column":1128}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"a","original":{"line":89,"column":33},"generated":{"line":2,"column":1133}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":89,"column":54},"generated":{"line":2,"column":1136}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"a","original":{"line":89,"column":38},"generated":{"line":2,"column":1143}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"shortName","original":{"line":89,"column":40},"generated":{"line":2,"column":1145}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"map","original":{"line":90,"column":7},"generated":{"line":2,"column":1157}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"r","original":{"line":90,"column":11},"generated":{"line":2,"column":1161}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":91,"column":15},"generated":{"line":2,"column":1165}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"recipient","original":{"line":92,"column":10},"generated":{"line":2,"column":1166}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"r","original":{"line":92,"column":21},"generated":{"line":2,"column":1176}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"keyId","original":{"line":93,"column":10},"generated":{"line":2,"column":1178}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"r","original":{"line":93,"column":17},"generated":{"line":2,"column":1184}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"issuer","original":{"line":93,"column":19},"generated":{"line":2,"column":1186}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"find","original":{"line":93,"column":26},"generated":{"line":2,"column":1193}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"a","original":{"line":93,"column":31},"generated":{"line":2,"column":1198}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":93,"column":52},"generated":{"line":2,"column":1201}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"a","original":{"line":93,"column":36},"generated":{"line":2,"column":1208}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"shortName","original":{"line":93,"column":38},"generated":{"line":2,"column":1210}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"value","original":{"line":93,"column":58},"generated":{"line":2,"column":1221}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"r","original":{"line":97,"column":10},"generated":{"line":2,"column":1230}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"findAsync","original":{"line":97,"column":20},"generated":{"line":2,"column":1238}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"recipients","original":{"line":97,"column":30},"generated":{"line":2,"column":1240}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":97,"column":42},"generated":{"line":2,"column":1242}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":97,"column":42},"generated":{"line":2,"column":1248}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":98,"column":10},"generated":{"line":2,"column":1252}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"key","original":{"line":100,"column":12},"generated":{"line":2,"column":1256}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":99,"column":26},"generated":{"line":2,"column":1265}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"keychain","original":{"line":99,"column":31},"generated":{"line":2,"column":1270}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"findKeyById","original":{"line":99,"column":40},"generated":{"line":2,"column":1279}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"recipient","original":{"line":99,"column":52},"generated":{"line":2,"column":1291}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"keyId","original":{"line":99,"column":62},"generated":{"line":2,"column":1293}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":100,"column":17},"generated":{"line":2,"column":1300}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":100,"column":24},"generated":{"line":2,"column":1307}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":101,"column":8},"generated":{"line":2,"column":1309}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"err","original":{"line":101,"column":15},"generated":{"line":2,"column":1315}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":102,"column":15},"generated":{"line":2,"column":1318}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":102,"column":15},"generated":{"line":2,"column":1325}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":104,"column":13},"generated":{"line":2,"column":1327}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":104,"column":13},"generated":{"line":2,"column":1334}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":107,"column":8},"generated":{"line":2,"column":1338}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"r","original":{"line":107,"column":9},"generated":{"line":2,"column":1342}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":107,"column":12},"generated":{"line":2,"column":1344}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"missingKeys","original":{"line":108,"column":12},"generated":{"line":2,"column":1345}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"missingKeys","original":{"line":108,"column":12},"generated":{"line":2,"column":1351}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"recipients","original":{"line":108,"column":26},"generated":{"line":2,"column":1353}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"map","original":{"line":108,"column":37},"generated":{"line":2,"column":1355}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"r","original":{"line":108,"column":41},"generated":{"line":2,"column":1359}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"r","original":{"line":108,"column":46},"generated":{"line":2,"column":1362}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"keyId","original":{"line":108,"column":48},"generated":{"line":2,"column":1364}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"errcode","original":{"line":109,"column":12},"generated":{"line":2,"column":1371}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"errcode","original":{"line":109,"column":12},"generated":{"line":2,"column":1377}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":109,"column":20},"generated":{"line":2,"column":1379}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"Error","original":{"line":109,"column":24},"generated":{"line":2,"column":1383}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":109,"column":30},"generated":{"line":2,"column":1389}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"missingKeys","original":{"line":109,"column":71},"generated":{"line":2,"column":1428}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"join","original":{"line":109,"column":83},"generated":{"line":2,"column":1430}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":109,"column":88},"generated":{"line":2,"column":1435}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":109,"column":96},"generated":{"line":2,"column":1442}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":109,"column":116},"generated":{"line":2,"column":1461}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"missingKeys","original":{"line":110,"column":8},"generated":{"line":2,"column":1462}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"missingKeys","original":{"line":110,"column":8},"generated":{"line":2,"column":1474}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"key","original":{"line":114,"column":10},"generated":{"line":2,"column":1478}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"key","original":{"line":114,"column":10},"generated":{"line":2,"column":1484}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":114,"column":22},"generated":{"line":2,"column":1492}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"keychain","original":{"line":114,"column":27},"generated":{"line":2,"column":1497}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"findKeyById","original":{"line":114,"column":36},"generated":{"line":2,"column":1506}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"r","original":{"line":114,"column":48},"generated":{"line":2,"column":1518}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"keyId","original":{"line":114,"column":50},"generated":{"line":2,"column":1520}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"pem","original":{"line":115,"column":10},"generated":{"line":2,"column":1527}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":115,"column":22},"generated":{"line":2,"column":1535}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"keychain","original":{"line":115,"column":27},"generated":{"line":2,"column":1540}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"_getPrivateKey","original":{"line":115,"column":36},"generated":{"line":2,"column":1549}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"key","original":{"line":115,"column":51},"generated":{"line":2,"column":1564}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"name","original":{"line":115,"column":55},"generated":{"line":2,"column":1566}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"privateKey","original":{"line":116,"column":10},"generated":{"line":2,"column":1572}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"forge","original":{"line":116,"column":23},"generated":{"line":2,"column":1574}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"pki","original":{"line":116,"column":29},"generated":{"line":2,"column":1576}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"decryptRsaPrivateKey","original":{"line":116,"column":33},"generated":{"line":2,"column":1580}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"pem","original":{"line":116,"column":54},"generated":{"line":2,"column":1601}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":116,"column":59},"generated":{"line":2,"column":1603}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"keychain","original":{"line":116,"column":64},"generated":{"line":2,"column":1608}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"_","original":{"line":116,"column":73},"generated":{"line":2,"column":1617}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"Buffer","original":{"line":118,"column":11},"generated":{"line":2,"column":1622}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"cms","original":{"line":117,"column":4},"generated":{"line":2,"column":1629}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"decrypt","original":{"line":117,"column":8},"generated":{"line":2,"column":1631}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"r","original":{"line":117,"column":16},"generated":{"line":2,"column":1639}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"recipient","original":{"line":117,"column":18},"generated":{"line":2,"column":1641}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"privateKey","original":{"line":117,"column":29},"generated":{"line":2,"column":1651}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"Buffer","original":{"line":118,"column":11},"generated":{"line":2,"column":1654}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"from","original":{"line":118,"column":18},"generated":{"line":2,"column":1656}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"cms","original":{"line":118,"column":23},"generated":{"line":2,"column":1661}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"content","original":{"line":118,"column":27},"generated":{"line":2,"column":1663}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"getBytes","original":{"line":118,"column":35},"generated":{"line":2,"column":1671}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","original":{"line":118,"column":47},"generated":{"line":2,"column":1682}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"module","original":{"line":122,"column":0},"generated":{"line":2,"column":1693}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"exports","original":{"line":122,"column":7},"generated":{"line":2,"column":1700}},{"source":"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js","name":"CMS","original":{"line":122,"column":17},"generated":{"line":2,"column":1708}}],"sources":{"node_modules/ipfs/node_modules/libp2p-keychain/src/cms.js":"'use strict'\n\nrequire('node-forge/lib/pkcs7')\nrequire('node-forge/lib/pbe')\nconst forge = require('node-forge/lib/forge')\nconst { certificateForKey, findAsync } = require('./util')\nconst errcode = require('err-code')\n\n/**\n * Cryptographic Message Syntax (aka PKCS #7)\n *\n * CMS describes an encapsulation syntax for data protection. It\n * is used to digitally sign, digest, authenticate, or encrypt\n * arbitrary message content.\n *\n * See RFC 5652 for all the details.\n */\nclass CMS {\n  /**\n   * Creates a new instance with a keychain\n   *\n   * @param {Keychain} keychain - the available keys\n   */\n  constructor (keychain) {\n    if (!keychain) {\n      throw errcode(new Error('keychain is required'), 'ERR_KEYCHAIN_REQUIRED')\n    }\n\n    this.keychain = keychain\n  }\n\n  /**\n   * Creates some protected data.\n   *\n   * The output Buffer contains the PKCS #7 message in DER.\n   *\n   * @param {string} name - The local key name.\n   * @param {Buffer} plain - The data to encrypt.\n   * @returns {undefined}\n   */\n  async encrypt (name, plain) {\n    if (!Buffer.isBuffer(plain)) {\n      throw errcode(new Error('Plain data must be a Buffer'), 'ERR_INVALID_PARAMS')\n    }\n\n    const key = await this.keychain.findKeyByName(name)\n    const pem = await this.keychain._getPrivateKey(name)\n    const privateKey = forge.pki.decryptRsaPrivateKey(pem, this.keychain._())\n    const certificate = await certificateForKey(key, privateKey)\n\n    // create a p7 enveloped message\n    const p7 = forge.pkcs7.createEnvelopedData()\n    p7.addRecipient(certificate)\n    p7.content = forge.util.createBuffer(plain)\n    p7.encrypt()\n\n    // convert message to DER\n    const der = forge.asn1.toDer(p7.toAsn1()).getBytes()\n    return Buffer.from(der, 'binary')\n  }\n\n  /**\n   * Reads some protected data.\n   *\n   * The keychain must contain one of the keys used to encrypt the data.  If none of the keys\n   * exists, an Error is returned with the property 'missingKeys'.  It is array of key ids.\n   *\n   * @param {Buffer} cmsData - The CMS encrypted data to decrypt.\n   * @returns {undefined}\n   */\n  async decrypt (cmsData) {\n    if (!Buffer.isBuffer(cmsData)) {\n      throw errcode(new Error('CMS data is required'), 'ERR_INVALID_PARAMS')\n    }\n\n    let cms\n    try {\n      const buf = forge.util.createBuffer(cmsData.toString('binary'))\n      const obj = forge.asn1.fromDer(buf)\n      cms = forge.pkcs7.messageFromAsn1(obj)\n    } catch (err) {\n      throw errcode(new Error('Invalid CMS: ' + err.message), 'ERR_INVALID_CMS')\n    }\n\n    // Find a recipient whose key we hold. We only deal with recipient certs\n    // issued by ipfs (O=ipfs).\n    const recipients = cms.recipients\n      .filter(r => r.issuer.find(a => a.shortName === 'O' && a.value === 'ipfs'))\n      .filter(r => r.issuer.find(a => a.shortName === 'CN'))\n      .map(r => {\n        return {\n          recipient: r,\n          keyId: r.issuer.find(a => a.shortName === 'CN').value\n        }\n      })\n\n    const r = await findAsync(recipients, async (recipient) => {\n      try {\n        const key = await this.keychain.findKeyById(recipient.keyId)\n        if (key) return true\n      } catch (err) {\n        return false\n      }\n      return false\n    })\n\n    if (!r) {\n      const missingKeys = recipients.map(r => r.keyId)\n      throw errcode(new Error('Decryption needs one of the key(s): ' + missingKeys.join(', ')), 'ERR_MISSING_KEYS', {\n        missingKeys\n      })\n    }\n\n    const key = await this.keychain.findKeyById(r.keyId)\n    const pem = await this.keychain._getPrivateKey(key.name)\n    const privateKey = forge.pki.decryptRsaPrivateKey(pem, this.keychain._())\n    cms.decrypt(r.recipient, privateKey)\n    return Buffer.from(cms.content.getBytes(), 'binary')\n  }\n}\n\nmodule.exports = CMS\n"},"lineCount":null}},"error":null,"hash":"4b02c3baaa7117c0cb9c3f20c216f769","cacheData":{"env":{}}}