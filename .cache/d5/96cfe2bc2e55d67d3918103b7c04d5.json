{"id":"bTXA","dependencies":[{"name":"/Users/polluterofminds/Development/simpleid/ssa-sdk/package.json","includedInParent":true,"mtime":1584306008866},{"name":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/multistream-select/package.json","includedInParent":true,"mtime":1582579780190},{"name":"varint","loc":{"line":3,"column":23},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/varint/index.js"},{"name":"pull-stream/pull","loc":{"line":4,"column":21},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/pull-stream/pull.js"},{"name":"pull-stream/throughs/map","loc":{"line":5,"column":20},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/pull-stream/throughs/map.js"},{"name":"pull-stream/sinks/collect","loc":{"line":6,"column":24},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/pull-stream/sinks/collect.js"},{"name":"pull-stream/throughs/take","loc":{"line":7,"column":21},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/pull-stream/throughs/take.js"},{"name":"pull-length-prefixed","loc":{"line":8,"column":23},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/pull-length-prefixed/src/index.js"},{"name":"interface-connection","loc":{"line":9,"column":27},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/interface-connection/src/index.js"},{"name":"../util","loc":{"line":10,"column":21},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/multistream-select/src/util.js"},{"name":"../select","loc":{"line":11,"column":23},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/multistream-select/src/select.js"},{"name":"once","loc":{"line":12,"column":21},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/once/once.js"},{"name":"./../constants","loc":{"line":14,"column":28},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/multistream-select/src/constants.js"}],"generated":{"js":"\"use strict\";const e=require(\"varint\"),n=require(\"pull-stream/pull\"),t=require(\"pull-stream/throughs/map\"),r=require(\"pull-stream/sinks/collect\"),i=require(\"pull-stream/throughs/take\"),s=require(\"pull-length-prefixed\"),l=require(\"interface-connection\").Connection,o=require(\"../util\"),c=require(\"../select\"),u=require(\"once\"),h=require(\"./../constants\").PROTOCOL_ID;class a{constructor(){this.conn=null,this.log=o.log.dialer()}handle(e,t){this.log(\"dialer handle conn\"),t=u(t);const r=c(h,(n,r)=>{if(n)return t(n);this.log(\"handshake success\"),this.conn=new l(r,e),t()},this.log);try{n(e,r,e)}catch(i){this.log.error(i),t(i)}}select(e,t){if(this.log(\"dialer select \"+e),t=u(t),!this.conn)return t(new Error(\"multistream handshake has not finalized yet\"));const r=c(e,(e,n)=>{if(e)return this.conn=new l(n,this.conn),t(e);t(null,new l(n,this.conn))},this.log);n(this.conn,r,this.conn)}ls(e){e=u(e);const i=c(\"ls\",(i,l)=>{if(i)return e(i);n(l,s.decode(),g(l),t(d),r((n,t)=>{if(n)return e(n);e(null,t.slice(1))}))},this.log);n(this.conn,i,this.conn)}}function d(e){return e.toString().slice(0,-1)}function g(n){let t=0;return i(n=>(e.decode(n),t=e.decode(n,e.decode.bytes),!0))}module.exports=a;"},"sourceMaps":{"js":{"mappings":[{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":1,"column":0},"generated":{"line":1,"column":0}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":3,"column":0},"generated":{"line":1,"column":13}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"varint","original":{"line":3,"column":6},"generated":{"line":1,"column":19}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"require","original":{"line":3,"column":15},"generated":{"line":1,"column":21}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":3,"column":23},"generated":{"line":1,"column":29}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"pull","original":{"line":4,"column":6},"generated":{"line":1,"column":39}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"require","original":{"line":4,"column":13},"generated":{"line":1,"column":41}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":4,"column":21},"generated":{"line":1,"column":49}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"map","original":{"line":5,"column":6},"generated":{"line":1,"column":69}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"require","original":{"line":5,"column":12},"generated":{"line":1,"column":71}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":5,"column":20},"generated":{"line":1,"column":79}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"collect","original":{"line":6,"column":6},"generated":{"line":1,"column":107}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"require","original":{"line":6,"column":16},"generated":{"line":1,"column":109}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":6,"column":24},"generated":{"line":1,"column":117}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"take","original":{"line":7,"column":6},"generated":{"line":1,"column":146}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"require","original":{"line":7,"column":13},"generated":{"line":1,"column":148}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":7,"column":21},"generated":{"line":1,"column":156}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"pullLP","original":{"line":8,"column":6},"generated":{"line":1,"column":185}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"require","original":{"line":8,"column":15},"generated":{"line":1,"column":187}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":8,"column":23},"generated":{"line":1,"column":195}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"Connection","original":{"line":9,"column":6},"generated":{"line":1,"column":219}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"require","original":{"line":9,"column":19},"generated":{"line":1,"column":221}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":9,"column":27},"generated":{"line":1,"column":229}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"Connection","original":{"line":9,"column":51},"generated":{"line":1,"column":253}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"util","original":{"line":10,"column":6},"generated":{"line":1,"column":264}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"require","original":{"line":10,"column":13},"generated":{"line":1,"column":266}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":10,"column":21},"generated":{"line":1,"column":274}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"select","original":{"line":11,"column":6},"generated":{"line":1,"column":285}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"require","original":{"line":11,"column":15},"generated":{"line":1,"column":287}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":11,"column":23},"generated":{"line":1,"column":295}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"once","original":{"line":12,"column":6},"generated":{"line":1,"column":308}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"require","original":{"line":12,"column":13},"generated":{"line":1,"column":310}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":12,"column":21},"generated":{"line":1,"column":318}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"PROTOCOL_ID","original":{"line":14,"column":6},"generated":{"line":1,"column":326}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"require","original":{"line":14,"column":20},"generated":{"line":1,"column":328}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":14,"column":28},"generated":{"line":1,"column":336}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"PROTOCOL_ID","original":{"line":14,"column":46},"generated":{"line":1,"column":354}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":19,"column":0},"generated":{"line":1,"column":366}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"Dialer","original":{"line":19,"column":6},"generated":{"line":1,"column":372}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"constructor","original":{"line":23,"column":2},"generated":{"line":1,"column":374}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"conn","original":{"line":24,"column":9},"generated":{"line":1,"column":388}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"conn","original":{"line":24,"column":9},"generated":{"line":1,"column":393}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":24,"column":16},"generated":{"line":1,"column":398}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"log","original":{"line":25,"column":9},"generated":{"line":1,"column":403}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"log","original":{"line":25,"column":9},"generated":{"line":1,"column":408}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"util","original":{"line":25,"column":15},"generated":{"line":1,"column":412}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"log","original":{"line":25,"column":20},"generated":{"line":1,"column":414}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"dialer","original":{"line":25,"column":24},"generated":{"line":1,"column":418}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"handle","original":{"line":36,"column":2},"generated":{"line":1,"column":427}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"rawConn","original":{"line":36,"column":10},"generated":{"line":1,"column":434}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"callback","original":{"line":36,"column":19},"generated":{"line":1,"column":436}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"log","original":{"line":37,"column":9},"generated":{"line":1,"column":439}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"log","original":{"line":37,"column":9},"generated":{"line":1,"column":444}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":37,"column":13},"generated":{"line":1,"column":448}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"callback","original":{"line":38,"column":4},"generated":{"line":1,"column":470}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"once","original":{"line":38,"column":15},"generated":{"line":1,"column":472}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"callback","original":{"line":38,"column":20},"generated":{"line":1,"column":474}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"s","original":{"line":39,"column":10},"generated":{"line":1,"column":477}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"s","original":{"line":39,"column":10},"generated":{"line":1,"column":483}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"select","original":{"line":39,"column":14},"generated":{"line":1,"column":485}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"PROTOCOL_ID","original":{"line":39,"column":21},"generated":{"line":1,"column":487}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":39,"column":34},"generated":{"line":1,"column":489}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"err","original":{"line":39,"column":35},"generated":{"line":1,"column":490}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"conn","original":{"line":39,"column":40},"generated":{"line":1,"column":492}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"err","original":{"line":40,"column":10},"generated":{"line":1,"column":497}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"err","original":{"line":40,"column":10},"generated":{"line":1,"column":500}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"callback","original":{"line":41,"column":15},"generated":{"line":1,"column":502}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"callback","original":{"line":41,"column":15},"generated":{"line":1,"column":509}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"err","original":{"line":41,"column":24},"generated":{"line":1,"column":511}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"log","original":{"line":43,"column":11},"generated":{"line":1,"column":514}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"log","original":{"line":43,"column":11},"generated":{"line":1,"column":519}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":43,"column":15},"generated":{"line":1,"column":523}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"conn","original":{"line":45,"column":11},"generated":{"line":1,"column":544}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"conn","original":{"line":45,"column":11},"generated":{"line":1,"column":549}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":45,"column":18},"generated":{"line":1,"column":554}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"Connection","original":{"line":45,"column":22},"generated":{"line":1,"column":558}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"conn","original":{"line":45,"column":33},"generated":{"line":1,"column":560}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"rawConn","original":{"line":45,"column":39},"generated":{"line":1,"column":562}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"callback","original":{"line":47,"column":6},"generated":{"line":1,"column":565}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":48,"column":7},"generated":{"line":1,"column":570}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"log","original":{"line":48,"column":12},"generated":{"line":1,"column":575}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":51,"column":8},"generated":{"line":1,"column":580}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"pull","original":{"line":52,"column":6},"generated":{"line":1,"column":584}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"rawConn","original":{"line":53,"column":8},"generated":{"line":1,"column":586}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"s","original":{"line":54,"column":8},"generated":{"line":1,"column":588}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"rawConn","original":{"line":55,"column":8},"generated":{"line":1,"column":590}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":57,"column":6},"generated":{"line":1,"column":593}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"err","original":{"line":57,"column":13},"generated":{"line":1,"column":599}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"log","original":{"line":58,"column":11},"generated":{"line":1,"column":602}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"log","original":{"line":58,"column":11},"generated":{"line":1,"column":607}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"error","original":{"line":58,"column":15},"generated":{"line":1,"column":611}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"err","original":{"line":58,"column":21},"generated":{"line":1,"column":617}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"callback","original":{"line":59,"column":6},"generated":{"line":1,"column":620}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"err","original":{"line":59,"column":15},"generated":{"line":1,"column":622}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"select","original":{"line":75,"column":2},"generated":{"line":1,"column":626}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"protocol","original":{"line":75,"column":10},"generated":{"line":1,"column":633}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"callback","original":{"line":75,"column":20},"generated":{"line":1,"column":635}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":78,"column":8},"generated":{"line":1,"column":638}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"log","original":{"line":76,"column":9},"generated":{"line":1,"column":641}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"log","original":{"line":76,"column":9},"generated":{"line":1,"column":646}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":76,"column":13},"generated":{"line":1,"column":650}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"protocol","original":{"line":76,"column":32},"generated":{"line":1,"column":667}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"callback","original":{"line":77,"column":4},"generated":{"line":1,"column":670}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"once","original":{"line":77,"column":15},"generated":{"line":1,"column":672}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"callback","original":{"line":77,"column":20},"generated":{"line":1,"column":674}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":78,"column":9},"generated":{"line":1,"column":678}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"conn","original":{"line":78,"column":14},"generated":{"line":1,"column":683}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"callback","original":{"line":79,"column":13},"generated":{"line":1,"column":688}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"callback","original":{"line":79,"column":13},"generated":{"line":1,"column":695}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":79,"column":22},"generated":{"line":1,"column":697}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"Error","original":{"line":79,"column":26},"generated":{"line":1,"column":701}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":79,"column":32},"generated":{"line":1,"column":707}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"s","original":{"line":82,"column":10},"generated":{"line":1,"column":755}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"s","original":{"line":82,"column":10},"generated":{"line":1,"column":761}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"select","original":{"line":82,"column":14},"generated":{"line":1,"column":763}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"protocol","original":{"line":82,"column":21},"generated":{"line":1,"column":765}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":82,"column":31},"generated":{"line":1,"column":767}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"err","original":{"line":82,"column":32},"generated":{"line":1,"column":768}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"conn","original":{"line":82,"column":37},"generated":{"line":1,"column":770}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"err","original":{"line":83,"column":10},"generated":{"line":1,"column":775}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"err","original":{"line":83,"column":10},"generated":{"line":1,"column":778}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"callback","original":{"line":85,"column":15},"generated":{"line":1,"column":780}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"conn","original":{"line":84,"column":13},"generated":{"line":1,"column":787}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"conn","original":{"line":84,"column":13},"generated":{"line":1,"column":792}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":84,"column":20},"generated":{"line":1,"column":797}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"Connection","original":{"line":84,"column":24},"generated":{"line":1,"column":801}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"conn","original":{"line":84,"column":35},"generated":{"line":1,"column":803}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":84,"column":41},"generated":{"line":1,"column":805}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"conn","original":{"line":84,"column":46},"generated":{"line":1,"column":810}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"callback","original":{"line":85,"column":15},"generated":{"line":1,"column":816}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"err","original":{"line":85,"column":24},"generated":{"line":1,"column":818}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"callback","original":{"line":87,"column":6},"generated":{"line":1,"column":821}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":87,"column":15},"generated":{"line":1,"column":823}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":87,"column":21},"generated":{"line":1,"column":828}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"Connection","original":{"line":87,"column":25},"generated":{"line":1,"column":832}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"conn","original":{"line":87,"column":36},"generated":{"line":1,"column":834}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":87,"column":42},"generated":{"line":1,"column":836}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"conn","original":{"line":87,"column":47},"generated":{"line":1,"column":841}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":88,"column":7},"generated":{"line":1,"column":849}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"log","original":{"line":88,"column":12},"generated":{"line":1,"column":854}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"pull","original":{"line":90,"column":4},"generated":{"line":1,"column":859}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":91,"column":6},"generated":{"line":1,"column":861}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"conn","original":{"line":91,"column":11},"generated":{"line":1,"column":866}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"s","original":{"line":92,"column":6},"generated":{"line":1,"column":871}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":93,"column":6},"generated":{"line":1,"column":873}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"conn","original":{"line":93,"column":11},"generated":{"line":1,"column":878}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"ls","original":{"line":107,"column":2},"generated":{"line":1,"column":884}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"callback","original":{"line":107,"column":6},"generated":{"line":1,"column":887}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"callback","original":{"line":108,"column":4},"generated":{"line":1,"column":890}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"once","original":{"line":108,"column":15},"generated":{"line":1,"column":892}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"callback","original":{"line":108,"column":20},"generated":{"line":1,"column":894}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"lsStream","original":{"line":110,"column":10},"generated":{"line":1,"column":897}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"lsStream","original":{"line":110,"column":10},"generated":{"line":1,"column":903}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"select","original":{"line":110,"column":21},"generated":{"line":1,"column":905}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":110,"column":28},"generated":{"line":1,"column":907}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":110,"column":34},"generated":{"line":1,"column":912}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"err","original":{"line":110,"column":35},"generated":{"line":1,"column":913}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"conn","original":{"line":110,"column":40},"generated":{"line":1,"column":915}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"err","original":{"line":111,"column":10},"generated":{"line":1,"column":920}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"err","original":{"line":111,"column":10},"generated":{"line":1,"column":923}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"callback","original":{"line":112,"column":15},"generated":{"line":1,"column":925}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"callback","original":{"line":112,"column":15},"generated":{"line":1,"column":932}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"err","original":{"line":112,"column":24},"generated":{"line":1,"column":934}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"pull","original":{"line":115,"column":6},"generated":{"line":1,"column":937}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"conn","original":{"line":116,"column":8},"generated":{"line":1,"column":939}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"pullLP","original":{"line":117,"column":8},"generated":{"line":1,"column":941}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"decode","original":{"line":117,"column":15},"generated":{"line":1,"column":943}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"collectLs","original":{"line":118,"column":8},"generated":{"line":1,"column":952}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"conn","original":{"line":118,"column":18},"generated":{"line":1,"column":954}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"map","original":{"line":119,"column":8},"generated":{"line":1,"column":957}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"stringify","original":{"line":119,"column":12},"generated":{"line":1,"column":959}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"collect","original":{"line":120,"column":8},"generated":{"line":1,"column":962}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":120,"column":16},"generated":{"line":1,"column":964}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"err","original":{"line":120,"column":17},"generated":{"line":1,"column":965}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"list","original":{"line":120,"column":22},"generated":{"line":1,"column":967}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"err","original":{"line":121,"column":14},"generated":{"line":1,"column":972}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"err","original":{"line":121,"column":14},"generated":{"line":1,"column":975}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"callback","original":{"line":122,"column":19},"generated":{"line":1,"column":977}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"callback","original":{"line":122,"column":19},"generated":{"line":1,"column":984}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"err","original":{"line":122,"column":28},"generated":{"line":1,"column":986}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"callback","original":{"line":124,"column":10},"generated":{"line":1,"column":989}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":124,"column":19},"generated":{"line":1,"column":991}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"list","original":{"line":124,"column":25},"generated":{"line":1,"column":996}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"slice","original":{"line":124,"column":30},"generated":{"line":1,"column":998}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":124,"column":36},"generated":{"line":1,"column":1004}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":127,"column":7},"generated":{"line":1,"column":1012}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"log","original":{"line":127,"column":12},"generated":{"line":1,"column":1017}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"pull","original":{"line":129,"column":4},"generated":{"line":1,"column":1022}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":130,"column":6},"generated":{"line":1,"column":1024}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"conn","original":{"line":130,"column":11},"generated":{"line":1,"column":1029}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"lsStream","original":{"line":131,"column":6},"generated":{"line":1,"column":1034}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":132,"column":6},"generated":{"line":1,"column":1036}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"conn","original":{"line":132,"column":11},"generated":{"line":1,"column":1041}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":137,"column":0},"generated":{"line":1,"column":1048}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"stringify","original":{"line":137,"column":9},"generated":{"line":1,"column":1057}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"buf","original":{"line":137,"column":20},"generated":{"line":1,"column":1059}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"buf","original":{"line":138,"column":9},"generated":{"line":1,"column":1062}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"buf","original":{"line":138,"column":9},"generated":{"line":1,"column":1069}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"toString","original":{"line":138,"column":13},"generated":{"line":1,"column":1071}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"slice","original":{"line":138,"column":24},"generated":{"line":1,"column":1082}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":138,"column":30},"generated":{"line":1,"column":1088}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":138,"column":34},"generated":{"line":1,"column":1091}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":141,"column":0},"generated":{"line":1,"column":1094}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"collectLs","original":{"line":141,"column":9},"generated":{"line":1,"column":1103}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"conn","original":{"line":141,"column":20},"generated":{"line":1,"column":1105}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"first","original":{"line":142,"column":6},"generated":{"line":1,"column":1108}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"counter","original":{"line":143,"column":6},"generated":{"line":1,"column":1112}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":143,"column":16},"generated":{"line":1,"column":1114}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"take","original":{"line":145,"column":9},"generated":{"line":1,"column":1116}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"take","original":{"line":145,"column":9},"generated":{"line":1,"column":1123}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"msg","original":{"line":145,"column":15},"generated":{"line":1,"column":1125}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"varint","original":{"line":147,"column":6},"generated":{"line":1,"column":1129}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"decode","original":{"line":147,"column":13},"generated":{"line":1,"column":1131}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"msg","original":{"line":147,"column":20},"generated":{"line":1,"column":1138}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"counter","original":{"line":148,"column":6},"generated":{"line":1,"column":1141}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"varint","original":{"line":148,"column":16},"generated":{"line":1,"column":1143}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"decode","original":{"line":148,"column":23},"generated":{"line":1,"column":1145}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"msg","original":{"line":148,"column":30},"generated":{"line":1,"column":1152}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"varint","original":{"line":148,"column":35},"generated":{"line":1,"column":1154}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"decode","original":{"line":148,"column":42},"generated":{"line":1,"column":1156}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"bytes","original":{"line":148,"column":49},"generated":{"line":1,"column":1163}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","original":{"line":149,"column":13},"generated":{"line":1,"column":1171}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"module","original":{"line":156,"column":0},"generated":{"line":1,"column":1175}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"exports","original":{"line":156,"column":7},"generated":{"line":1,"column":1182}},{"source":"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js","name":"Dialer","original":{"line":156,"column":17},"generated":{"line":1,"column":1190}}],"sources":{"node_modules/ipfs/node_modules/multistream-select/src/dialer/index.js":"'use strict'\n\nconst varint = require('varint')\nconst pull = require('pull-stream/pull')\nconst map = require('pull-stream/throughs/map')\nconst collect = require('pull-stream/sinks/collect')\nconst take = require('pull-stream/throughs/take')\nconst pullLP = require('pull-length-prefixed')\nconst Connection = require('interface-connection').Connection\nconst util = require('../util')\nconst select = require('../select')\nconst once = require('once')\n\nconst PROTOCOL_ID = require('./../constants').PROTOCOL_ID\n\n/**\n *\n */\nclass Dialer {\n  /**\n   * Create a new Dialer.\n   */\n  constructor () {\n    this.conn = null\n    this.log = util.log.dialer()\n  }\n\n  /**\n   * Perform the multistream handshake.\n   *\n   * @param {Connection} rawConn - The connection on which\n   * to perform the handshake.\n   * @param {function(Error)} callback - Called when the handshake completed.\n   * @returns {undefined}\n   */\n  handle (rawConn, callback) {\n    this.log('dialer handle conn')\n    callback = once(callback)\n    const s = select(PROTOCOL_ID, (err, conn) => {\n      if (err) {\n        return callback(err)\n      }\n      this.log('handshake success')\n\n      this.conn = new Connection(conn, rawConn)\n\n      callback()\n    }, this.log)\n\n    // Handle unexpected errors from pull, like 'already piped'\n    try {\n      pull(\n        rawConn,\n        s,\n        rawConn\n      )\n    } catch (err) {\n      this.log.error(err)\n      callback(err)\n    }\n  }\n\n  /**\n   * Select a protocol\n   *\n   * @param {string} protocol - A string of the protocol that we want to handshake.\n   * @param {function(Error, Connection)} callback - `err` is\n   * an error object that gets passed if something wrong happ\n   * end (e.g: if the protocol selected is not supported by\n   * the other end) and conn is the connection handshaked\n   * with the other end.\n   *\n   * @returns {undefined}\n   */\n  select (protocol, callback) {\n    this.log('dialer select ' + protocol)\n    callback = once(callback)\n    if (!this.conn) {\n      return callback(new Error('multistream handshake has not finalized yet'))\n    }\n\n    const s = select(protocol, (err, conn) => {\n      if (err) {\n        this.conn = new Connection(conn, this.conn)\n        return callback(err)\n      }\n      callback(null, new Connection(conn, this.conn))\n    }, this.log)\n\n    pull(\n      this.conn,\n      s,\n      this.conn\n    )\n  }\n\n  /**\n   * List all available protocols.\n   *\n   * @param {function(Error, Array<string>)} callback - If\n   * something wrong happend `Error` exists, otherwise\n   * `protocols` is a list of the supported\n   * protocols on the other end.\n   *\n   * @returns {undefined}\n   */\n  ls (callback) {\n    callback = once(callback)\n\n    const lsStream = select('ls', (err, conn) => {\n      if (err) {\n        return callback(err)\n      }\n\n      pull(\n        conn,\n        pullLP.decode(),\n        collectLs(conn),\n        map(stringify),\n        collect((err, list) => {\n          if (err) {\n            return callback(err)\n          }\n          callback(null, list.slice(1))\n        })\n      )\n    }, this.log)\n\n    pull(\n      this.conn,\n      lsStream,\n      this.conn\n    )\n  }\n}\n\nfunction stringify (buf) {\n  return buf.toString().slice(0, -1)\n}\n\nfunction collectLs (conn) {\n  let first = true\n  let counter = 0\n\n  return take((msg) => {\n    if (first) {\n      varint.decode(msg)\n      counter = varint.decode(msg, varint.decode.bytes)\n      return true\n    }\n\n    return counter-- > 0\n  })\n}\n\nmodule.exports = Dialer\n"},"lineCount":null}},"error":null,"hash":"07fdd350c79194cad07bb1c6acfafbf0","cacheData":{"env":{}}}