{"id":"dNU9","dependencies":[{"name":"/Users/polluterofminds/Development/simpleid/ssa-sdk/package.json","includedInParent":true,"mtime":1584306008866},{"name":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p/package.json","includedInParent":true,"mtime":1582579780031},{"name":"mafmt","loc":{"line":3,"column":22},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/mafmt/src/index.js"},{"name":"multiaddr","loc":{"line":4,"column":26},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/multiaddr/src/index.js"},{"name":"./circuit/dialer","loc":{"line":6,"column":30},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/dialer.js"},{"name":"./circuit/utils","loc":{"line":7,"column":29},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p/src/circuit/circuit/utils.js"},{"name":"debug","loc":{"line":9,"column":22},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/debug/src/browser.js"},{"name":"./listener","loc":{"line":13,"column":31},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p/src/circuit/listener.js"}],"generated":{"js":"\"use strict\";const r=require(\"mafmt\"),i=require(\"multiaddr\"),t=require(\"./circuit/dialer\"),e=require(\"./circuit/utils\"),s=require(\"debug\"),a=s(\"libp2p:circuit:transportdialer\");a.err=s(\"libp2p:circuit:error:transportdialer\");const l=require(\"./listener\");class n{static get tag(){return\"Circuit\"}constructor(r,i){this.options=i||{},this.swarm=r,this.dialer=null,this.utils=e(r),this.peerInfo=this.swarm._peerInfo,this.relays=this.filter(this.peerInfo.multiaddrs.toArray()),0===this.relays.length&&this.peerInfo.multiaddrs.add(`/p2p-circuit/ipfs/${this.peerInfo.id.toB58String()}`),this.dialer=new t(r,i),this.swarm.on(\"peer-mux-established\",r=>{this.dialer.canHop(r)}),this.swarm.on(\"peer-mux-closed\",r=>{this.dialer.relayPeers.delete(r.id.toB58String())})}_dialSwarmRelays(){this.relays.forEach(r=>{r.toString().split(\"/p2p-circuit\").filter(r=>r.length).forEach(r=>{const t=this.utils.peerInfoFromMa(i(r));this.dialer._dialRelay(t)})})}dial(r,i,t){return this.dialer.dial(r,i,t)}createListener(r,i){\"function\"==typeof r&&(i=r,r=this.options||{});const t=l(this.swarm,r,i);return t.on(\"listen\",this._dialSwarmRelays.bind(this)),t}filter(i){return Array.isArray(i)||(i=[i]),i.filter(i=>r.Circuit.matches(i))}}module.exports=n;"},"sourceMaps":{"js":{"mappings":[{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":1,"column":0},"generated":{"line":1,"column":0}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":3,"column":0},"generated":{"line":1,"column":13}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"mafmt","original":{"line":3,"column":6},"generated":{"line":1,"column":19}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"require","original":{"line":3,"column":14},"generated":{"line":1,"column":21}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":3,"column":22},"generated":{"line":1,"column":29}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"multiaddr","original":{"line":4,"column":6},"generated":{"line":1,"column":38}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"require","original":{"line":4,"column":18},"generated":{"line":1,"column":40}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":4,"column":26},"generated":{"line":1,"column":48}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"CircuitDialer","original":{"line":6,"column":6},"generated":{"line":1,"column":61}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"require","original":{"line":6,"column":22},"generated":{"line":1,"column":63}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":6,"column":30},"generated":{"line":1,"column":71}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"utilsFactory","original":{"line":7,"column":6},"generated":{"line":1,"column":91}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"require","original":{"line":7,"column":21},"generated":{"line":1,"column":93}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":7,"column":29},"generated":{"line":1,"column":101}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"debug","original":{"line":9,"column":6},"generated":{"line":1,"column":120}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"require","original":{"line":9,"column":14},"generated":{"line":1,"column":122}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":9,"column":22},"generated":{"line":1,"column":130}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"log","original":{"line":10,"column":6},"generated":{"line":1,"column":139}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"debug","original":{"line":10,"column":12},"generated":{"line":1,"column":141}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":10,"column":18},"generated":{"line":1,"column":143}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"log","original":{"line":11,"column":0},"generated":{"line":1,"column":177}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"err","original":{"line":11,"column":4},"generated":{"line":1,"column":179}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"debug","original":{"line":11,"column":10},"generated":{"line":1,"column":183}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":11,"column":16},"generated":{"line":1,"column":185}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":13,"column":0},"generated":{"line":1,"column":225}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"createListener","original":{"line":13,"column":6},"generated":{"line":1,"column":231}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"require","original":{"line":13,"column":23},"generated":{"line":1,"column":233}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":13,"column":31},"generated":{"line":1,"column":241}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":15,"column":0},"generated":{"line":1,"column":255}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"Circuit","original":{"line":15,"column":6},"generated":{"line":1,"column":261}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"tag","original":{"line":16,"column":13},"generated":{"line":1,"column":263}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":17,"column":11},"generated":{"line":1,"column":280}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":17,"column":11},"generated":{"line":1,"column":286}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"constructor","original":{"line":28,"column":2},"generated":{"line":1,"column":296}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"swarm","original":{"line":28,"column":15},"generated":{"line":1,"column":308}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"options","original":{"line":28,"column":22},"generated":{"line":1,"column":310}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"options","original":{"line":29,"column":9},"generated":{"line":1,"column":313}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"options","original":{"line":29,"column":9},"generated":{"line":1,"column":318}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"options","original":{"line":29,"column":19},"generated":{"line":1,"column":326}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":29,"column":30},"generated":{"line":1,"column":329}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"swarm","original":{"line":31,"column":9},"generated":{"line":1,"column":332}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"swarm","original":{"line":31,"column":9},"generated":{"line":1,"column":337}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"swarm","original":{"line":31,"column":17},"generated":{"line":1,"column":343}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"dialer","original":{"line":32,"column":9},"generated":{"line":1,"column":345}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"dialer","original":{"line":32,"column":9},"generated":{"line":1,"column":350}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":32,"column":18},"generated":{"line":1,"column":357}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"utils","original":{"line":33,"column":9},"generated":{"line":1,"column":362}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"utils","original":{"line":33,"column":9},"generated":{"line":1,"column":367}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"utilsFactory","original":{"line":33,"column":17},"generated":{"line":1,"column":373}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"swarm","original":{"line":33,"column":30},"generated":{"line":1,"column":375}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"peerInfo","original":{"line":34,"column":9},"generated":{"line":1,"column":378}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"peerInfo","original":{"line":34,"column":9},"generated":{"line":1,"column":383}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":34,"column":20},"generated":{"line":1,"column":392}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"swarm","original":{"line":34,"column":25},"generated":{"line":1,"column":397}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"_peerInfo","original":{"line":34,"column":31},"generated":{"line":1,"column":403}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"relays","original":{"line":35,"column":9},"generated":{"line":1,"column":413}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"relays","original":{"line":35,"column":9},"generated":{"line":1,"column":418}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":35,"column":18},"generated":{"line":1,"column":425}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"filter","original":{"line":35,"column":23},"generated":{"line":1,"column":430}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":35,"column":30},"generated":{"line":1,"column":437}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"peerInfo","original":{"line":35,"column":35},"generated":{"line":1,"column":442}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"multiaddrs","original":{"line":35,"column":44},"generated":{"line":1,"column":451}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"toArray","original":{"line":35,"column":55},"generated":{"line":1,"column":462}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":38,"column":31},"generated":{"line":1,"column":473}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":38,"column":8},"generated":{"line":1,"column":477}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"relays","original":{"line":38,"column":13},"generated":{"line":1,"column":482}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"length","original":{"line":38,"column":20},"generated":{"line":1,"column":489}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"peerInfo","original":{"line":39,"column":11},"generated":{"line":1,"column":497}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"peerInfo","original":{"line":39,"column":11},"generated":{"line":1,"column":502}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"multiaddrs","original":{"line":40,"column":9},"generated":{"line":1,"column":511}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"add","original":{"line":41,"column":9},"generated":{"line":1,"column":522}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":41,"column":34},"generated":{"line":1,"column":547}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"peerInfo","original":{"line":41,"column":39},"generated":{"line":1,"column":552}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"id","original":{"line":41,"column":48},"generated":{"line":1,"column":561}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"toB58String","original":{"line":41,"column":51},"generated":{"line":1,"column":564}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"dialer","original":{"line":44,"column":9},"generated":{"line":1,"column":581}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"dialer","original":{"line":44,"column":9},"generated":{"line":1,"column":586}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":44,"column":18},"generated":{"line":1,"column":593}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"CircuitDialer","original":{"line":44,"column":22},"generated":{"line":1,"column":597}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"swarm","original":{"line":44,"column":36},"generated":{"line":1,"column":599}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"options","original":{"line":44,"column":43},"generated":{"line":1,"column":601}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"swarm","original":{"line":46,"column":9},"generated":{"line":1,"column":604}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"swarm","original":{"line":46,"column":9},"generated":{"line":1,"column":609}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"on","original":{"line":46,"column":15},"generated":{"line":1,"column":615}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":46,"column":18},"generated":{"line":1,"column":618}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"peerInfo","original":{"line":46,"column":43},"generated":{"line":1,"column":641}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"dialer","original":{"line":47,"column":11},"generated":{"line":1,"column":645}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"dialer","original":{"line":47,"column":11},"generated":{"line":1,"column":650}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"canHop","original":{"line":47,"column":18},"generated":{"line":1,"column":657}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"peerInfo","original":{"line":47,"column":25},"generated":{"line":1,"column":664}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"swarm","original":{"line":49,"column":9},"generated":{"line":1,"column":669}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"swarm","original":{"line":49,"column":9},"generated":{"line":1,"column":674}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"on","original":{"line":49,"column":15},"generated":{"line":1,"column":680}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":49,"column":18},"generated":{"line":1,"column":683}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"peerInfo","original":{"line":49,"column":38},"generated":{"line":1,"column":701}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"dialer","original":{"line":50,"column":11},"generated":{"line":1,"column":705}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"dialer","original":{"line":50,"column":11},"generated":{"line":1,"column":710}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"relayPeers","original":{"line":50,"column":18},"generated":{"line":1,"column":717}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"delete","original":{"line":50,"column":29},"generated":{"line":1,"column":728}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"peerInfo","original":{"line":50,"column":36},"generated":{"line":1,"column":735}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"id","original":{"line":50,"column":45},"generated":{"line":1,"column":737}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"toB58String","original":{"line":50,"column":48},"generated":{"line":1,"column":740}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"_dialSwarmRelays","original":{"line":60,"column":2},"generated":{"line":1,"column":757}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"relays","original":{"line":62,"column":9},"generated":{"line":1,"column":776}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"relays","original":{"line":62,"column":9},"generated":{"line":1,"column":781}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"forEach","original":{"line":62,"column":16},"generated":{"line":1,"column":788}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"relay","original":{"line":62,"column":25},"generated":{"line":1,"column":796}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"relay","original":{"line":63,"column":28},"generated":{"line":1,"column":800}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"toString","original":{"line":64,"column":9},"generated":{"line":1,"column":802}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"split","original":{"line":65,"column":9},"generated":{"line":1,"column":813}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":65,"column":15},"generated":{"line":1,"column":819}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"filter","original":{"line":66,"column":9},"generated":{"line":1,"column":835}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"segment","original":{"line":66,"column":16},"generated":{"line":1,"column":842}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"segment","original":{"line":66,"column":27},"generated":{"line":1,"column":845}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"length","original":{"line":66,"column":35},"generated":{"line":1,"column":847}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"forEach","original":{"line":68,"column":20},"generated":{"line":1,"column":855}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"relaySegment","original":{"line":68,"column":29},"generated":{"line":1,"column":863}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"ma","original":{"line":69,"column":14},"generated":{"line":1,"column":867}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"ma","original":{"line":69,"column":14},"generated":{"line":1,"column":873}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":69,"column":19},"generated":{"line":1,"column":875}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"utils","original":{"line":69,"column":24},"generated":{"line":1,"column":880}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"peerInfoFromMa","original":{"line":69,"column":30},"generated":{"line":1,"column":886}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"multiaddr","original":{"line":69,"column":45},"generated":{"line":1,"column":901}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"relaySegment","original":{"line":69,"column":55},"generated":{"line":1,"column":903}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"dialer","original":{"line":70,"column":13},"generated":{"line":1,"column":907}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"dialer","original":{"line":70,"column":13},"generated":{"line":1,"column":912}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"_dialRelay","original":{"line":70,"column":20},"generated":{"line":1,"column":919}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"ma","original":{"line":70,"column":31},"generated":{"line":1,"column":930}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"dial","original":{"line":85,"column":2},"generated":{"line":1,"column":937}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"ma","original":{"line":85,"column":8},"generated":{"line":1,"column":942}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"options","original":{"line":85,"column":12},"generated":{"line":1,"column":944}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"cb","original":{"line":85,"column":21},"generated":{"line":1,"column":946}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":86,"column":11},"generated":{"line":1,"column":949}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":86,"column":11},"generated":{"line":1,"column":956}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"dialer","original":{"line":86,"column":16},"generated":{"line":1,"column":961}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"dial","original":{"line":86,"column":23},"generated":{"line":1,"column":968}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"ma","original":{"line":86,"column":28},"generated":{"line":1,"column":973}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"options","original":{"line":86,"column":32},"generated":{"line":1,"column":975}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"cb","original":{"line":86,"column":41},"generated":{"line":1,"column":977}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"createListener","original":{"line":96,"column":2},"generated":{"line":1,"column":980}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"options","original":{"line":96,"column":18},"generated":{"line":1,"column":995}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"handler","original":{"line":96,"column":27},"generated":{"line":1,"column":997}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":97,"column":27},"generated":{"line":1,"column":1000}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"options","original":{"line":97,"column":15},"generated":{"line":1,"column":1019}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"handler","original":{"line":98,"column":6},"generated":{"line":1,"column":1023}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"options","original":{"line":98,"column":16},"generated":{"line":1,"column":1025}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"options","original":{"line":99,"column":6},"generated":{"line":1,"column":1027}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":99,"column":16},"generated":{"line":1,"column":1029}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"options","original":{"line":99,"column":21},"generated":{"line":1,"column":1034}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":99,"column":32},"generated":{"line":1,"column":1043}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"listener","original":{"line":102,"column":10},"generated":{"line":1,"column":1047}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"listener","original":{"line":102,"column":10},"generated":{"line":1,"column":1053}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"createListener","original":{"line":102,"column":21},"generated":{"line":1,"column":1055}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":102,"column":36},"generated":{"line":1,"column":1057}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"swarm","original":{"line":102,"column":41},"generated":{"line":1,"column":1062}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"options","original":{"line":102,"column":48},"generated":{"line":1,"column":1068}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"handler","original":{"line":102,"column":57},"generated":{"line":1,"column":1070}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"listener","original":{"line":104,"column":11},"generated":{"line":1,"column":1073}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"listener","original":{"line":103,"column":4},"generated":{"line":1,"column":1080}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"on","original":{"line":103,"column":13},"generated":{"line":1,"column":1082}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":103,"column":16},"generated":{"line":1,"column":1085}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":103,"column":26},"generated":{"line":1,"column":1094}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"_dialSwarmRelays","original":{"line":103,"column":31},"generated":{"line":1,"column":1099}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"bind","original":{"line":103,"column":48},"generated":{"line":1,"column":1116}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":103,"column":53},"generated":{"line":1,"column":1121}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"listener","original":{"line":104,"column":11},"generated":{"line":1,"column":1128}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"filter","original":{"line":116,"column":2},"generated":{"line":1,"column":1130}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"multiaddrs","original":{"line":116,"column":10},"generated":{"line":1,"column":1137}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"multiaddrs","original":{"line":120,"column":11},"generated":{"line":1,"column":1140}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"Array","original":{"line":117,"column":9},"generated":{"line":1,"column":1147}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"isArray","original":{"line":117,"column":15},"generated":{"line":1,"column":1153}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"multiaddrs","original":{"line":117,"column":23},"generated":{"line":1,"column":1161}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"multiaddrs","original":{"line":118,"column":6},"generated":{"line":1,"column":1166}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","original":{"line":118,"column":19},"generated":{"line":1,"column":1168}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"multiaddrs","original":{"line":118,"column":20},"generated":{"line":1,"column":1169}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"multiaddrs","original":{"line":120,"column":11},"generated":{"line":1,"column":1173}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"filter","original":{"line":120,"column":22},"generated":{"line":1,"column":1175}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"ma","original":{"line":120,"column":30},"generated":{"line":1,"column":1182}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"mafmt","original":{"line":121,"column":13},"generated":{"line":1,"column":1185}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"Circuit","original":{"line":121,"column":19},"generated":{"line":1,"column":1187}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"matches","original":{"line":121,"column":27},"generated":{"line":1,"column":1195}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"ma","original":{"line":121,"column":35},"generated":{"line":1,"column":1203}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"module","original":{"line":126,"column":0},"generated":{"line":1,"column":1208}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"exports","original":{"line":126,"column":7},"generated":{"line":1,"column":1215}},{"source":"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js","name":"Circuit","original":{"line":126,"column":17},"generated":{"line":1,"column":1223}}],"sources":{"node_modules/ipfs/node_modules/libp2p/src/circuit/circuit.js":"'use strict'\n\nconst mafmt = require('mafmt')\nconst multiaddr = require('multiaddr')\n\nconst CircuitDialer = require('./circuit/dialer')\nconst utilsFactory = require('./circuit/utils')\n\nconst debug = require('debug')\nconst log = debug('libp2p:circuit:transportdialer')\nlog.err = debug('libp2p:circuit:error:transportdialer')\n\nconst createListener = require('./listener')\n\nclass Circuit {\n  static get tag () {\n    return 'Circuit'\n  }\n\n  /**\n   * Creates an instance of Dialer.\n   *\n   * @param {Swarm} swarm - the swarm\n   * @param {any} options - config options\n   *\n   * @memberOf Dialer\n   */\n  constructor (swarm, options) {\n    this.options = options || {}\n\n    this.swarm = swarm\n    this.dialer = null\n    this.utils = utilsFactory(swarm)\n    this.peerInfo = this.swarm._peerInfo\n    this.relays = this.filter(this.peerInfo.multiaddrs.toArray())\n\n    // if no explicit relays, add a default relay addr\n    if (this.relays.length === 0) {\n      this.peerInfo\n        .multiaddrs\n        .add(`/p2p-circuit/ipfs/${this.peerInfo.id.toB58String()}`)\n    }\n\n    this.dialer = new CircuitDialer(swarm, options)\n\n    this.swarm.on('peer-mux-established', (peerInfo) => {\n      this.dialer.canHop(peerInfo)\n    })\n    this.swarm.on('peer-mux-closed', (peerInfo) => {\n      this.dialer.relayPeers.delete(peerInfo.id.toB58String())\n    })\n  }\n\n  /**\n   * Dial the relays in the Addresses.Swarm config\n   *\n   * @param {Array} relays\n   * @return {void}\n   */\n  _dialSwarmRelays () {\n    // if we have relay addresses in swarm config, then dial those relays\n    this.relays.forEach((relay) => {\n      const relaySegments = relay\n        .toString()\n        .split('/p2p-circuit')\n        .filter(segment => segment.length)\n\n      relaySegments.forEach((relaySegment) => {\n        const ma = this.utils.peerInfoFromMa(multiaddr(relaySegment))\n        this.dialer._dialRelay(ma)\n      })\n    })\n  }\n\n  /**\n   * Dial a peer over a relay\n   *\n   * @param {multiaddr} ma - the multiaddr of the peer to dial\n   * @param {Object} options - dial options\n   * @param {Function} cb - a callback called once dialed\n   * @returns {Connection} - the connection\n   *\n   * @memberOf Dialer\n   */\n  dial (ma, options, cb) {\n    return this.dialer.dial(ma, options, cb)\n  }\n\n  /**\n   * Create a listener\n   *\n   * @param {any} options\n   * @param {Function} handler\n   * @return {listener}\n   */\n  createListener (options, handler) {\n    if (typeof options === 'function') {\n      handler = options\n      options = this.options || {}\n    }\n\n    const listener = createListener(this.swarm, options, handler)\n    listener.on('listen', this._dialSwarmRelays.bind(this))\n    return listener\n  }\n\n  /**\n   * Filter check for all multiaddresses\n   * that this transport can dial on\n   *\n   * @param {any} multiaddrs\n   * @returns {Array<multiaddr>}\n   *\n   * @memberOf Dialer\n   */\n  filter (multiaddrs) {\n    if (!Array.isArray(multiaddrs)) {\n      multiaddrs = [multiaddrs]\n    }\n    return multiaddrs.filter((ma) => {\n      return mafmt.Circuit.matches(ma)\n    })\n  }\n}\n\nmodule.exports = Circuit\n"},"lineCount":null}},"error":null,"hash":"65f9b4a3f9df9c37316d535e25cafec0","cacheData":{"env":{}}}