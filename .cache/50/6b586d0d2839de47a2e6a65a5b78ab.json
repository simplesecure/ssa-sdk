{"id":"XFdq","dependencies":[{"name":"/Users/polluterofminds/Development/simpleid/ssa-sdk/package.json","includedInParent":true,"mtime":1584306008866},{"name":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-secio/package.json","includedInParent":true,"mtime":1582579780394},{"name":"pull-stream/pull","loc":{"line":3,"column":21},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/pull-stream/pull.js"},{"name":"pull-stream/sources/error","loc":{"line":4,"column":26},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/pull-stream/sources/error.js"},{"name":"pull-handshake","loc":{"line":5,"column":26},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/pull-handshake/index.js"},{"name":"debug","loc":{"line":6,"column":22},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/debug/src/browser.js"},{"name":"../etm","loc":{"line":11,"column":20},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-secio/src/etm.js"},{"name":"./crypto","loc":{"line":12,"column":23},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-secio/src/handshake/crypto.js"}],"generated":{"js":"\"use strict\";const e=require(\"pull-stream/pull\"),r=require(\"pull-stream/sources/error\"),o=require(\"pull-handshake\"),t=require(\"debug\"),s=t(\"libp2p:secio\");s.error=t(\"libp2p:secio:error\");const i=require(\"../etm\"),a=require(\"./crypto\");module.exports=function(t,c){s(\"3. finish - start\");const n=t.protocols,u=t.shake.rest(),l=o({timeout:t.timeout},e=>{if(e)throw e});e(u,i.createUnboxStream(n.remote.cipher,n.remote.mac),l,i.createBoxStream(n.local.cipher,n.local.mac),u),l.handshake.write(t.proposal.in.rand),l.handshake.read(t.proposal.in.rand.length,(e,o)=>{const i=e=>{s.error(e),t.secure.resolve({source:r(e),sink(e){}}),c(e)};if(e)return i(e);try{a.verifyNonce(t,o)}catch(e){return i(e)}s(\"3. finish - finish\"),t.secure.resolve(l.handshake.rest()),c()})};"},"sourceMaps":{"js":{"mappings":[{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","original":{"line":1,"column":0},"generated":{"line":1,"column":0}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","original":{"line":3,"column":0},"generated":{"line":1,"column":13}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"pull","original":{"line":3,"column":6},"generated":{"line":1,"column":19}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"require","original":{"line":3,"column":13},"generated":{"line":1,"column":21}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","original":{"line":3,"column":21},"generated":{"line":1,"column":29}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"pullError","original":{"line":4,"column":6},"generated":{"line":1,"column":49}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"require","original":{"line":4,"column":18},"generated":{"line":1,"column":51}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","original":{"line":4,"column":26},"generated":{"line":1,"column":59}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"handshake","original":{"line":5,"column":6},"generated":{"line":1,"column":88}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"require","original":{"line":5,"column":18},"generated":{"line":1,"column":90}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","original":{"line":5,"column":26},"generated":{"line":1,"column":98}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"debug","original":{"line":6,"column":6},"generated":{"line":1,"column":116}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"require","original":{"line":6,"column":14},"generated":{"line":1,"column":118}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","original":{"line":6,"column":22},"generated":{"line":1,"column":126}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"log","original":{"line":8,"column":6},"generated":{"line":1,"column":135}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"debug","original":{"line":8,"column":12},"generated":{"line":1,"column":137}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","original":{"line":8,"column":18},"generated":{"line":1,"column":139}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"log","original":{"line":9,"column":0},"generated":{"line":1,"column":155}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"error","original":{"line":9,"column":4},"generated":{"line":1,"column":157}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"debug","original":{"line":9,"column":12},"generated":{"line":1,"column":163}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","original":{"line":9,"column":18},"generated":{"line":1,"column":165}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","original":{"line":11,"column":0},"generated":{"line":1,"column":187}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"etm","original":{"line":11,"column":6},"generated":{"line":1,"column":193}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"require","original":{"line":11,"column":12},"generated":{"line":1,"column":195}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","original":{"line":11,"column":20},"generated":{"line":1,"column":203}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"crypto","original":{"line":12,"column":6},"generated":{"line":1,"column":213}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"require","original":{"line":12,"column":15},"generated":{"line":1,"column":215}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","original":{"line":12,"column":23},"generated":{"line":1,"column":223}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"module","original":{"line":16,"column":0},"generated":{"line":1,"column":235}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"exports","original":{"line":16,"column":7},"generated":{"line":1,"column":242}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","original":{"line":16,"column":17},"generated":{"line":1,"column":250}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"state","original":{"line":16,"column":34},"generated":{"line":1,"column":259}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"callback","original":{"line":16,"column":41},"generated":{"line":1,"column":261}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"log","original":{"line":17,"column":2},"generated":{"line":1,"column":264}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","original":{"line":17,"column":6},"generated":{"line":1,"column":266}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"proto","original":{"line":19,"column":8},"generated":{"line":1,"column":287}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"proto","original":{"line":19,"column":8},"generated":{"line":1,"column":293}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"state","original":{"line":19,"column":16},"generated":{"line":1,"column":295}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"protocols","original":{"line":19,"column":22},"generated":{"line":1,"column":297}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"stream","original":{"line":20,"column":8},"generated":{"line":1,"column":307}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"state","original":{"line":20,"column":17},"generated":{"line":1,"column":309}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"shake","original":{"line":20,"column":23},"generated":{"line":1,"column":311}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"rest","original":{"line":20,"column":29},"generated":{"line":1,"column":317}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"shake","original":{"line":21,"column":8},"generated":{"line":1,"column":324}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"handshake","original":{"line":21,"column":16},"generated":{"line":1,"column":326}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","original":{"line":21,"column":26},"generated":{"line":1,"column":328}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"timeout","original":{"line":21,"column":28},"generated":{"line":1,"column":329}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"state","original":{"line":21,"column":37},"generated":{"line":1,"column":337}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"timeout","original":{"line":21,"column":43},"generated":{"line":1,"column":339}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"err","original":{"line":21,"column":55},"generated":{"line":1,"column":348}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"err","original":{"line":22,"column":8},"generated":{"line":1,"column":352}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"err","original":{"line":22,"column":8},"generated":{"line":1,"column":355}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"err","original":{"line":23,"column":12},"generated":{"line":1,"column":357}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"err","original":{"line":23,"column":12},"generated":{"line":1,"column":363}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"pull","original":{"line":27,"column":2},"generated":{"line":1,"column":367}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"stream","original":{"line":28,"column":4},"generated":{"line":1,"column":369}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"etm","original":{"line":29,"column":4},"generated":{"line":1,"column":371}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"createUnboxStream","original":{"line":29,"column":8},"generated":{"line":1,"column":373}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"proto","original":{"line":29,"column":26},"generated":{"line":1,"column":391}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"remote","original":{"line":29,"column":32},"generated":{"line":1,"column":393}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"cipher","original":{"line":29,"column":39},"generated":{"line":1,"column":400}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"proto","original":{"line":29,"column":47},"generated":{"line":1,"column":407}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"remote","original":{"line":29,"column":53},"generated":{"line":1,"column":409}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"mac","original":{"line":29,"column":60},"generated":{"line":1,"column":416}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"shake","original":{"line":30,"column":4},"generated":{"line":1,"column":421}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"etm","original":{"line":31,"column":4},"generated":{"line":1,"column":423}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"createBoxStream","original":{"line":31,"column":8},"generated":{"line":1,"column":425}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"proto","original":{"line":31,"column":24},"generated":{"line":1,"column":441}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"local","original":{"line":31,"column":30},"generated":{"line":1,"column":443}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"cipher","original":{"line":31,"column":36},"generated":{"line":1,"column":449}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"proto","original":{"line":31,"column":44},"generated":{"line":1,"column":456}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"local","original":{"line":31,"column":50},"generated":{"line":1,"column":458}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"mac","original":{"line":31,"column":56},"generated":{"line":1,"column":464}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"stream","original":{"line":32,"column":4},"generated":{"line":1,"column":469}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"shake","original":{"line":35,"column":2},"generated":{"line":1,"column":472}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"handshake","original":{"line":35,"column":8},"generated":{"line":1,"column":474}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"write","original":{"line":35,"column":18},"generated":{"line":1,"column":484}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"state","original":{"line":35,"column":24},"generated":{"line":1,"column":490}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"proposal","original":{"line":35,"column":30},"generated":{"line":1,"column":492}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"in","original":{"line":35,"column":39},"generated":{"line":1,"column":501}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"rand","original":{"line":35,"column":42},"generated":{"line":1,"column":504}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"shake","original":{"line":36,"column":2},"generated":{"line":1,"column":510}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"handshake","original":{"line":36,"column":8},"generated":{"line":1,"column":512}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"read","original":{"line":36,"column":18},"generated":{"line":1,"column":522}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"state","original":{"line":36,"column":23},"generated":{"line":1,"column":527}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"proposal","original":{"line":36,"column":29},"generated":{"line":1,"column":529}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"in","original":{"line":36,"column":38},"generated":{"line":1,"column":538}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"rand","original":{"line":36,"column":41},"generated":{"line":1,"column":541}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"length","original":{"line":36,"column":46},"generated":{"line":1,"column":546}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","original":{"line":36,"column":54},"generated":{"line":1,"column":553}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"err","original":{"line":36,"column":55},"generated":{"line":1,"column":554}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"nonceBack","original":{"line":36,"column":60},"generated":{"line":1,"column":556}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"fail","original":{"line":37,"column":10},"generated":{"line":1,"column":561}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"fail","original":{"line":37,"column":10},"generated":{"line":1,"column":567}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"err","original":{"line":37,"column":18},"generated":{"line":1,"column":569}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"log","original":{"line":38,"column":6},"generated":{"line":1,"column":573}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"error","original":{"line":38,"column":10},"generated":{"line":1,"column":575}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"err","original":{"line":38,"column":16},"generated":{"line":1,"column":581}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"state","original":{"line":39,"column":6},"generated":{"line":1,"column":584}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"secure","original":{"line":39,"column":12},"generated":{"line":1,"column":586}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"resolve","original":{"line":39,"column":19},"generated":{"line":1,"column":593}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","original":{"line":39,"column":27},"generated":{"line":1,"column":601}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"source","original":{"line":40,"column":8},"generated":{"line":1,"column":602}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"pullError","original":{"line":40,"column":16},"generated":{"line":1,"column":609}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"err","original":{"line":40,"column":26},"generated":{"line":1,"column":611}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"sink","original":{"line":41,"column":8},"generated":{"line":1,"column":614}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"read","original":{"line":41,"column":14},"generated":{"line":1,"column":619}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"callback","original":{"line":44,"column":6},"generated":{"line":1,"column":626}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"err","original":{"line":44,"column":15},"generated":{"line":1,"column":628}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"err","original":{"line":47,"column":8},"generated":{"line":1,"column":632}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"err","original":{"line":47,"column":8},"generated":{"line":1,"column":635}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","original":{"line":47,"column":13},"generated":{"line":1,"column":637}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"fail","original":{"line":47,"column":20},"generated":{"line":1,"column":644}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"err","original":{"line":47,"column":25},"generated":{"line":1,"column":646}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","original":{"line":49,"column":8},"generated":{"line":1,"column":649}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"crypto","original":{"line":50,"column":6},"generated":{"line":1,"column":653}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"verifyNonce","original":{"line":50,"column":13},"generated":{"line":1,"column":655}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"state","original":{"line":50,"column":25},"generated":{"line":1,"column":667}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"nonceBack","original":{"line":50,"column":32},"generated":{"line":1,"column":669}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","original":{"line":51,"column":6},"generated":{"line":1,"column":672}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"err","original":{"line":51,"column":13},"generated":{"line":1,"column":678}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"fail","original":{"line":52,"column":13},"generated":{"line":1,"column":681}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"fail","original":{"line":52,"column":13},"generated":{"line":1,"column":688}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"err","original":{"line":52,"column":18},"generated":{"line":1,"column":690}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"log","original":{"line":55,"column":4},"generated":{"line":1,"column":693}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","original":{"line":55,"column":8},"generated":{"line":1,"column":695}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"state","original":{"line":58,"column":4},"generated":{"line":1,"column":717}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"secure","original":{"line":58,"column":10},"generated":{"line":1,"column":719}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"resolve","original":{"line":58,"column":17},"generated":{"line":1,"column":726}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"shake","original":{"line":58,"column":25},"generated":{"line":1,"column":734}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"handshake","original":{"line":58,"column":31},"generated":{"line":1,"column":736}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"rest","original":{"line":58,"column":41},"generated":{"line":1,"column":746}},{"source":"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js","name":"callback","original":{"line":59,"column":4},"generated":{"line":1,"column":754}}],"sources":{"node_modules/ipfs/node_modules/libp2p-secio/src/handshake/finish.js":"'use strict'\n\nconst pull = require('pull-stream/pull')\nconst pullError = require('pull-stream/sources/error')\nconst handshake = require('pull-handshake')\nconst debug = require('debug')\n\nconst log = debug('libp2p:secio')\nlog.error = debug('libp2p:secio:error')\n\nconst etm = require('../etm')\nconst crypto = require('./crypto')\n\n// step 3. Finish\n// -- send expected message to verify encryption works (send local nonce)\nmodule.exports = function finish (state, callback) {\n  log('3. finish - start')\n\n  const proto = state.protocols\n  const stream = state.shake.rest()\n  const shake = handshake({ timeout: state.timeout }, (err) => {\n    if (err) {\n      throw err\n    }\n  })\n\n  pull(\n    stream,\n    etm.createUnboxStream(proto.remote.cipher, proto.remote.mac),\n    shake,\n    etm.createBoxStream(proto.local.cipher, proto.local.mac),\n    stream\n  )\n\n  shake.handshake.write(state.proposal.in.rand)\n  shake.handshake.read(state.proposal.in.rand.length, (err, nonceBack) => {\n    const fail = (err) => {\n      log.error(err)\n      state.secure.resolve({\n        source: pullError(err),\n        sink (read) {\n        }\n      })\n      callback(err)\n    }\n\n    if (err) return fail(err)\n\n    try {\n      crypto.verifyNonce(state, nonceBack)\n    } catch (err) {\n      return fail(err)\n    }\n\n    log('3. finish - finish')\n\n    // Awesome that's all folks.\n    state.secure.resolve(shake.handshake.rest())\n    callback()\n  })\n}\n"},"lineCount":null}},"error":null,"hash":"d4c6af9360fdd9b28d047f91231f9d08","cacheData":{"env":{}}}