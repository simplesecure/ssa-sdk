{"id":"WRdq","dependencies":[{"name":"/Users/polluterofminds/Development/simpleid/ssa-sdk/package.json","includedInParent":true,"mtime":1584306008866},{"name":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs-pubsub-room/package.json","includedInParent":true,"mtime":1582579778659},{"name":"pull-stream","loc":{"line":3,"column":21},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/pull-stream/index.js"},{"name":"events","loc":{"line":4,"column":29},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/events/events.js"},{"name":"buffer","parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/node-libs-browser/node_modules/buffer/index.js"}],"generated":{"js":"var Buffer = require(\"buffer\").Buffer;\nvar e=require(\"buffer\").Buffer;const r=require(\"pull-stream\"),t=require(\"events\"),n=new t;function o(t,o){o.getPeerInfo((t,i)=>{if(t)return void console.log(t);const a=i.id.toB58String();r(o,r.map(r=>{let o;try{o=JSON.parse(r.toString())}catch(t){return void n.emit(\"warning\",t.message)}if(a!==o.from)return void n.emit(\"warning\",\"no peerid match \"+o.from);const i=o.topicIDs;if(Array.isArray(i))return o.data=e.from(o.data,\"hex\"),o.seqno=e.from(o.seqno,\"hex\"),i.forEach(e=>{n.emit(e,o)}),o;n.emit(\"warning\",\"no topic IDs\")}),r.onEnd(()=>{}))})}exports=module.exports={handler:o,emitter:n};"},"sourceMaps":{"js":{"mappings":[{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":59,"column":0},"generated":{"line":2,"column":0}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":59,"column":0},"generated":{"line":2,"column":4}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":59,"column":0},"generated":{"line":2,"column":6}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":59,"column":0},"generated":{"line":2,"column":14}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":59,"column":0},"generated":{"line":2,"column":24}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":3,"column":0},"generated":{"line":2,"column":31}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":3,"column":0},"generated":{"line":2,"column":37}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":3,"column":0},"generated":{"line":2,"column":39}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":3,"column":0},"generated":{"line":2,"column":47}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":4,"column":0},"generated":{"line":2,"column":62}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":4,"column":0},"generated":{"line":2,"column":64}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":4,"column":0},"generated":{"line":2,"column":72}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":6,"column":0},"generated":{"line":2,"column":82}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":6,"column":0},"generated":{"line":2,"column":84}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":6,"column":0},"generated":{"line":2,"column":88}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":8,"column":0},"generated":{"line":2,"column":90}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":8,"column":0},"generated":{"line":2,"column":99}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":8,"column":0},"generated":{"line":2,"column":101}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":8,"column":0},"generated":{"line":2,"column":103}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":9,"column":0},"generated":{"line":2,"column":106}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":9,"column":0},"generated":{"line":2,"column":108}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":9,"column":0},"generated":{"line":2,"column":120}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":9,"column":0},"generated":{"line":2,"column":121}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":9,"column":0},"generated":{"line":2,"column":123}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":10,"column":0},"generated":{"line":2,"column":128}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":10,"column":0},"generated":{"line":2,"column":131}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":12,"column":0},"generated":{"line":2,"column":133}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":11,"column":0},"generated":{"line":2,"column":145}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":11,"column":0},"generated":{"line":2,"column":153}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":11,"column":0},"generated":{"line":2,"column":157}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":15,"column":0},"generated":{"line":2,"column":160}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":15,"column":0},"generated":{"line":2,"column":166}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":15,"column":0},"generated":{"line":2,"column":168}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":15,"column":0},"generated":{"line":2,"column":170}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":15,"column":0},"generated":{"line":2,"column":173}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":17,"column":0},"generated":{"line":2,"column":187}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":18,"column":0},"generated":{"line":2,"column":189}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":19,"column":0},"generated":{"line":2,"column":191}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":19,"column":0},"generated":{"line":2,"column":193}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":19,"column":0},"generated":{"line":2,"column":197}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":20,"column":0},"generated":{"line":2,"column":201}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":20,"column":0},"generated":{"line":2,"column":205}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":21,"column":0},"generated":{"line":2,"column":207}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":22,"column":0},"generated":{"line":2,"column":211}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":22,"column":0},"generated":{"line":2,"column":213}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":22,"column":0},"generated":{"line":2,"column":218}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":22,"column":0},"generated":{"line":2,"column":224}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":22,"column":0},"generated":{"line":2,"column":226}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":23,"column":0},"generated":{"line":2,"column":238}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":23,"column":0},"generated":{"line":2,"column":244}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":25,"column":0},"generated":{"line":2,"column":247}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":24,"column":0},"generated":{"line":2,"column":259}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":24,"column":0},"generated":{"line":2,"column":261}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":24,"column":0},"generated":{"line":2,"column":266}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":24,"column":0},"generated":{"line":2,"column":276}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":24,"column":0},"generated":{"line":2,"column":278}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":28,"column":0},"generated":{"line":2,"column":287}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":28,"column":0},"generated":{"line":2,"column":290}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":28,"column":0},"generated":{"line":2,"column":294}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":28,"column":0},"generated":{"line":2,"column":296}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":30,"column":0},"generated":{"line":2,"column":301}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":29,"column":0},"generated":{"line":2,"column":313}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":29,"column":0},"generated":{"line":2,"column":315}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":29,"column":0},"generated":{"line":2,"column":320}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":29,"column":0},"generated":{"line":2,"column":330}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":29,"column":0},"generated":{"line":2,"column":349}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":29,"column":0},"generated":{"line":2,"column":351}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":33,"column":0},"generated":{"line":2,"column":357}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":33,"column":0},"generated":{"line":2,"column":363}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":33,"column":0},"generated":{"line":2,"column":365}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":33,"column":0},"generated":{"line":2,"column":367}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":34,"column":0},"generated":{"line":2,"column":376}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":34,"column":0},"generated":{"line":2,"column":379}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":34,"column":0},"generated":{"line":2,"column":385}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":34,"column":0},"generated":{"line":2,"column":393}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":46,"column":0},"generated":{"line":2,"column":396}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":39,"column":0},"generated":{"line":2,"column":403}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":39,"column":0},"generated":{"line":2,"column":405}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":39,"column":0},"generated":{"line":2,"column":410}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":39,"column":0},"generated":{"line":2,"column":412}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":39,"column":0},"generated":{"line":2,"column":417}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":39,"column":0},"generated":{"line":2,"column":419}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":39,"column":0},"generated":{"line":2,"column":424}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":40,"column":0},"generated":{"line":2,"column":431}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":40,"column":0},"generated":{"line":2,"column":433}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":40,"column":0},"generated":{"line":2,"column":439}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":40,"column":0},"generated":{"line":2,"column":441}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":40,"column":0},"generated":{"line":2,"column":446}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":40,"column":0},"generated":{"line":2,"column":448}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":40,"column":0},"generated":{"line":2,"column":454}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":42,"column":0},"generated":{"line":2,"column":461}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":42,"column":0},"generated":{"line":2,"column":463}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":42,"column":0},"generated":{"line":2,"column":471}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":43,"column":0},"generated":{"line":2,"column":475}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":43,"column":0},"generated":{"line":2,"column":477}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":43,"column":0},"generated":{"line":2,"column":482}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":43,"column":0},"generated":{"line":2,"column":484}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":46,"column":0},"generated":{"line":2,"column":489}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":35,"column":0},"generated":{"line":2,"column":491}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":35,"column":0},"generated":{"line":2,"column":493}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":35,"column":0},"generated":{"line":2,"column":498}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":35,"column":0},"generated":{"line":2,"column":508}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":48,"column":0},"generated":{"line":2,"column":526}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":48,"column":0},"generated":{"line":2,"column":528}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":48,"column":0},"generated":{"line":2,"column":534}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":55,"column":0},"generated":{"line":2,"column":545}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":55,"column":0},"generated":{"line":2,"column":553}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":55,"column":0},"generated":{"line":2,"column":560}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":55,"column":0},"generated":{"line":2,"column":568}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":56,"column":0},"generated":{"line":2,"column":569}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":56,"column":0},"generated":{"line":2,"column":577}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":57,"column":0},"generated":{"line":2,"column":579}},{"source":"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js","original":{"line":57,"column":0},"generated":{"line":2,"column":587}}],"sources":{"node_modules/ipfs-pubsub-room/src/direct-connection-handler.js":"'use strict'\n\nconst pull = require('pull-stream')\nconst EventEmitter = require('events')\n\nconst emitter = new EventEmitter()\n\nfunction handler (protocol, conn) {\n  conn.getPeerInfo((err, peerInfo) => {\n    if (err) {\n      console.log(err)\n      return\n    }\n\n    const peerId = peerInfo.id.toB58String()\n\n    pull(\n      conn,\n      pull.map((message) => {\n        let msg\n        try {\n          msg = JSON.parse(message.toString())\n        } catch (err) {\n          emitter.emit('warning', err.message)\n          return // early\n        }\n\n        if (peerId !== msg.from) {\n          emitter.emit('warning', 'no peerid match ' + msg.from)\n          return // early\n        }\n\n        const topicIDs = msg.topicIDs\n        if (!Array.isArray(topicIDs)) {\n          emitter.emit('warning', 'no topic IDs')\n          return // early\n        }\n\n        msg.data = Buffer.from(msg.data, 'hex')\n        msg.seqno = Buffer.from(msg.seqno, 'hex')\n\n        topicIDs.forEach((topic) => {\n          emitter.emit(topic, msg)\n        })\n\n        return msg\n      }),\n      pull.onEnd(() => {\n        // do nothing\n      })\n    )\n  })\n}\n\nexports = module.exports = {\n  handler: handler,\n  emitter: emitter\n}\n"},"lineCount":null}},"error":null,"hash":"6382d366d6a27487a5b3ed94c8aa0c78","cacheData":{"env":{}}}