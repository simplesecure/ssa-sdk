{"id":"XQHq","dependencies":[{"name":"/Users/polluterofminds/Development/simpleid/ssa-sdk/package.json","includedInParent":true,"mtime":1584306008866},{"name":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-kad-dht/package.json","includedInParent":true,"mtime":1582579780032},{"name":"k-bucket","loc":{"line":3,"column":24},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/k-bucket/index.js"},{"name":"./utils","loc":{"line":5,"column":22},"parent":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","resolved":"/Users/polluterofminds/Development/simpleid/ssa-sdk/node_modules/ipfs/node_modules/libp2p-kad-dht/src/utils.js"}],"generated":{"js":"\"use strict\";const e=require(\"k-bucket\"),t=require(\"./utils\");class r{constructor(r,s){this.self=r,this._onPing=this._onPing.bind(this),t.convertPeerId(r,(t,r)=>{if(t)throw t;this.kb=new e({localNodeId:r,numberOfNodesPerKBucket:s,numberOfNodesToPing:1}),this.kb.on(\"ping\",this._onPing)})}_onPing(e,t){const r=e[0];this.kb.remove(r.id),this.kb.add(t)}get size(){return this.kb.count()}find(e,r){t.convertPeerId(e,(t,s)=>{if(t)return r(t);const i=this.closestPeer(s);if(i&&i.isEqual(e))return r(null,i);r()})}closestPeer(e,t){const r=this.closestPeers(e,1);if(r.length>0)return r[0]}closestPeers(e,t){return this.kb.closest(e,t).map(e=>e.peer)}add(e,r){t.convertPeerId(e,(t,s)=>{if(t)return r(t);this.kb.add({id:s,peer:e}),r()})}remove(e,r){t.convertPeerId(e,(e,t)=>{if(e)return r(e);this.kb.remove(t),r()})}}module.exports=r;"},"sourceMaps":{"js":{"mappings":[{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","original":{"line":1,"column":0},"generated":{"line":1,"column":0}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","original":{"line":3,"column":0},"generated":{"line":1,"column":13}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"KBucket","original":{"line":3,"column":6},"generated":{"line":1,"column":19}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"require","original":{"line":3,"column":16},"generated":{"line":1,"column":21}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","original":{"line":3,"column":24},"generated":{"line":1,"column":29}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"utils","original":{"line":5,"column":6},"generated":{"line":1,"column":41}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"require","original":{"line":5,"column":14},"generated":{"line":1,"column":43}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","original":{"line":5,"column":22},"generated":{"line":1,"column":51}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","original":{"line":11,"column":0},"generated":{"line":1,"column":62}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"RoutingTable","original":{"line":11,"column":6},"generated":{"line":1,"column":68}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"constructor","original":{"line":16,"column":2},"generated":{"line":1,"column":70}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"self","original":{"line":16,"column":15},"generated":{"line":1,"column":82}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"kBucketSize","original":{"line":16,"column":21},"generated":{"line":1,"column":84}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"self","original":{"line":17,"column":9},"generated":{"line":1,"column":87}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"self","original":{"line":17,"column":9},"generated":{"line":1,"column":92}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"self","original":{"line":17,"column":16},"generated":{"line":1,"column":97}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"_onPing","original":{"line":18,"column":9},"generated":{"line":1,"column":99}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"_onPing","original":{"line":18,"column":9},"generated":{"line":1,"column":104}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","original":{"line":18,"column":19},"generated":{"line":1,"column":112}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"_onPing","original":{"line":18,"column":24},"generated":{"line":1,"column":117}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"bind","original":{"line":18,"column":32},"generated":{"line":1,"column":125}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","original":{"line":18,"column":37},"generated":{"line":1,"column":130}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"utils","original":{"line":20,"column":4},"generated":{"line":1,"column":136}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"convertPeerId","original":{"line":20,"column":10},"generated":{"line":1,"column":138}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"self","original":{"line":20,"column":24},"generated":{"line":1,"column":152}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","original":{"line":20,"column":30},"generated":{"line":1,"column":154}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"err","original":{"line":20,"column":31},"generated":{"line":1,"column":155}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"selfKey","original":{"line":20,"column":36},"generated":{"line":1,"column":157}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"err","original":{"line":21,"column":10},"generated":{"line":1,"column":162}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"err","original":{"line":21,"column":10},"generated":{"line":1,"column":165}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"err","original":{"line":22,"column":14},"generated":{"line":1,"column":167}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"err","original":{"line":22,"column":14},"generated":{"line":1,"column":173}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"kb","original":{"line":25,"column":11},"generated":{"line":1,"column":175}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"kb","original":{"line":25,"column":11},"generated":{"line":1,"column":180}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","original":{"line":25,"column":16},"generated":{"line":1,"column":183}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"KBucket","original":{"line":25,"column":20},"generated":{"line":1,"column":187}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","original":{"line":25,"column":28},"generated":{"line":1,"column":189}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"localNodeId","original":{"line":26,"column":8},"generated":{"line":1,"column":190}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"selfKey","original":{"line":26,"column":21},"generated":{"line":1,"column":202}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"numberOfNodesPerKBucket","original":{"line":27,"column":8},"generated":{"line":1,"column":204}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"kBucketSize","original":{"line":27,"column":33},"generated":{"line":1,"column":228}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"numberOfNodesToPing","original":{"line":28,"column":8},"generated":{"line":1,"column":230}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","original":{"line":28,"column":29},"generated":{"line":1,"column":250}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"kb","original":{"line":31,"column":11},"generated":{"line":1,"column":254}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"kb","original":{"line":31,"column":11},"generated":{"line":1,"column":259}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"on","original":{"line":31,"column":14},"generated":{"line":1,"column":262}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","original":{"line":31,"column":17},"generated":{"line":1,"column":265}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","original":{"line":31,"column":25},"generated":{"line":1,"column":272}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"_onPing","original":{"line":31,"column":30},"generated":{"line":1,"column":277}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"_onPing","original":{"line":49,"column":2},"generated":{"line":1,"column":288}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"oldContacts","original":{"line":49,"column":11},"generated":{"line":1,"column":296}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"newContact","original":{"line":49,"column":24},"generated":{"line":1,"column":298}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"oldest","original":{"line":51,"column":10},"generated":{"line":1,"column":301}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"oldest","original":{"line":51,"column":10},"generated":{"line":1,"column":307}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"oldContacts","original":{"line":51,"column":19},"generated":{"line":1,"column":309}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","original":{"line":51,"column":31},"generated":{"line":1,"column":311}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"kb","original":{"line":54,"column":9},"generated":{"line":1,"column":314}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"kb","original":{"line":54,"column":9},"generated":{"line":1,"column":319}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"remove","original":{"line":54,"column":12},"generated":{"line":1,"column":322}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"oldest","original":{"line":54,"column":19},"generated":{"line":1,"column":329}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"id","original":{"line":54,"column":26},"generated":{"line":1,"column":331}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"kb","original":{"line":57,"column":9},"generated":{"line":1,"column":335}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"kb","original":{"line":57,"column":9},"generated":{"line":1,"column":340}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"add","original":{"line":57,"column":12},"generated":{"line":1,"column":343}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"newContact","original":{"line":57,"column":16},"generated":{"line":1,"column":347}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"size","original":{"line":67,"column":6},"generated":{"line":1,"column":350}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","original":{"line":68,"column":11},"generated":{"line":1,"column":361}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","original":{"line":68,"column":11},"generated":{"line":1,"column":368}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"kb","original":{"line":68,"column":16},"generated":{"line":1,"column":373}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"count","original":{"line":68,"column":19},"generated":{"line":1,"column":376}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"find","original":{"line":78,"column":2},"generated":{"line":1,"column":384}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"peer","original":{"line":78,"column":8},"generated":{"line":1,"column":389}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"callback","original":{"line":78,"column":14},"generated":{"line":1,"column":391}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"utils","original":{"line":79,"column":4},"generated":{"line":1,"column":394}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"convertPeerId","original":{"line":79,"column":10},"generated":{"line":1,"column":396}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"peer","original":{"line":79,"column":24},"generated":{"line":1,"column":410}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","original":{"line":79,"column":30},"generated":{"line":1,"column":412}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"err","original":{"line":79,"column":31},"generated":{"line":1,"column":413}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"key","original":{"line":79,"column":36},"generated":{"line":1,"column":415}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"err","original":{"line":80,"column":10},"generated":{"line":1,"column":420}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"err","original":{"line":80,"column":10},"generated":{"line":1,"column":423}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"callback","original":{"line":81,"column":15},"generated":{"line":1,"column":425}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"callback","original":{"line":81,"column":15},"generated":{"line":1,"column":432}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"err","original":{"line":81,"column":24},"generated":{"line":1,"column":434}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"closest","original":{"line":83,"column":12},"generated":{"line":1,"column":437}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"closest","original":{"line":83,"column":12},"generated":{"line":1,"column":443}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","original":{"line":83,"column":22},"generated":{"line":1,"column":445}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"closestPeer","original":{"line":83,"column":27},"generated":{"line":1,"column":450}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"key","original":{"line":83,"column":39},"generated":{"line":1,"column":462}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"closest","original":{"line":85,"column":10},"generated":{"line":1,"column":465}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"closest","original":{"line":85,"column":10},"generated":{"line":1,"column":468}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"closest","original":{"line":85,"column":21},"generated":{"line":1,"column":471}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"isEqual","original":{"line":85,"column":29},"generated":{"line":1,"column":473}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"peer","original":{"line":85,"column":37},"generated":{"line":1,"column":481}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"callback","original":{"line":86,"column":15},"generated":{"line":1,"column":484}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"callback","original":{"line":86,"column":15},"generated":{"line":1,"column":491}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","original":{"line":86,"column":24},"generated":{"line":1,"column":493}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"closest","original":{"line":86,"column":30},"generated":{"line":1,"column":498}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"callback","original":{"line":89,"column":6},"generated":{"line":1,"column":501}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"closestPeer","original":{"line":100,"column":2},"generated":{"line":1,"column":507}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"key","original":{"line":100,"column":15},"generated":{"line":1,"column":519}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"count","original":{"line":100,"column":20},"generated":{"line":1,"column":521}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"res","original":{"line":101,"column":10},"generated":{"line":1,"column":524}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"res","original":{"line":101,"column":10},"generated":{"line":1,"column":530}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","original":{"line":101,"column":16},"generated":{"line":1,"column":532}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"closestPeers","original":{"line":101,"column":21},"generated":{"line":1,"column":537}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"key","original":{"line":101,"column":34},"generated":{"line":1,"column":550}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","original":{"line":101,"column":39},"generated":{"line":1,"column":552}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"res","original":{"line":102,"column":8},"generated":{"line":1,"column":555}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"res","original":{"line":102,"column":8},"generated":{"line":1,"column":558}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"length","original":{"line":102,"column":12},"generated":{"line":1,"column":560}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","original":{"line":102,"column":21},"generated":{"line":1,"column":567}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"res","original":{"line":103,"column":13},"generated":{"line":1,"column":569}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"res","original":{"line":103,"column":13},"generated":{"line":1,"column":576}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","original":{"line":103,"column":17},"generated":{"line":1,"column":578}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"closestPeers","original":{"line":114,"column":2},"generated":{"line":1,"column":581}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"key","original":{"line":114,"column":16},"generated":{"line":1,"column":594}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"count","original":{"line":114,"column":21},"generated":{"line":1,"column":596}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","original":{"line":115,"column":11},"generated":{"line":1,"column":599}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","original":{"line":115,"column":11},"generated":{"line":1,"column":606}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"kb","original":{"line":115,"column":16},"generated":{"line":1,"column":611}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"closest","original":{"line":115,"column":19},"generated":{"line":1,"column":614}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"key","original":{"line":115,"column":27},"generated":{"line":1,"column":622}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"count","original":{"line":115,"column":32},"generated":{"line":1,"column":624}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"map","original":{"line":115,"column":39},"generated":{"line":1,"column":627}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"p","original":{"line":115,"column":44},"generated":{"line":1,"column":631}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"p","original":{"line":115,"column":50},"generated":{"line":1,"column":634}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"peer","original":{"line":115,"column":52},"generated":{"line":1,"column":636}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"add","original":{"line":125,"column":2},"generated":{"line":1,"column":642}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"peer","original":{"line":125,"column":7},"generated":{"line":1,"column":646}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"callback","original":{"line":125,"column":13},"generated":{"line":1,"column":648}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"utils","original":{"line":126,"column":4},"generated":{"line":1,"column":651}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"convertPeerId","original":{"line":126,"column":10},"generated":{"line":1,"column":653}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"peer","original":{"line":126,"column":24},"generated":{"line":1,"column":667}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","original":{"line":126,"column":30},"generated":{"line":1,"column":669}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"err","original":{"line":126,"column":31},"generated":{"line":1,"column":670}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"id","original":{"line":126,"column":36},"generated":{"line":1,"column":672}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"err","original":{"line":127,"column":10},"generated":{"line":1,"column":677}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"err","original":{"line":127,"column":10},"generated":{"line":1,"column":680}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"callback","original":{"line":128,"column":15},"generated":{"line":1,"column":682}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"callback","original":{"line":128,"column":15},"generated":{"line":1,"column":689}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"err","original":{"line":128,"column":24},"generated":{"line":1,"column":691}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"kb","original":{"line":130,"column":11},"generated":{"line":1,"column":694}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"kb","original":{"line":130,"column":11},"generated":{"line":1,"column":699}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"add","original":{"line":130,"column":14},"generated":{"line":1,"column":702}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","original":{"line":130,"column":18},"generated":{"line":1,"column":706}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"id","original":{"line":130,"column":20},"generated":{"line":1,"column":707}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"id","original":{"line":130,"column":24},"generated":{"line":1,"column":710}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"peer","original":{"line":130,"column":28},"generated":{"line":1,"column":712}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"peer","original":{"line":130,"column":34},"generated":{"line":1,"column":717}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"callback","original":{"line":131,"column":6},"generated":{"line":1,"column":721}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"remove","original":{"line":142,"column":2},"generated":{"line":1,"column":727}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"peer","original":{"line":142,"column":10},"generated":{"line":1,"column":734}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"callback","original":{"line":142,"column":16},"generated":{"line":1,"column":736}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"utils","original":{"line":143,"column":4},"generated":{"line":1,"column":739}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"convertPeerId","original":{"line":143,"column":10},"generated":{"line":1,"column":741}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"peer","original":{"line":143,"column":24},"generated":{"line":1,"column":755}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","original":{"line":143,"column":30},"generated":{"line":1,"column":757}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"err","original":{"line":143,"column":31},"generated":{"line":1,"column":758}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"id","original":{"line":143,"column":36},"generated":{"line":1,"column":760}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"err","original":{"line":144,"column":10},"generated":{"line":1,"column":765}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"err","original":{"line":144,"column":10},"generated":{"line":1,"column":768}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"callback","original":{"line":145,"column":15},"generated":{"line":1,"column":770}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"callback","original":{"line":145,"column":15},"generated":{"line":1,"column":777}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"err","original":{"line":145,"column":24},"generated":{"line":1,"column":779}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"kb","original":{"line":147,"column":11},"generated":{"line":1,"column":782}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"kb","original":{"line":147,"column":11},"generated":{"line":1,"column":787}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"remove","original":{"line":147,"column":14},"generated":{"line":1,"column":790}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"id","original":{"line":147,"column":21},"generated":{"line":1,"column":797}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"callback","original":{"line":148,"column":6},"generated":{"line":1,"column":800}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"module","original":{"line":153,"column":0},"generated":{"line":1,"column":807}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"exports","original":{"line":153,"column":7},"generated":{"line":1,"column":814}},{"source":"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js","name":"RoutingTable","original":{"line":153,"column":17},"generated":{"line":1,"column":822}}],"sources":{"node_modules/ipfs/node_modules/libp2p-kad-dht/src/routing.js":"'use strict'\n\nconst KBucket = require('k-bucket')\n\nconst utils = require('./utils')\n\n/**\n * A wrapper around `k-bucket`, to provide easy store and\n * retrival for peers.\n */\nclass RoutingTable {\n  /**\n   * @param {PeerId} self\n   * @param {number} kBucketSize\n   */\n  constructor (self, kBucketSize) {\n    this.self = self\n    this._onPing = this._onPing.bind(this)\n\n    utils.convertPeerId(self, (err, selfKey) => {\n      if (err) {\n        throw err\n      }\n\n      this.kb = new KBucket({\n        localNodeId: selfKey,\n        numberOfNodesPerKBucket: kBucketSize,\n        numberOfNodesToPing: 1\n      })\n\n      this.kb.on('ping', this._onPing)\n    })\n  }\n\n  // -- Private Methods\n\n  /**\n   * Called on the `ping` event from `k-bucket`.\n   * Currently this just removes the oldest contact from\n   * the list, without acutally pinging the individual peers.\n   * This is the same as go does, but should probably\n   * be upgraded to actually ping the individual peers.\n   *\n   * @param {Array<Object>} oldContacts\n   * @param {Object} newContact\n   * @returns {undefined}\n   * @private\n   */\n  _onPing (oldContacts, newContact) {\n    // just use the first one (k-bucket sorts from oldest to newest)\n    const oldest = oldContacts[0]\n\n    // remove the oldest one\n    this.kb.remove(oldest.id)\n\n    // add the new one\n    this.kb.add(newContact)\n  }\n\n  // -- Public Interface\n\n  /**\n   * Amount of currently stored peers.\n   *\n   * @type {number}\n   */\n  get size () {\n    return this.kb.count()\n  }\n\n  /**\n   * Find a specific peer by id.\n   *\n   * @param {PeerId} peer\n   * @param {function(Error, PeerId)} callback\n   * @returns {void}\n   */\n  find (peer, callback) {\n    utils.convertPeerId(peer, (err, key) => {\n      if (err) {\n        return callback(err)\n      }\n      const closest = this.closestPeer(key)\n\n      if (closest && closest.isEqual(peer)) {\n        return callback(null, closest)\n      }\n\n      callback()\n    })\n  }\n\n  /**\n   * Retrieve the closest peers to the given key.\n   *\n   * @param {Buffer} key\n   * @param {number} count\n   * @returns {PeerId|undefined}\n   */\n  closestPeer (key, count) {\n    const res = this.closestPeers(key, 1)\n    if (res.length > 0) {\n      return res[0]\n    }\n  }\n\n  /**\n   * Retrieve the `count`-closest peers to the given key.\n   *\n   * @param {Buffer} key\n   * @param {number} count\n   * @returns {Array<PeerId>}\n   */\n  closestPeers (key, count) {\n    return this.kb.closest(key, count).map((p) => p.peer)\n  }\n\n  /**\n   * Add or update the routing table with the given peer.\n   *\n   * @param {PeerId} peer\n   * @param {function(Error)} callback\n   * @returns {undefined}\n   */\n  add (peer, callback) {\n    utils.convertPeerId(peer, (err, id) => {\n      if (err) {\n        return callback(err)\n      }\n      this.kb.add({ id: id, peer: peer })\n      callback()\n    })\n  }\n\n  /**\n   * Remove a given peer from the table.\n   *\n   * @param {PeerId} peer\n   * @param {function(Error)} callback\n   * @returns {undefined}\n   */\n  remove (peer, callback) {\n    utils.convertPeerId(peer, (err, id) => {\n      if (err) {\n        return callback(err)\n      }\n      this.kb.remove(id)\n      callback()\n    })\n  }\n}\n\nmodule.exports = RoutingTable\n"},"lineCount":null}},"error":null,"hash":"e9a38d7ce35d13169c7d521288ae3db5","cacheData":{"env":{}}}